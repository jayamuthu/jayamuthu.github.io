<p>This is post is inspired by <cite>Numpy Primer &lt;http://suriyadeepan.github.io/2016-06-26-numpy-primer/&gt;</cite></p>
<div class="section" id="lets-create-some-matrices">
<h1>Lets create some matrices</h1>
<pre class="code python3"><a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-1"></a> <span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-2"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-3"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-4"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-5"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-6"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-8"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-10"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-11"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-12"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-13"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-14"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-15"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-16"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-17"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-19"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-20"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-21"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-22"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-23"></a>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-24"></a><span class="o">-</span><span class="mf">0.0008</span> <span class="o">-</span><span class="mf">0.6619</span> <span class="o">-</span><span class="mf">0.6790</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-25"></a> <span class="mf">0.9104</span> <span class="o">-</span><span class="mf">0.1249</span> <span class="o">-</span><span class="mf">0.4044</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-26"></a><span class="o">-</span><span class="mf">1.0516</span> <span class="o">-</span><span class="mf">0.4031</span>  <span class="mf">0.9166</span>
<a name="rest_code_885e3ec5e7924776bd811cd23a7e93b9-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre><p>I think now we can understand what the parameters to the above functions mean - the shape of the tensor. Take a look at non square matrices below</p>
<pre class="code python3"><a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-3"></a>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-4"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-5"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-7"></a>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-8"></a>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-9"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-10"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-11"></a>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-12"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-13"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-14"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-15"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_25afe3b4b88f48d7a45fc5979734e6d5-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x3</span><span class="p">]</span>
</pre><p>How about a multidimensional vector - a tensor. Actually tensor is a general term for n-dimensional arrays like in numpy. If you were keen observant, you'd have notices by now that the output of every <strong>print(x)</strong> end with <strong>torch.FloatTensor</strong>. This term became famous with the deep learning storm.</p>
<pre class="code python3"><a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-3"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-7"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-8"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-9"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-10"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-11"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-12"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-15"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-16"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-19"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-20"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-21"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-22"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-23"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-27"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-28"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-29"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-30"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-31"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-32"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-33"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-34"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-35"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-36"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-37"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-38"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-39"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-40"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-41"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-42"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-43"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-44"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-45"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-46"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-47"></a>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-49"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-50"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_6f59c91a68f1446dab45e3759880d8d2-51"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x3x2x2x3</span><span class="p">]</span>
</pre><p>Pause for a moment and take a long look into how the tensor is printed.  And then proceed to look for more matrices below.
The identity matrix - matrix is the keyword.</p>
<pre class="code python3"><a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-1"></a><span class="c1"># The identity matrix - max upto two dimensions</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-4"></a>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-5"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-6"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-8"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-9"></a>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-10"></a>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-13"></a>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-14"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-15"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-16"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_3effd33ebb30444ab5dddbc222a1eb3a-17"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x4</span><span class="p">]</span>
</pre><p>Alright I get it. Just ones and zeros are boring. Want some more numbers?
<strong>torch.linspace(start, end, count)</strong> creates a list of numbers starting with <strong>start</strong> to <strong>end</strong> at the interval of  <strong>(end - start)/(count - 1)</strong></p>
<pre class="code python3"><a name="rest_code_8f198553a43d442d9934256686681a30-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-3"></a>
<a name="rest_code_8f198553a43d442d9934256686681a30-4"></a> <span class="mf">1.0000</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-5"></a> <span class="mf">1.5556</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-6"></a> <span class="mf">2.1111</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-7"></a> <span class="mf">2.6667</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-8"></a> <span class="mf">3.2222</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-9"></a> <span class="mf">3.7778</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-10"></a> <span class="mf">4.3333</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-11"></a> <span class="mf">4.8889</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-12"></a> <span class="mf">5.4444</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-13"></a> <span class="mf">6.0000</span>
<a name="rest_code_8f198553a43d442d9934256686681a30-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre><p><strong>torch.logspace()</strong> is similar to torch.linspace() but in logarthmic steps.</p>
<pre class="code python3"><a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-3"></a>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-4"></a>  <span class="mf">1.2589</span>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-5"></a>  <span class="mf">2.1135</span>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-6"></a>  <span class="mf">3.5481</span>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-7"></a>  <span class="mf">5.9566</span>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-8"></a> <span class="mf">10.0000</span>
<a name="rest_code_5497b861ce9e457f989b7be9e051f1e1-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
<div class="section" id="arithmetics">
<h1>Arithmetics</h1>
<p>So what we created bunch of numbers. What is the use? Lets do some arithmetic</p>
<p>Elementwise addition</p>
<pre class="code python3"><a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-3"></a>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-4"></a> <span class="mi">1</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-5"></a> <span class="mi">1</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-6"></a> <span class="mi">1</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-7"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-8"></a>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-9"></a>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-10"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-11"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-12"></a>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-13"></a> <span class="mi">3</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-14"></a> <span class="mi">3</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-15"></a> <span class="mi">3</span>
<a name="rest_code_e36ab5cac27b4addbb509ab4907b0358-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
</pre><p>Elementwise multiplication</p>
<pre class="code python3"><a name="rest_code_6d75bf79373c48839421739369ae81d5-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-3"></a>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-4"></a>  <span class="mi">1</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-5"></a>  <span class="mi">2</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-6"></a>  <span class="mi">3</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-7"></a>  <span class="mi">4</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-8"></a>  <span class="mi">5</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-9"></a>  <span class="mi">6</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-10"></a>  <span class="mi">7</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-11"></a>  <span class="mi">8</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-12"></a>  <span class="mi">9</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-13"></a> <span class="mi">10</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-15"></a>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-16"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-17"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-18"></a>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-19"></a>  <span class="mi">2</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-20"></a>  <span class="mi">4</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-21"></a>  <span class="mi">6</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-22"></a>  <span class="mi">8</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-23"></a> <span class="mi">10</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-24"></a> <span class="mi">12</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-25"></a> <span class="mi">14</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-26"></a> <span class="mi">16</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-27"></a> <span class="mi">18</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-28"></a> <span class="mi">20</span>
<a name="rest_code_6d75bf79373c48839421739369ae81d5-29"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre><p>Iterating over the elements and multiplying them by some number</p>
<pre class="code python3"><a name="rest_code_d8368bd948464c6ea76a287c96346cab-1"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-2"></a>    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-3"></a>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-5"></a>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-6"></a>  <span class="mi">0</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-7"></a>  <span class="mi">2</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-8"></a>  <span class="mi">6</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-9"></a> <span class="mi">12</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-10"></a> <span class="mi">20</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-11"></a> <span class="mi">30</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-12"></a> <span class="mi">42</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-13"></a> <span class="mi">56</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-14"></a> <span class="mi">72</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-15"></a> <span class="mi">90</span>
<a name="rest_code_d8368bd948464c6ea76a287c96346cab-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre><p>So yes we can multiply the tensors by ordinary numbers, there is no need for 'i' to be a tensor, lets take a larger tensors, and assign its values by hand. So far we have been using the numbers generated by function like <strong>ones(), zeros() and rand()</strong>. In most cases we need our favoruite numbers. How to do this? <strong>torch.Tensor()</strong> to the rescue.</p>
<pre class="code python3"><a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">67</span><span class="p">])</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-3"></a>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-4"></a>  <span class="mi">1</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-5"></a>  <span class="mi">3</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-6"></a>  <span class="mi">5</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-7"></a>  <span class="mi">6</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-8"></a> <span class="mi">78</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-9"></a>  <span class="mi">3</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-10"></a> <span class="mi">67</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-11"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">7</span><span class="p">]</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-12"></a>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">)])</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-15"></a>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-16"></a>  <span class="mi">0</span>   <span class="mi">2</span>   <span class="mi">4</span>   <span class="mi">6</span>   <span class="mi">8</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-17"></a> <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>  <span class="mi">18</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-18"></a> <span class="mi">20</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_7599577fcca24383bddaf1d66a7fdc4a-19"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x5</span><span class="p">]</span>
</pre><p>As we can see, the torch.Tensor() takes any iterable or iterables of iterable and makes a tensor out of it</p>
<p>Broadcasting
Adding a scalar to a tensor or multiplying a tensor by a scalar is essentially same as adding or multiplying the tensor by another tensor with shape same as the original tensor, with all its elements being the scalar. Too many words.</p>
<pre class="code python3"><a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-3"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-4"></a>  <span class="mi">1</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-5"></a>  <span class="mi">2</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-6"></a>  <span class="mi">3</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-7"></a>  <span class="mi">4</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-8"></a>  <span class="mi">5</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-9"></a>  <span class="mi">6</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-10"></a>  <span class="mi">7</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-11"></a>  <span class="mi">8</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-12"></a>  <span class="mi">9</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-13"></a> <span class="mi">10</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-15"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-16"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-17"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-19"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-20"></a> <span class="mi">2</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-21"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-22"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-23"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-24"></a><span class="c1"># broadcasting  https://discuss.pytorch.org/t/broadcasting-or-alternative-solutions/120</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-25"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-26"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-27"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-28"></a>  <span class="mi">2</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-29"></a>  <span class="mi">4</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-30"></a>  <span class="mi">6</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-31"></a>  <span class="mi">8</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-32"></a> <span class="mi">10</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-33"></a> <span class="mi">12</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-34"></a> <span class="mi">14</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-35"></a> <span class="mi">16</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-36"></a> <span class="mi">18</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-37"></a> <span class="mi">20</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-38"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-39"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-40"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-41"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-42"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-43"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-44"></a> <span class="mi">2</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-45"></a> <span class="mi">3</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-46"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="p">]</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-47"></a>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-48"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>        <span class="c1">#Dont&#39; work</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-49"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-50"></a>  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-51"></a>  <span class="n">File</span> <span class="s2">&quot;/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">274</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand_as</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-52"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-53"></a>  <span class="n">File</span> <span class="s2">&quot;/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">261</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-54"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;incorrect size: only supporting singleton expansion (size=1)&#39;</span><span class="p">)</span>
<a name="rest_code_b346ebf2bfeb48f9944b3ea6ea481e47-55"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="n">incorrect</span> <span class="n">size</span><span class="p">:</span> <span class="n">only</span> <span class="n">supporting</span> <span class="n">singleton</span> <span class="n">expansion</span> <span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre><p>Note that the expand_as() works only for singletons</p>
<div class="section" id="reshaping-tensors">
<h2>Reshaping Tensors</h2>
<p><strong>view()</strong> takes list of number and reshapes the tensor as per the arguments.</p>
<p>The constrain is for view(a, b, c,....n) a x b x c x ... x n should be equal to the size of the given tensor. If you give <em>'-1'</em> as the last argument to <strong>view()</strong> it will calculate the last dimension by itself.</p>
<pre class="code python3"><a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-3"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-4"></a>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-5"></a>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x5</span><span class="p">]</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-7"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-8"></a><span class="c1"># making matrices by hand is hard right?</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-9"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-10"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-12"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-13"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-14"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-15"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-16"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-17"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-18"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-20"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-21"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-22"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-23"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-24"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-25"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-26"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-27"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-28"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-29"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-30"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-31"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-32"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-33"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-34"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-35"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-36"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-37"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-39"></a>   <span class="mi">5</span>   <span class="mi">6</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-40"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-41"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-42"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-43"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-44"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-45"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-46"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-47"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-48"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-49"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-50"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-51"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-52"></a><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-53"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-54"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-55"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-56"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-57"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-58"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-59"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-60"></a>   <span class="mi">5</span>  <span class="o">-</span><span class="mi">6</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-61"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-62"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-63"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-64"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-65"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-66"></a>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-67"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-68"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-69"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_f6ce1d6e57b3471c82786431e96d3d81-70"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
</pre><p>Notice that change in value of an element in <strong>x</strong> reflects in <strong>x_</strong>. It is because view() does exactly what is says it will do. It creates a view of the tensor, the underlying storage is same for <strong>x</strong> and <strong>x_</strong></p>
</div>
<div class="section" id="statistics">
<h2>Statistics</h2>
<pre class="code python3"><a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-1"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-2"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-4"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-5"></a>  <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-6"></a>  <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-7"></a>  <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-8"></a> <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-10"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-12"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-13"></a> <span class="mi">28</span>  <span class="mi">32</span>  <span class="mi">36</span>  <span class="mi">40</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-15"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-16"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-17"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-18"></a> <span class="mi">10</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-19"></a> <span class="mi">26</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-20"></a> <span class="mi">42</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-21"></a> <span class="mi">58</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-22"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x1</span><span class="p">]</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-23"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-24"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-26"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-27"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-28"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-29"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-30"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-31"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-32"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-33"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-34"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-35"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-36"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-37"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-39"></a>  <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-40"></a>  <span class="mi">18</span>  <span class="mi">20</span>  <span class="mi">22</span>  <span class="mi">24</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-41"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-42"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-44"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-45"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-46"></a>   <span class="mi">6</span>   <span class="mi">8</span>  <span class="mi">10</span>  <span class="mi">12</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-47"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-49"></a>  <span class="mi">22</span>  <span class="mi">24</span>  <span class="mi">26</span>  <span class="mi">28</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-50"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x1x4</span><span class="p">]</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-51"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-52"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-53"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-54"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-55"></a>  <span class="mi">10</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-56"></a>  <span class="mi">26</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-57"></a>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-58"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-59"></a>  <span class="mi">42</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-60"></a>  <span class="mi">58</span>
<a name="rest_code_f61ec574dce64c5ea9df41d450248f9f-61"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x1</span><span class="p">]</span>
</pre></div>
<div class="section" id="matrix-multiplication">
<h2>Matrix Multiplication</h2>
<p><strong>mm()</strong> is name. See how it is different from normal elementwise multiplication, like we used to do in linear algebra class?</p>
<pre class="code python3"><a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-1"></a><span class="c1">#lets do some matrix multiplications</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-2"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-3"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]])</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-4"></a>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-6"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-7"></a>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-9"></a>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-10"></a>  <span class="mi">70</span>  <span class="mi">100</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-11"></a> <span class="mi">150</span>  <span class="mi">220</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-12"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2</span><span class="p">]</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-13"></a>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-14"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-15"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-16"></a>                  <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-17"></a>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-18"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-19"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-21"></a>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-22"></a>  <span class="mi">70</span>  <span class="mi">100</span>  <span class="mi">170</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-23"></a> <span class="mi">150</span>  <span class="mi">220</span>  <span class="mi">390</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-24"></a> <span class="mi">230</span>  <span class="mi">340</span>  <span class="mi">610</span>
<a name="rest_code_1bf67dd4613a446586a1b91bb6a5a3c3-25"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre></div>
<div class="section" id="indexing-and-slicing">
<h2>Indexing and slicing</h2>
<pre class="code python3"><a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-1"></a><span class="c1">#Indexing and slicing</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-4"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-5"></a>  <span class="mi">1</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-6"></a>  <span class="mi">2</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-7"></a>  <span class="mi">3</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-8"></a>  <span class="mi">4</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-9"></a>  <span class="mi">5</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-10"></a>  <span class="o">.</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-11"></a>  <span class="o">.</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-12"></a>  <span class="o">.</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-13"></a> <span class="mi">61</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-14"></a> <span class="mi">62</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-15"></a> <span class="mi">63</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-16"></a> <span class="mi">64</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-17"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-19"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-20"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-21"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-23"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-25"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-26"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-27"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-28"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-29"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-30"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-31"></a>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">20</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-32"></a>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-33"></a>  <span class="mi">25</span>  <span class="mi">26</span>  <span class="mi">27</span>  <span class="mi">28</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-34"></a>  <span class="mi">29</span>  <span class="mi">30</span>  <span class="mi">31</span>  <span class="mi">32</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-35"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-36"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-37"></a>  <span class="mi">33</span>  <span class="mi">34</span>  <span class="mi">35</span>  <span class="mi">36</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-38"></a>  <span class="mi">37</span>  <span class="mi">38</span>  <span class="mi">39</span>  <span class="mi">40</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-39"></a>  <span class="mi">41</span>  <span class="mi">42</span>  <span class="mi">43</span>  <span class="mi">44</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-40"></a>  <span class="mi">45</span>  <span class="mi">46</span>  <span class="mi">47</span>  <span class="mi">48</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-41"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-42"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-43"></a>  <span class="mi">49</span>  <span class="mi">50</span>  <span class="mi">51</span>  <span class="mi">52</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-44"></a>  <span class="mi">53</span>  <span class="mi">54</span>  <span class="mi">55</span>  <span class="mi">56</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-45"></a>  <span class="mi">57</span>  <span class="mi">58</span>  <span class="mi">59</span>  <span class="mi">60</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-46"></a>  <span class="mi">61</span>  <span class="mi">62</span>  <span class="mi">63</span>  <span class="mi">64</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-47"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-48"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-49"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-50"></a>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-51"></a> <span class="mi">21</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-52"></a> <span class="mi">22</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-53"></a> <span class="mi">23</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-54"></a> <span class="mi">24</span>
<a name="rest_code_5e52c211e6d0476fb2274cedbc7bd669-55"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
<div class="section" id="masking">
<h2>Masking</h2>
<pre class="code python3"><a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-1"></a><span class="c1">#the expression &#39;x_ % 4 == 0&#39; creates a mask</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-3"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-7"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-8"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-9"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-10"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-11"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-12"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-15"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-16"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-19"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-20"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-21"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-22"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-23"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-24"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-28"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-29"></a><span class="c1"># Use the mask to extract just those elements</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-30"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-31"></a><span class="n">x_</span><span class="p">[</span><span class="mi">0</span><span class="p">][(</span><span class="n">x_</span><span class="o">%</span><span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-32"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-33"></a>  <span class="mi">4</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-34"></a>  <span class="mi">8</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-35"></a> <span class="mi">12</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-36"></a> <span class="mi">16</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-37"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-38"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-39"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-40"></a><span class="c1">#more grander masking example</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-41"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-42"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-44"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-45"></a>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-46"></a>  <span class="mi">2</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-47"></a>  <span class="mi">3</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-48"></a>  <span class="mi">4</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-49"></a>  <span class="mi">5</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-50"></a>  <span class="o">.</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-51"></a>  <span class="o">.</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-52"></a>  <span class="o">.</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-53"></a> <span class="mi">61</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-54"></a> <span class="mi">62</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-55"></a> <span class="mi">63</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-56"></a> <span class="mi">64</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-57"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-58"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-59"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-60"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-61"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-62"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-63"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-64"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-65"></a>   <span class="mi">17</span>    <span class="mi">18</span>    <span class="mi">19</span>    <span class="mi">20</span>    <span class="mi">21</span>    <span class="mi">22</span>    <span class="mi">23</span>    <span class="mi">24</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-66"></a>   <span class="mi">25</span>    <span class="mi">26</span>    <span class="mi">27</span>    <span class="mi">28</span>    <span class="mi">29</span>    <span class="mi">30</span>    <span class="mi">31</span>    <span class="mi">32</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-67"></a>   <span class="mi">33</span>    <span class="mi">34</span>    <span class="mi">35</span>    <span class="mi">36</span>    <span class="mi">37</span>    <span class="mi">38</span>    <span class="mi">39</span>    <span class="mi">40</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-68"></a>   <span class="mi">41</span>    <span class="mi">42</span>    <span class="mi">43</span>    <span class="mi">44</span>    <span class="mi">45</span>    <span class="mi">46</span>    <span class="mi">47</span>    <span class="mi">48</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-69"></a>   <span class="mi">49</span>    <span class="mi">50</span>    <span class="mi">51</span>    <span class="mi">52</span>    <span class="mi">53</span>    <span class="mi">54</span>    <span class="mi">55</span>    <span class="mi">56</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-70"></a>   <span class="mi">57</span>    <span class="mi">58</span>    <span class="mi">59</span>    <span class="mi">60</span>    <span class="mi">61</span>    <span class="mi">62</span>    <span class="mi">63</span>    <span class="mi">64</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-71"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-72"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-73"></a><span class="n">x_ind</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">byte</span><span class="p">()</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-74"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_ind</span><span class="p">)</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-75"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-76"></a>    <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-77"></a>    <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-78"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-79"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-80"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-81"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-82"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-83"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-84"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-85"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-86"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x_ind</span><span class="p">])</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-87"></a>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-88"></a>  <span class="mi">1</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-89"></a> <span class="mi">10</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-90"></a> <span class="mi">19</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-91"></a> <span class="mi">28</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-92"></a> <span class="mi">37</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-93"></a> <span class="mi">46</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-94"></a> <span class="mi">55</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-95"></a> <span class="mi">64</span>
<a name="rest_code_fb4c979193f64b72ae68e43a9eb04ba1-96"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="p">]</span>
</pre><p>Please leave your comments below.</p>
</div>
</div>
