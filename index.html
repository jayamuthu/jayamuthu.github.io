<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# fb: http://ogp.me/ns/fb# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="interpretations of my observations">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>vanangamudi</title>
<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/html4css1.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://vanangamudi.gitlab.io/">
<meta property="fb:app_id" content="selvakumar.v2.x">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/mnist%20study%20in%20pytorch/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://vanangamudi.gitlab.io/">

                <span id="blog-title">vanangamudi</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>
                </li>
<li>
<a href="stories/aboutme">About me</a>
                </li>
<li>
<a href="https://twitter.com/paarulakan">Twitter</a>
                </li>
<li>
<a href="https://github.com/vanangamudi">Github</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/mnist%20study%20in%20pytorch/" class="u-url">MNIST study</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/mnist%20study%20in%20pytorch/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/mnist%20study%20in%20pytorch/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>this is a work in progress</p>
<pre class="code python3"><a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-2"></a><span class="kn">import</span> <span class="nn">argparse</span>
<a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-3"></a><span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-4"></a><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-5"></a><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-6"></a><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-7"></a><span class="kn">from</span> <span class="nn">torchvision</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
<a name="rest_code_11e9e9f81bc84058abea84e60e7757cb-8"></a><span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="k">import</span> <span class="n">Variable</span>
</pre>
<pre class="code python3"><a name="rest_code_1ef75315943e4827bd06a1970e022033-1"></a><span class="k">class</span> <span class="nc">Args</span><span class="p">:</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-2"></a>    <span class="k">pass</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-3"></a>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-4"></a><span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">()</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-5"></a><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">12</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-6"></a><span class="n">args</span><span class="o">.</span><span class="n">cuda</span> <span class="o">=</span> <span class="kc">True</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-7"></a><span class="n">args</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.001</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-8"></a><span class="n">args</span><span class="o">.</span><span class="n">momentum</span> <span class="o">=</span> <span class="mf">0.01</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-9"></a><span class="n">args</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>
<a name="rest_code_1ef75315943e4827bd06a1970e022033-10"></a><span class="n">args</span><span class="o">.</span><span class="n">log_interval</span> <span class="o">=</span> <span class="mi">10</span>
</pre>
<pre class="code python3"><a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-1"></a><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'num_workers'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'pin_memory'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span> <span class="k">else</span> <span class="p">{}</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-2"></a><span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-3"></a>    <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-4"></a>                   <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-5"></a>                       <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-6"></a>                       <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-7"></a>                   <span class="p">])),</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-8"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-9"></a>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-10"></a><span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-11"></a>    <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-12"></a>                    <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-13"></a>                        <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-14"></a>                        <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-15"></a>                    <span class="p">])),</span>
<a name="rest_code_a3327dc1f0ef4049a83b69765d415fd9-16"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre>
<p>Lets take a look into how the dataset looks like</p>
<pre class="code python3"><a name="rest_code_96ee5086604942d2adc28bd9dd884b70-1"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-2"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-3"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-4"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-5"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-6"></a>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-7"></a><span class="n">num_of_samples</span> <span class="o">=</span> <span class="mi">5</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-8"></a>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-9"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">))</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-10"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-11"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">num_of_samples</span><span class="p">,</span> <span class="n">num_of_samples</span><span class="p">),</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-12"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-13"></a>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-14"></a><span class="n">output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_of_samples</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-15"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-16"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#dirty trick to take just one sample</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-17"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_of_samples</span> <span class="o">**</span> <span class="mi">2</span><span class="p">):</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-18"></a>            <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-19"></a>            <span class="n">output</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-20"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-21"></a>        <span class="k">break</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-22"></a>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-23"></a>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-24"></a><span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_of_samples</span><span class="p">,</span> <span class="n">num_of_sample</span><span class="p">)</span>
<a name="rest_code_96ee5086604942d2adc28bd9dd884b70-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
[[ 6.  9.  9.  5.  4.]
 [ 3.  6.  5.  0.  1.]
 [ 8.  1.  3.  6.  2.]
 [ 9.  4.  8.  8.  6.]
 [ 0.  6.  4.  2.  3.]]
</pre>
<img alt="/images/mnist_study_in_pytorch/output_12_0.png" src="images/mnist_study_in_pytorch/output_12_0.png"><p>You can see that the image of number &lt;&gt; is associated with number &lt;&gt;. It is a list of (image of number, number). As usual we are gonna feed the neural network with image from the left and its label from the right. We will train a set of feedforward networks in increasing order of complexity. What I mean by complexity is the number of neurons and number of layers.</p>
<pre class="code python3"><a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-1"></a><span class="k">class</span> <span class="nc">Model0</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-2"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-3"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model0</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-5"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-6"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-7"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-8"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-9"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-10"></a><span class="k">class</span> <span class="nc">Model1</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-11"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-12"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-15"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-16"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-17"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-18"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-19"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-20"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-21"></a><span class="k">class</span> <span class="nc">Model2</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-22"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-23"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-26"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-27"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-28"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-29"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-30"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-31"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-32"></a><span class="k">class</span> <span class="nc">Model3</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-33"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-34"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model3</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-37"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-38"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-39"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-40"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-41"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-42"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-43"></a><span class="k">class</span> <span class="nc">Model4</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-44"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-45"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model4</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-47"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-48"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-49"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-50"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-51"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-52"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-53"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-54"></a><span class="k">class</span> <span class="nc">Model5</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-55"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-56"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model5</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-59"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-60"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-61"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-62"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-63"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-64"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-65"></a><span class="k">class</span> <span class="nc">Model6</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-66"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-67"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model6</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-69"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-70"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-71"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-72"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-73"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-74"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-75"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-76"></a><span class="k">class</span> <span class="nc">Model7</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-77"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-78"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model7</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-79"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-80"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-81"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-82"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-83"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-84"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-85"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-86"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-87"></a><span class="k">class</span> <span class="nc">Model8</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-88"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-89"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model8</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-91"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-92"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-93"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-94"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-95"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-96"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-97"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-98"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-99"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-100"></a><span class="k">class</span> <span class="nc">Model9</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-101"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-102"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model9</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-104"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-107"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-108"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-109"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-110"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-111"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-112"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-113"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-114"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-115"></a><span class="k">class</span> <span class="nc">Model10</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-116"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-117"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model10</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-118"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-123"></a>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-124"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-125"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-126"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-127"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-128"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-129"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c73fed2df3d74962bc4ea8afc3e859d6-130"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre>
<p>Lets create the model instances. If you have GPU this is how you can make use of it, by calling .cuda() on models and tensors</p>
<pre class="code python3"><a name="rest_code_bde7b94ddbc343838097ba6b7628fc56-1"></a><span class="n">models</span> <span class="o">=</span> <span class="n">Model0</span><span class="p">(),</span> <span class="n">Model1</span><span class="p">(),</span> <span class="n">Model2</span><span class="p">(),</span> <span class="n">Model3</span><span class="p">(),</span> <span class="n">Model4</span><span class="p">(),</span> <span class="n">Model5</span><span class="p">(),</span> <span class="n">Model6</span><span class="p">(),</span> <span class="n">Model7</span><span class="p">(),</span> <span class="n">Model8</span><span class="p">(),</span> <span class="n">Model9</span><span class="p">(),</span> <span class="n">Model10</span><span class="p">()</span>
<a name="rest_code_bde7b94ddbc343838097ba6b7628fc56-2"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_bde7b94ddbc343838097ba6b7628fc56-3"></a>    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_bde7b94ddbc343838097ba6b7628fc56-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre>
<pre class="code python3"><a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-1"></a><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-2"></a>    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">momentum</span><span class="p">)</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-3"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-5"></a>        <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-6"></a>            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-7"></a>                <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-8"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-9"></a>            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-10"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-11"></a>            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-12"></a>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-13"></a>            <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-14"></a>            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-15"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-16"></a>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-17"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">print_every</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-18"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">'Train Epoch: </span><span class="si">{}</span><span class="s1"> [</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{:.0f}</span><span class="s1">%)]</span><span class="se">\t</span><span class="s1">Loss: </span><span class="si">{:.6f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-19"></a>                    <span class="n">i</span><span class="p">,</span> <span class="n">batch_idx</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span>
<a name="rest_code_8c1be9b0a1b049288fb109486a1ccf9d-20"></a>                    <span class="mf">100.</span> <span class="o">*</span> <span class="n">batch_idx</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">),</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre>
<p>This is where the actual training starts. It will take a while, so I just trained them for 100 times on entire training dataset.</p>
<pre class="code python3"><a name="rest_code_79978c4b455e4f8683a096536ce31a0c-1"></a><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_79978c4b455e4f8683a096536ce31a0c-2"></a>    <span class="n">train</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Train Epoch: 0 [59988/60000 (100%)]        Loss: 0.061506
.
.
.
.
Train Epoch: 98 [59988/60000 (100%)]       Loss: 0.018422
Train Epoch: 99 [59988/60000 (100%)]       Loss: 0.336890
</pre>
<p>Saving the model weights into a file, this should be in the above snippet or inside the training function for saving models every epoch.Lets just keep this simple</p>
<pre class="code python3"><a name="rest_code_36754242f1f64e918df96d0d7992f09e-1"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
<a name="rest_code_36754242f1f64e918df96d0d7992f09e-2"></a>    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s1">'mnist_mlp_multiple_model</span><span class="si">{}</span><span class="s1">.pth'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre>
<p>For the sake of completeness, this is how you load the saved models</p>
<pre class="code python3"><a name="rest_code_6be7cc5eddd542929d07f731673b67ef-1"></a><span class="n">models</span> <span class="o">=</span> <span class="n">Model0</span><span class="p">(),</span> <span class="n">Model1</span><span class="p">(),</span> <span class="n">Model2</span><span class="p">(),</span> <span class="n">Model3</span><span class="p">(),</span> <span class="n">Model4</span><span class="p">(),</span> <span class="n">Model5</span><span class="p">(),</span> <span class="n">Model6</span><span class="p">(),</span> <span class="n">Model7</span><span class="p">(),</span> <span class="n">Model8</span><span class="p">(),</span> <span class="n">Model9</span><span class="p">(),</span> <span class="n">Model10</span><span class="p">()</span>
<a name="rest_code_6be7cc5eddd542929d07f731673b67ef-2"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_6be7cc5eddd542929d07f731673b67ef-3"></a>    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_6be7cc5eddd542929d07f731673b67ef-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_6be7cc5eddd542929d07f731673b67ef-5"></a>
<a name="rest_code_6be7cc5eddd542929d07f731673b67ef-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
<a name="rest_code_6be7cc5eddd542929d07f731673b67ef-7"></a>    <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'mnist_mlp_multiple_model</span><span class="si">{}</span><span class="s1">.pth'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</pre>
<p>Before we run the model over the test dataset, let take a peek into how one of the model performs</p>
<pre class="code python3"><a name="rest_code_d56f1f8798e349838177a1add1f37421-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-5"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-6"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-7"></a>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-8"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">))</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-9"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>  <span class="c1"># similar to subplot(111)</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-10"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="c1"># creates 2x2 grid of axes</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-11"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># pad between axes in inch.</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-12"></a>                 <span class="p">)</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-13"></a>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-14"></a><span class="n">output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-15"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-16"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#dirty trick</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-17"></a>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-18"></a>        <span class="n">data1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-19"></a>        <span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-20"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">9</span><span class="p">](</span><span class="n">Variable</span><span class="p">(</span><span class="n">data1</span><span class="p">))</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-21"></a>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-22"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-23"></a>            <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-24"></a>            <span class="n">output</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-25"></a>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-26"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-27"></a>        <span class="k">break</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-28"></a>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-29"></a><span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-30"></a><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<a name="rest_code_d56f1f8798e349838177a1add1f37421-31"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
[[ 6.  2.  9.  1.  8.]
 [ 5.  6.  5.  7.  5.]
 [ 4.  8.  6.  3.  0.]
 [ 6.  1.  0.  9.  3.]
 [ 7.  2.  8.  4.  4.]]
</pre>
<img alt="/images/mnist_study_in_pytorch/output_12_0.png" src="images/mnist_study_in_pytorch/output_12_0.png"><p>As you can see, the results are not so bad.Lets test all our models.</p>
<pre class="code python3"><a name="rest_code_d981bd571008451fb687735a92faee73-1"></a><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-2"></a>    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-3"></a>    <span class="n">test_loss</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-4"></a>    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-5"></a>    <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">test_loader</span><span class="p">:</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-6"></a>        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-7"></a>            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-8"></a>
<a name="rest_code_d981bd571008451fb687735a92faee73-9"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-10"></a>        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">volatile</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-11"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-12"></a>        <span class="n">test_loss</span> <span class="o">+=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-13"></a>        <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># get the index of the max log-probability</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-14"></a>        <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-15"></a>
<a name="rest_code_d981bd571008451fb687735a92faee73-16"></a>    <span class="n">test_loss</span> <span class="o">=</span> <span class="n">test_loss</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-17"></a>    <span class="n">test_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)</span> <span class="c1"># loss function already averages over batch size</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Test set: Average loss: </span><span class="si">{:.4f}</span><span class="s1">, Accuracy: </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{:.0f}</span><span class="s1">%)</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-19"></a>        <span class="n">test_loss</span><span class="p">,</span> <span class="n">correct</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-20"></a>        <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)))</span>
<a name="rest_code_d981bd571008451fb687735a92faee73-21"></a>
<a name="rest_code_d981bd571008451fb687735a92faee73-22"></a>    <span class="k">return</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="code python3"><a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-5"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-6"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-7"></a>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-8"></a>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-9"></a><span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-10"></a><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-11"></a>    <span class="n">accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_tuts</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-12"></a>
<a name="rest_code_fa58bdcd5de54226a5d1e21206a6beee-13"></a><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Test set: Average loss: 0.2764, Accuracy: 9250/10000 (92%)
Test set: Average loss: 0.3591, Accuracy: 9010/10000 (90%)
Test set: Average loss: 0.3204, Accuracy: 9121/10000 (91%)
Test set: Average loss: 0.2954, Accuracy: 9189/10000 (92%)
Test set: Average loss: 0.2767, Accuracy: 9237/10000 (92%)
Test set: Average loss: 0.2699, Accuracy: 9267/10000 (93%)
Test set: Average loss: 0.2700, Accuracy: 9251/10000 (93%)
Test set: Average loss: 0.2690, Accuracy: 9244/10000 (92%)
Test set: Average loss: 0.2755, Accuracy: 9240/10000 (92%)
Test set: Average loss: 0.2745, Accuracy: 9253/10000 (93%)
Test set: Average loss: 0.2789, Accuracy: 9232/10000 (92%)

[92.5, 90.1, 91.21, 91.89, 92.37, 92.67, 92.51, 92.44, 92.4, 92.53, 92.32]
</pre>
<pre class="code python3"><a name="rest_code_bd0c52d5eb2d4e199a90c3f377f9c704-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)),</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_bd0c52d5eb2d4e199a90c3f377f9c704-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<a name="rest_code_bd0c52d5eb2d4e199a90c3f377f9c704-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_bd0c52d5eb2d4e199a90c3f377f9c704-4"></a>
<a name="rest_code_bd0c52d5eb2d4e199a90c3f377f9c704-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)),</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_bd0c52d5eb2d4e199a90c3f377f9c704-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">93</span><span class="p">])</span>
<a name="rest_code_bd0c52d5eb2d4e199a90c3f377f9c704-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/mnist_study_in_pytorch/output_11_0.png" src="images/mnist_study_in_pytorch/output_11_0.png"><img alt="/images/mnist_study_in_pytorch/output_11_1.png" src="images/mnist_study_in_pytorch/output_11_1.png"><p>The right image is a little zoomed in version of the left one. Little dissappointing, isn't it? The more complex models doesn't seem to perform as we would expect. So we can understand that the performance is not proportional to number of layers in neural network. It is in how they interact with each other.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/pytorch%20primer/" class="u-url">PyTorch Primer</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/pytorch%20primer/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/pytorch%20primer/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>This is post is inspired by <cite>Numpy Primer &lt;http://suriyadeepan.github.io/2016-06-26-numpy-primer/&gt;</cite></p>
<div class="section" id="lets-create-some-matrices">
<h2>Lets create some matrices</h2>
<pre class="code python3"><a name="rest_code_b1e763db52ee48a7b162f802ac125da0-1"></a> <span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-2"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-3"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-4"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-5"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-6"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-8"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-10"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-11"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-12"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-13"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-14"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-15"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-16"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-17"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-19"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-20"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-21"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-22"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-23"></a>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-24"></a><span class="o">-</span><span class="mf">0.0008</span> <span class="o">-</span><span class="mf">0.6619</span> <span class="o">-</span><span class="mf">0.6790</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-25"></a> <span class="mf">0.9104</span> <span class="o">-</span><span class="mf">0.1249</span> <span class="o">-</span><span class="mf">0.4044</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-26"></a><span class="o">-</span><span class="mf">1.0516</span> <span class="o">-</span><span class="mf">0.4031</span>  <span class="mf">0.9166</span>
<a name="rest_code_b1e763db52ee48a7b162f802ac125da0-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre>
<p>I think now we can understand what the parameters to the above functions mean - the shape of the tensor. Take a look at non square matrices below</p>
<pre class="code python3"><a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-3"></a>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-4"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-5"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-7"></a>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-8"></a>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-9"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-10"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-11"></a>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-12"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-13"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-14"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-15"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b99ed9b94e6c48cc891e0aa7307bdc25-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x3</span><span class="p">]</span>
</pre>
<p>How about a multidimensional vector - a tensor. Actually tensor is a general term for n-dimensional arrays like in numpy. If you were keen observant, you'd have notices by now that the output of every <strong>print(x)</strong> end with <strong>torch.FloatTensor</strong>. This term became famous with the deep learning storm.</p>
<pre class="code python3"><a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-3"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-7"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-8"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-9"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-10"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-11"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-12"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-15"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-16"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-19"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-20"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-21"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-22"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-23"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-27"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-28"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-29"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-30"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-31"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-32"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-33"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-34"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-35"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-36"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-37"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-38"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-39"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-40"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-41"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-42"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-43"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-44"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-45"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-46"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-47"></a>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-49"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-50"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_bf4c11c9919643e1b4f9598f7ef83d38-51"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x3x2x2x3</span><span class="p">]</span>
</pre>
<p>Pause for a moment and take a long look into how the tensor is printed.  And then proceed to look for more matrices below.
The identity matrix - matrix is the keyword.</p>
<pre class="code python3"><a name="rest_code_accb185aaf4947a7b58269ca197ccf53-1"></a><span class="c1"># The identity matrix - max upto two dimensions</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-4"></a>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-5"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-6"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-8"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-9"></a>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-10"></a>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-13"></a>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-14"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-15"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-16"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_accb185aaf4947a7b58269ca197ccf53-17"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x4</span><span class="p">]</span>
</pre>
<p>Alright I get it. Just ones and zeros are boring. Want some more numbers?
<strong>torch.linspace(start, end, count)</strong> creates a list of numbers starting with <strong>start</strong> to <strong>end</strong> at the interval of  <strong>(end - start)/(count - 1)</strong></p>
<pre class="code python3"><a name="rest_code_e10f0205c487409380b79dff9b4ea25d-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-3"></a>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-4"></a> <span class="mf">1.0000</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-5"></a> <span class="mf">1.5556</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-6"></a> <span class="mf">2.1111</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-7"></a> <span class="mf">2.6667</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-8"></a> <span class="mf">3.2222</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-9"></a> <span class="mf">3.7778</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-10"></a> <span class="mf">4.3333</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-11"></a> <span class="mf">4.8889</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-12"></a> <span class="mf">5.4444</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-13"></a> <span class="mf">6.0000</span>
<a name="rest_code_e10f0205c487409380b79dff9b4ea25d-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p><strong>torch.logspace()</strong> is similar to torch.linspace() but in logarthmic steps.</p>
<pre class="code python3"><a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-3"></a>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-4"></a>  <span class="mf">1.2589</span>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-5"></a>  <span class="mf">2.1135</span>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-6"></a>  <span class="mf">3.5481</span>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-7"></a>  <span class="mf">5.9566</span>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-8"></a> <span class="mf">10.0000</span>
<a name="rest_code_4e5dfc650a6f444bbbf658c50f0bce1e-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">5</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="arithmetics">
<h2>Arithmetics</h2>
<p>So what we created bunch of numbers. What is the use? Lets do some arithmetic</p>
<p>Elementwise addition</p>
<pre class="code python3"><a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-3"></a>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-4"></a> <span class="mi">1</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-5"></a> <span class="mi">1</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-6"></a> <span class="mi">1</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-7"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-8"></a>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-9"></a>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-10"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-11"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-12"></a>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-13"></a> <span class="mi">3</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-14"></a> <span class="mi">3</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-15"></a> <span class="mi">3</span>
<a name="rest_code_ae56ca8da2d84afeb4a3c04f01471037-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
</pre>
<p>Elementwise multiplication</p>
<pre class="code python3"><a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-3"></a>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-4"></a>  <span class="mi">1</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-5"></a>  <span class="mi">2</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-6"></a>  <span class="mi">3</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-7"></a>  <span class="mi">4</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-8"></a>  <span class="mi">5</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-9"></a>  <span class="mi">6</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-10"></a>  <span class="mi">7</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-11"></a>  <span class="mi">8</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-12"></a>  <span class="mi">9</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-13"></a> <span class="mi">10</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-15"></a>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-16"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-17"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-18"></a>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-19"></a>  <span class="mi">2</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-20"></a>  <span class="mi">4</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-21"></a>  <span class="mi">6</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-22"></a>  <span class="mi">8</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-23"></a> <span class="mi">10</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-24"></a> <span class="mi">12</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-25"></a> <span class="mi">14</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-26"></a> <span class="mi">16</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-27"></a> <span class="mi">18</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-28"></a> <span class="mi">20</span>
<a name="rest_code_8b2724e745e5479ba01a31cc36bc52a4-29"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p>Iterating over the elements and multiplying them by some number</p>
<pre class="code python3"><a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-1"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-2"></a>    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-3"></a>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-5"></a>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-6"></a>  <span class="mi">0</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-7"></a>  <span class="mi">2</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-8"></a>  <span class="mi">6</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-9"></a> <span class="mi">12</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-10"></a> <span class="mi">20</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-11"></a> <span class="mi">30</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-12"></a> <span class="mi">42</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-13"></a> <span class="mi">56</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-14"></a> <span class="mi">72</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-15"></a> <span class="mi">90</span>
<a name="rest_code_67665fcf41bf4fcda239728b504a4ae4-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p>So yes we can multiply the tensors by ordinary numbers, there is no need for 'i' to be a tensor, lets take a larger tensors, and assign its values by hand. So far we have been using the numbers generated by function like <strong>ones(), zeros() and rand()</strong>. In most cases we need our favoruite numbers. How to do this? <strong>torch.Tensor()</strong> to the rescue.</p>
<pre class="code python3"><a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">67</span><span class="p">])</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-3"></a>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-4"></a>  <span class="mi">1</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-5"></a>  <span class="mi">3</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-6"></a>  <span class="mi">5</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-7"></a>  <span class="mi">6</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-8"></a> <span class="mi">78</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-9"></a>  <span class="mi">3</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-10"></a> <span class="mi">67</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-11"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">7</span><span class="p">]</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-12"></a>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">)])</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-15"></a>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-16"></a>  <span class="mi">0</span>   <span class="mi">2</span>   <span class="mi">4</span>   <span class="mi">6</span>   <span class="mi">8</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-17"></a> <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>  <span class="mi">18</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-18"></a> <span class="mi">20</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_0bb46469d6824f8c9f25acce019cdf88-19"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x5</span><span class="p">]</span>
</pre>
<p>As we can see, the torch.Tensor() takes any iterable or iterables of iterable and makes a tensor out of it</p>
<p>Broadcasting
Adding a scalar to a tensor or multiplying a tensor by a scalar is essentially same as adding or multiplying the tensor by another tensor with shape same as the original tensor, with all its elements being the scalar. Too many words.</p>
<pre class="code python3"><a name="rest_code_450b353934714a978f18547a25c90eb4-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-3"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-4"></a>  <span class="mi">1</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-5"></a>  <span class="mi">2</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-6"></a>  <span class="mi">3</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-7"></a>  <span class="mi">4</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-8"></a>  <span class="mi">5</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-9"></a>  <span class="mi">6</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-10"></a>  <span class="mi">7</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-11"></a>  <span class="mi">8</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-12"></a>  <span class="mi">9</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-13"></a> <span class="mi">10</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-15"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-16"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-17"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-19"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-20"></a> <span class="mi">2</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-21"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-22"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-23"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-24"></a><span class="c1"># broadcasting  https://discuss.pytorch.org/t/broadcasting-or-alternative-solutions/120</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-25"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-26"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-27"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-28"></a>  <span class="mi">2</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-29"></a>  <span class="mi">4</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-30"></a>  <span class="mi">6</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-31"></a>  <span class="mi">8</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-32"></a> <span class="mi">10</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-33"></a> <span class="mi">12</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-34"></a> <span class="mi">14</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-35"></a> <span class="mi">16</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-36"></a> <span class="mi">18</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-37"></a> <span class="mi">20</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-38"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-39"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-40"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-41"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-42"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-43"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-44"></a> <span class="mi">2</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-45"></a> <span class="mi">3</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-46"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="p">]</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-47"></a>
<a name="rest_code_450b353934714a978f18547a25c90eb4-48"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>        <span class="c1">#Dont' work</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-49"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-50"></a>  <span class="n">File</span> <span class="s2">"&lt;stdin&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-51"></a>  <span class="n">File</span> <span class="s2">"/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">274</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand_as</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-52"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-53"></a>  <span class="n">File</span> <span class="s2">"/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">261</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-54"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'incorrect size: only supporting singleton expansion (size=1)'</span><span class="p">)</span>
<a name="rest_code_450b353934714a978f18547a25c90eb4-55"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="n">incorrect</span> <span class="n">size</span><span class="p">:</span> <span class="n">only</span> <span class="n">supporting</span> <span class="n">singleton</span> <span class="n">expansion</span> <span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre>
<p>Note that the expand_as() works only for singletons</p>
<div class="section" id="reshaping-tensors">
<h3>Reshaping Tensors</h3>
<p><strong>view()</strong> takes list of number and reshapes the tensor as per the arguments.</p>
<p>The constrain is for view(a, b, c,....n) a x b x c x ... x n should be equal to the size of the given tensor. If you give <em>'-1'</em> as the last argument to <strong>view()</strong> it will calculate the last dimension by itself.</p>
<pre class="code python3"><a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-3"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-4"></a>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-5"></a>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x5</span><span class="p">]</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-7"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-8"></a><span class="c1"># making matrices by hand is hard right?</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-9"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-10"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-12"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-13"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-14"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-15"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-16"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-17"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-18"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-20"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-21"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-22"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-23"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-24"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-25"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-26"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-27"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-28"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-29"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-30"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-31"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-32"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-33"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-34"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-35"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-36"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-37"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-39"></a>   <span class="mi">5</span>   <span class="mi">6</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-40"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-41"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-42"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-43"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-44"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-45"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-46"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-47"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-48"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-49"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-50"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-51"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-52"></a><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-53"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-54"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-55"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-56"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-57"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-58"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-59"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-60"></a>   <span class="mi">5</span>  <span class="o">-</span><span class="mi">6</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-61"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-62"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-63"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-64"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-65"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-66"></a>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-67"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-68"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-69"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_7a25dfc4abe643148a0eb3658b48ae4e-70"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
</pre>
<p>Notice that change in value of an element in <strong>x</strong> reflects in <strong>x_</strong>. It is because view() does exactly what is says it will do. It creates a view of the tensor, the underlying storage is same for <strong>x</strong> and <strong>x_</strong></p>
</div>
<div class="section" id="statistics">
<h3>Statistics</h3>
<pre class="code python3"><a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-1"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-2"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-4"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-5"></a>  <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-6"></a>  <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-7"></a>  <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-8"></a> <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-10"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-12"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-13"></a> <span class="mi">28</span>  <span class="mi">32</span>  <span class="mi">36</span>  <span class="mi">40</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-15"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-16"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-17"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-18"></a> <span class="mi">10</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-19"></a> <span class="mi">26</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-20"></a> <span class="mi">42</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-21"></a> <span class="mi">58</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-22"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x1</span><span class="p">]</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-23"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-24"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-26"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-27"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-28"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-29"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-30"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-31"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-32"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-33"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-34"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-35"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-36"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-37"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-39"></a>  <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-40"></a>  <span class="mi">18</span>  <span class="mi">20</span>  <span class="mi">22</span>  <span class="mi">24</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-41"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-42"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-44"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-45"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-46"></a>   <span class="mi">6</span>   <span class="mi">8</span>  <span class="mi">10</span>  <span class="mi">12</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-47"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-49"></a>  <span class="mi">22</span>  <span class="mi">24</span>  <span class="mi">26</span>  <span class="mi">28</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-50"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x1x4</span><span class="p">]</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-51"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-52"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-53"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-54"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-55"></a>  <span class="mi">10</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-56"></a>  <span class="mi">26</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-57"></a>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-58"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-59"></a>  <span class="mi">42</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-60"></a>  <span class="mi">58</span>
<a name="rest_code_daa2c47ad72b494ebba3fa2e58831210-61"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x1</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="matrix-multiplication">
<h3>Matrix Multiplication</h3>
<p><strong>mm()</strong> is name. See how it is different from normal elementwise multiplication, like we used to do in linear algebra class?</p>
<pre class="code python3"><a name="rest_code_48b81f9572764c06887145fac1d52b3d-1"></a><span class="c1">#lets do some matrix multiplications</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-2"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-3"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]])</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-4"></a>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-6"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-7"></a>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-9"></a>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-10"></a>  <span class="mi">70</span>  <span class="mi">100</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-11"></a> <span class="mi">150</span>  <span class="mi">220</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-12"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2</span><span class="p">]</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-13"></a>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-14"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-15"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-16"></a>                  <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-17"></a>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-18"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-19"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-21"></a>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-22"></a>  <span class="mi">70</span>  <span class="mi">100</span>  <span class="mi">170</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-23"></a> <span class="mi">150</span>  <span class="mi">220</span>  <span class="mi">390</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-24"></a> <span class="mi">230</span>  <span class="mi">340</span>  <span class="mi">610</span>
<a name="rest_code_48b81f9572764c06887145fac1d52b3d-25"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="indexing-and-slicing">
<h3>Indexing and slicing</h3>
<pre class="code python3"><a name="rest_code_c31958a2f26549af86ea0265c39aed98-1"></a><span class="c1">#Indexing and slicing</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-4"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-5"></a>  <span class="mi">1</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-6"></a>  <span class="mi">2</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-7"></a>  <span class="mi">3</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-8"></a>  <span class="mi">4</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-9"></a>  <span class="mi">5</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-10"></a>  <span class="o">.</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-11"></a>  <span class="o">.</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-12"></a>  <span class="o">.</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-13"></a> <span class="mi">61</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-14"></a> <span class="mi">62</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-15"></a> <span class="mi">63</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-16"></a> <span class="mi">64</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-17"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-19"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-20"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-21"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-23"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-25"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-26"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-27"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-28"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-29"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-30"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-31"></a>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">20</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-32"></a>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-33"></a>  <span class="mi">25</span>  <span class="mi">26</span>  <span class="mi">27</span>  <span class="mi">28</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-34"></a>  <span class="mi">29</span>  <span class="mi">30</span>  <span class="mi">31</span>  <span class="mi">32</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-35"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-36"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-37"></a>  <span class="mi">33</span>  <span class="mi">34</span>  <span class="mi">35</span>  <span class="mi">36</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-38"></a>  <span class="mi">37</span>  <span class="mi">38</span>  <span class="mi">39</span>  <span class="mi">40</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-39"></a>  <span class="mi">41</span>  <span class="mi">42</span>  <span class="mi">43</span>  <span class="mi">44</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-40"></a>  <span class="mi">45</span>  <span class="mi">46</span>  <span class="mi">47</span>  <span class="mi">48</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-41"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-42"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-43"></a>  <span class="mi">49</span>  <span class="mi">50</span>  <span class="mi">51</span>  <span class="mi">52</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-44"></a>  <span class="mi">53</span>  <span class="mi">54</span>  <span class="mi">55</span>  <span class="mi">56</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-45"></a>  <span class="mi">57</span>  <span class="mi">58</span>  <span class="mi">59</span>  <span class="mi">60</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-46"></a>  <span class="mi">61</span>  <span class="mi">62</span>  <span class="mi">63</span>  <span class="mi">64</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-47"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-48"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-49"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-50"></a>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-51"></a> <span class="mi">21</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-52"></a> <span class="mi">22</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-53"></a> <span class="mi">23</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-54"></a> <span class="mi">24</span>
<a name="rest_code_c31958a2f26549af86ea0265c39aed98-55"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="masking">
<h3>Masking</h3>
<pre class="code python3"><a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-1"></a><span class="c1">#the expression 'x_ % 4 == 0' creates a mask</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-3"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-7"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-8"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-9"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-10"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-11"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-12"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-15"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-16"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-19"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-20"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-21"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-22"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-23"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-24"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-28"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-29"></a><span class="c1"># Use the mask to extract just those elements</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-30"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-31"></a><span class="n">x_</span><span class="p">[</span><span class="mi">0</span><span class="p">][(</span><span class="n">x_</span><span class="o">%</span><span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-32"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-33"></a>  <span class="mi">4</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-34"></a>  <span class="mi">8</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-35"></a> <span class="mi">12</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-36"></a> <span class="mi">16</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-37"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-38"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-39"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-40"></a><span class="c1">#more grander masking example</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-41"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-42"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-44"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-45"></a>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-46"></a>  <span class="mi">2</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-47"></a>  <span class="mi">3</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-48"></a>  <span class="mi">4</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-49"></a>  <span class="mi">5</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-50"></a>  <span class="o">.</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-51"></a>  <span class="o">.</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-52"></a>  <span class="o">.</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-53"></a> <span class="mi">61</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-54"></a> <span class="mi">62</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-55"></a> <span class="mi">63</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-56"></a> <span class="mi">64</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-57"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-58"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-59"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-60"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-61"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-62"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-63"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-64"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-65"></a>   <span class="mi">17</span>    <span class="mi">18</span>    <span class="mi">19</span>    <span class="mi">20</span>    <span class="mi">21</span>    <span class="mi">22</span>    <span class="mi">23</span>    <span class="mi">24</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-66"></a>   <span class="mi">25</span>    <span class="mi">26</span>    <span class="mi">27</span>    <span class="mi">28</span>    <span class="mi">29</span>    <span class="mi">30</span>    <span class="mi">31</span>    <span class="mi">32</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-67"></a>   <span class="mi">33</span>    <span class="mi">34</span>    <span class="mi">35</span>    <span class="mi">36</span>    <span class="mi">37</span>    <span class="mi">38</span>    <span class="mi">39</span>    <span class="mi">40</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-68"></a>   <span class="mi">41</span>    <span class="mi">42</span>    <span class="mi">43</span>    <span class="mi">44</span>    <span class="mi">45</span>    <span class="mi">46</span>    <span class="mi">47</span>    <span class="mi">48</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-69"></a>   <span class="mi">49</span>    <span class="mi">50</span>    <span class="mi">51</span>    <span class="mi">52</span>    <span class="mi">53</span>    <span class="mi">54</span>    <span class="mi">55</span>    <span class="mi">56</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-70"></a>   <span class="mi">57</span>    <span class="mi">58</span>    <span class="mi">59</span>    <span class="mi">60</span>    <span class="mi">61</span>    <span class="mi">62</span>    <span class="mi">63</span>    <span class="mi">64</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-71"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-72"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-73"></a><span class="n">x_ind</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">byte</span><span class="p">()</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-74"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_ind</span><span class="p">)</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-75"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-76"></a>    <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-77"></a>    <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-78"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-79"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-80"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-81"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-82"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-83"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-84"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-85"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-86"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x_ind</span><span class="p">])</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-87"></a>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-88"></a>  <span class="mi">1</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-89"></a> <span class="mi">10</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-90"></a> <span class="mi">19</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-91"></a> <span class="mi">28</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-92"></a> <span class="mi">37</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-93"></a> <span class="mi">46</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-94"></a> <span class="mi">55</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-95"></a> <span class="mi">64</span>
<a name="rest_code_2bc2fa7b067c4ee68313e61b2afdc5b6-96"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="p">]</span>
</pre>
<p>Please leave your comments below.</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/vanangamudimnist/" class="u-url">VanangamudiMNIST</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/vanangamudimnist/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/vanangamudimnist/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<pre class="code python3"><a name="rest_code_47b314f290464e61b13958fd698ffd92-1"></a><span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_47b314f290464e61b13958fd698ffd92-2"></a><span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="k">import</span> <span class="n">Variable</span>
</pre>
<div class="section" id="dataset">
<h2>DATASET</h2>
<pre class="code python3"><a name="rest_code_9617902e264a400ab009c42e955e3dfd-1"></a><span class="n">dataset</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#list of tuples (image, label)</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-2"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-3"></a><span class="n">zer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-4"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-5"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-6"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-7"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-8"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-9"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-10"></a><span class="n">one</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-11"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-12"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-13"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-14"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-15"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-16"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-17"></a><span class="n">two</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-18"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-19"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-20"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-21"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-22"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-23"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-24"></a><span class="n">thr</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-25"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-26"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-27"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-28"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-29"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-30"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-31"></a><span class="n">fou</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-32"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-33"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-34"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-35"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-36"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-37"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-38"></a><span class="n">fiv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-39"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-40"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-41"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-42"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-43"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-44"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-45"></a><span class="n">six</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-46"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-47"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-48"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-49"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-50"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-51"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-52"></a><span class="n">sev</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-53"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-54"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-55"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-56"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-57"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-58"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-59"></a><span class="n">eig</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-60"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-61"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-62"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-63"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-64"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-65"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-66"></a><span class="n">nin</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-67"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-68"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-69"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-70"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-71"></a>                   <span class="p">])</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-72"></a>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-73"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">zer</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-74"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">one</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-75"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">two</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-76"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">thr</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-77"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fou</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">4</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-78"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fiv</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">5</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-79"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">six</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">6</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-80"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sev</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">7</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-81"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">eig</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">8</span><span class="p">])))</span>
<a name="rest_code_9617902e264a400ab009c42e955e3dfd-82"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nin</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">9</span><span class="p">])))</span>
</pre>
<div class="section" id="take-a-look-into-how-the-data-looks-like">
<h3>Take a look into how the data looks like</h3>
<pre class="code python3"><a name="rest_code_025c88b0201643138594c49642ec9d19-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-5"></a>
<a name="rest_code_025c88b0201643138594c49642ec9d19-6"></a><span class="k">def</span> <span class="nf">showImage</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-7"></a>    <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-8"></a>    <span class="n">image</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-9"></a>
<a name="rest_code_025c88b0201643138594c49642ec9d19-10"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">))</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-11"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-12"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-13"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-14"></a>
<a name="rest_code_025c88b0201643138594c49642ec9d19-15"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-16"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_025c88b0201643138594c49642ec9d19-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_4_0.png" src="images/vanangamudimnist/output_4_0.png">
</div>
</div>
<div class="section" id="model">
<h2>MODEL</h2>
<pre class="code python3"><a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-1"></a><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-2"></a><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-3"></a><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-4"></a>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-5"></a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-6"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-7"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-9"></a>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-10"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-11"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_a5a59d7cae204b738dc333e83e9c924c-12"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre>
<pre class="code python3"><a name="rest_code_007c2abcf78844c4961fcfe3e0db46c4-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<a name="rest_code_007c2abcf78844c4961fcfe3e0db46c4-2"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="training">
<h2>Training</h2>
<div class="section" id="train-for-a-single-epoch">
<h3>Train for a single epoch</h3>
<pre class="code python3"><a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-1"></a><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-2"></a>    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-3"></a>    <span class="n">avg_loss</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-4"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-5"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-6"></a>        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">())</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-7"></a>        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-8"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-9"></a>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-10"></a>        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-11"></a>        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-12"></a>        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-13"></a>        <span class="n">avg_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-14"></a>
<a name="rest_code_ee1ef11cb63f4f8db6d777f2a663f11c-15"></a>    <span class="k">return</span> <span class="n">avg_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="dataset-model-output">
<h3>DATASET - MODEL - OUTPUT</h3>
<pre class="code python3"><a name="rest_code_dacd2b7fc807474c9a68be147388abb7-1"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">16.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">))</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-2"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-3"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-4"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-5"></a>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-6"></a>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-7"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-8"></a><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-9"></a>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-10"></a><span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-11"></a><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-12"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-13"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-14"></a>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-15"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-16"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-17"></a>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-18"></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-19"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-20"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-21"></a>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-22"></a>
<a name="rest_code_dacd2b7fc807474c9a68be147388abb7-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_12_0.png" src="images/vanangamudimnist/output_12_0.png"><pre class="code python3"><a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-1"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">12.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">))</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-2"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-3"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-4"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-5"></a>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-7"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-8"></a>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-10"></a>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-11"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">))</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-12"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-13"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-14"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-15"></a>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-16"></a>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-17"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-18"></a>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-19"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-20"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_78edb8132e514e74ae6dd48e5e2e2e28-21"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</pre>
<img alt="/images/vanangamudimnist/output_13_0.png" src="images/vanangamudimnist/output_13_0.png"><img alt="/images/vanangamudimnist/output_13_1.png" src="images/vanangamudimnist/output_13_1.png">
</div>
<div class="section" id="how-many-correct-predictions-without-any-training">
<h3>How many correct predictions without any training</h3>
<pre class="code python3"><a name="rest_code_6a28db43b02a4ce39d59d6ad1ddb2692-1"></a><span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_6a28db43b02a4ce39d59d6ad1ddb2692-2"></a><span class="n">correct</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_6a28db43b02a4ce39d59d6ad1ddb2692-3"></a><span class="nb">print</span><span class="p">(</span><span class="s1">'correct: </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)))</span>
</pre>
<pre class="literal-block">
correct: 0/10
</pre>
</div>
<div class="section" id="lets-combine-the-above-two-blocks-and-make-a-function-out-of-it">
<h3>lets combine the above two blocks and make a function out of it</h3>
<pre class="code python3"><a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-1"></a><span class="k">def</span> <span class="nf">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-2"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-3"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-4"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-5"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-6"></a>    <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-7"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-8"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-9"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-10"></a>    <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">()))</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-11"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-12"></a>    <span class="n">dataset_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-13"></a>    <span class="n">model_img</span>   <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-14"></a>    <span class="n">output_img</span>  <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-15"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-16"></a>    <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-17"></a>    <span class="n">correct</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-18"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-19"></a>    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-20"></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">16.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">))</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-21"></a>        <span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-22"></a>                         <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-23"></a>                         <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-24"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-25"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">dataset_img</span><span class="p">)</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-26"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-27"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-28"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">model_img</span><span class="p">)</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-29"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-30"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-31"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">output_img</span><span class="p">)</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-32"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-33"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-34"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-35"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-36"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">'correct: </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">, loss:</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-37"></a>
<a name="rest_code_ff325718a7744b9a9528f8ebf17eedc4-38"></a>    <span class="k">return</span> <span class="n">dataset_img</span><span class="p">,</span> <span class="n">model_img</span><span class="p">,</span> <span class="n">output_img</span>
</pre>
</div>
<div class="section" id="lets-take-a-closer-look">
<h3>Lets take a closer look</h3>
<p>with help from,
<a class="reference external" href="https://stackoverflow.com/questions/20998083/show-the-values-in-the-grid-using-matplotlib">https://stackoverflow.com/questions/20998083/show-the-values-in-the-grid-using-matplotlib</a></p>
<pre class="code python3"><a name="rest_code_c338d006c5194f1fb813ea3d9098665a-1"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-2"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-3"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-4"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-5"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-6"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-7"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-8"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-9"></a><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-10"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-11"></a><span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-12"></a><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-13"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-14"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-15"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-16"></a><span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-17"></a>     <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:d}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-18"></a>            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-19"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-20"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-21"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-22"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-23"></a><span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-24"></a>     <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:0.04f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-25"></a>            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-26"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-27"></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-28"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-29"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-30"></a><span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-31"></a>     <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:0.04f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-32"></a>            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-33"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-34"></a>
<a name="rest_code_c338d006c5194f1fb813ea3d9098665a-35"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_19_0.png" src="images/vanangamudimnist/output_19_0.png"><pre class="code python3"><a name="rest_code_7ba65ffbf8ba49a1a6751d8c7a9bb3c6-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))))</span>
</pre>
<pre class="literal-block">
Variable containing:
-2.6310 -2.2685 -2.7027 -1.6844 -2.3093 -2.8675 -2.0508 -2.2570 -2.9351 -2.0451
[torch.FloatTensor of size 1x10]
</pre>
<pre class="code python3"><a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-1"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-2"></a><span class="k">def</span> <span class="nf">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-3"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-4"></a>    <span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-5"></a>                         <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-6"></a>                         <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-7"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-8"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-9"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-10"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-11"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-12"></a>    <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-13"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-14"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-15"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-16"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-17"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-18"></a>         <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:d}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-19"></a>                <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-20"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-21"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-22"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-23"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-24"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-25"></a>         <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:0.04f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-26"></a>                <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-27"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-28"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-29"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-30"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-31"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-32"></a>         <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:0.04f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-33"></a>                <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-34"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-35"></a>
<a name="rest_code_8dabbc41fd334a9a988cfc1f1dfe6234-36"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="before-training">
<h3>Before Training</h3>
<pre class="code python3"><a name="rest_code_fa82ee3d96c64459afc104a48097a603-1"></a><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_fa82ee3d96c64459afc104a48097a603-2"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<img alt="/images/vanangamudimnist/output_23_0.png" src="images/vanangamudimnist/output_23_0.png"><pre class="literal-block">
correct: 0/10, loss:2.4226558208465576
</pre>
<img alt="/images/vanangamudimnist/output_23_2.png" src="images/vanangamudimnist/output_23_2.png">
</div>
<div class="section" id="train-the-model-once-and-see-how-it-works">
<h3>Train the model once and see how it works</h3>
<pre class="code python3"><a name="rest_code_f63bc6d5840f4b6eb3b7b45a313cf0d5-1"></a><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
2.7791757822036742
</pre>
<pre class="code python3"><a name="rest_code_51e2a4772335434ca4846e5a839efa79-1"></a><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_51e2a4772335434ca4846e5a839efa79-2"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<img alt="/images/vanangamudimnist/output_26_0.png" src="images/vanangamudimnist/output_26_0.png"><pre class="literal-block">
correct: 1/10, loss:2.178180694580078
</pre>
<img alt="/images/vanangamudimnist/output_26_2.png" src="images/vanangamudimnist/output_26_2.png">
</div>
<div class="section" id="train-once-more-and-see-the-internals">
<h3>train once more and see the internals</h3>
<pre class="code python3"><a name="rest_code_788b4e8a69184f6c87e5dee2ce2af772-1"></a><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
2.5523715019226074
</pre>
<pre class="code python3"><a name="rest_code_2564d2ab70d34439a1b17139331846ef-1"></a><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_2564d2ab70d34439a1b17139331846ef-2"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<img alt="/images/vanangamudimnist/output_29_0.png" src="images/vanangamudimnist/output_29_0.png"><pre class="literal-block">
correct: 3/10, loss:2.002211093902588
</pre>
<img alt="/images/vanangamudimnist/output_29_2.png" src="images/vanangamudimnist/output_29_2.png"><pre class="code python3"><a name="rest_code_adaa6d47412d43bb8877ee0d10e8d280-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_adaa6d47412d43bb8877ee0d10e8d280-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_adaa6d47412d43bb8877ee0d10e8d280-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Columns 0 to 12
    0     0     1     1     1     0     0     1     0     1     0     0     1
    0     0     0     1     0     0     0     1     1     0     0     0     0
    0     0     1     1     1     0     0     0     0     1     0     0     1
    0     0     1     1     1     0     0     0     0     1     0     0     0
    0     0     1     0     1     0     0     1     0     1     0     0     1
    0     0     1     1     1     0     0     1     0     0     0     0     1
    0     0     1     1     1     0     0     1     0     0     0     0     1
    0     0     1     1     1     0     0     0     0     1     0     0     0
    0     0     1     1     1     0     0     1     0     1     0     0     1
    0     0     1     1     1     0     0     1     0     1     0     0     1

Columns 13 to 24
    0     1     0     0     1     0     1     0     0     1     1     1
    1     0     0     0     0     1     0     0     0     1     1     1
    1     1     0     0     1     0     0     0     0     1     1     1
    1     1     0     0     0     0     1     0     0     1     1     1
    1     1     0     0     0     0     1     0     0     0     0     1
    1     1     0     0     0     0     1     0     0     1     1     1
    1     1     0     0     1     0     1     0     0     1     1     1
    0     1     0     0     0     0     1     0     0     0     0     1
    1     1     0     0     1     0     1     0     0     1     1     1
    1     1     0     0     0     0     1     0     0     1     1     1
[torch.FloatTensor of size 10x25]



Columns 0 to 9
-0.0775 -0.0061 -0.0071  0.1463 -0.1230  0.0227  0.0463 -0.0465 -0.1198  0.0708
-0.0960  0.1528 -0.0926  0.0864 -0.1663  0.0769 -0.0363  0.1534  0.1049 -0.1288
 0.0276 -0.0589  0.0924 -0.0903 -0.0308 -0.0125  0.0882 -0.2251 -0.0315  0.1383
 0.0111 -0.1083  0.0613 -0.0896 -0.0466  0.0821 -0.1129 -0.1794 -0.1222  0.1119
-0.0691  0.1172 -0.0798 -0.2986  0.1729 -0.0716 -0.0129  0.0876 -0.0316  0.1776
-0.0339 -0.1906 -0.1352  0.0487  0.0832  0.1772 -0.1550  0.0129  0.0819 -0.2758
-0.1543 -0.1738  0.0953 -0.2080  0.1313 -0.0913  0.0670 -0.1560  0.1633 -0.0711
-0.0094 -0.1027  0.0004 -0.0643  0.1243  0.1438  0.1580 -0.2372  0.1431  0.1654
 0.1362 -0.1573  0.1594 -0.0289  0.1687 -0.1899  0.1157 -0.0792 -0.1001 -0.0151
-0.0201  0.0337 -0.0241  0.2104  0.1608  0.0809 -0.1552 -0.0117  0.1460  0.0480

Columns 10 to 19
-0.1558  0.1090  0.0960 -0.1309 -0.0409 -0.0088  0.0410 -0.0089  0.0684  0.0250
 0.0668 -0.1753 -0.2620 -0.0575 -0.2509  0.1885 -0.1592 -0.0623  0.0243 -0.0514
 0.1202 -0.1700 -0.0461 -0.0950  0.0881 -0.0374  0.1558  0.1514  0.0030 -0.1964
 0.1443 -0.1058 -0.3234 -0.1575  0.0171  0.1277  0.1745  0.0623  0.1512  0.1205
-0.1277  0.1327  0.0083  0.0360  0.1246 -0.0239 -0.1319 -0.1319  0.0878 -0.1434
 0.1563  0.1458  0.2015 -0.0692 -0.1107 -0.0947 -0.1483 -0.1704  0.1684  0.2312
-0.1601  0.1189 -0.1619  0.1456  0.1256  0.0410  0.0905  0.1292 -0.0377  0.1647
 0.0471  0.0785  0.0429 -0.0644  0.0917 -0.1105  0.1714 -0.0471  0.0624  0.0284
 0.0962 -0.1139 -0.0221  0.2518  0.1174 -0.1687  0.0239  0.2354  0.1081 -0.1129
-0.0703  0.1948  0.1462 -0.0811  0.0574 -0.0644 -0.1046 -0.2400  0.0926  0.2163

Columns 20 to 24
-0.0508 -0.0765 -0.0687  0.0739 -0.2297
 0.0377 -0.0319  0.0110  0.2238 -0.0110
 0.1466  0.1324 -0.0583 -0.0821  0.1188
 0.1669  0.1309  0.1754 -0.0106  0.1148
-0.1915  0.0448 -0.0192 -0.0364 -0.1001
-0.0478 -0.0359  0.1435 -0.0016 -0.0797
 0.1716  0.0418  0.0949  0.0791 -0.0613
 0.1299  0.0025 -0.2672 -0.0257  0.0699
-0.0256 -0.0980  0.0459 -0.1216  0.0568
 0.0782 -0.0537  0.2157  0.1004 -0.1848
[torch.FloatTensor of size 10x25]


-2.6310 -2.2685 -2.7027 -1.6844 -2.3093 -2.8675 -2.0508 -2.2570 -2.9351 -2.0451
-2.3111 -2.5781 -2.8429 -2.1439 -2.1065 -2.3409 -2.2654 -2.1675 -2.5843 -1.9814
-2.4300 -2.5531 -2.7617 -2.0206 -2.1601 -3.1099 -1.8916 -2.0229 -2.3853 -2.2703
-2.4533 -2.4207 -2.7293 -2.0219 -2.3339 -3.0570 -1.6293 -2.3657 -2.6332 -2.1060
-2.5164 -2.4800 -2.3811 -2.0388 -2.4169 -2.8624 -1.8470 -2.0271 -2.4557 -2.3934
-2.3725 -2.3360 -2.8593 -2.0409 -2.3049 -2.6920 -2.0207 -2.2202 -2.6686 -1.9323
-2.4916 -2.3202 -2.8539 -1.8623 -2.3450 -2.7756 -1.9968 -2.1851 -2.5846 -2.0858
-2.5090 -2.3410 -2.2558 -1.9410 -2.5716 -2.8679 -1.8594 -2.4068 -2.5268 -2.1622
-2.4983 -2.3660 -2.8174 -1.8228 -2.2903 -2.9784 -1.8904 -2.1410 -2.7288 -2.1487
-2.3764 -2.3790 -2.8200 -1.9986 -2.2475 -2.8920 -1.9115 -2.1734 -2.8101 -1.9925
[torch.FloatTensor of size 10x10]
</pre>
</div>
<div class="section" id="train-over-multiple-epochs">
<h3>Train over multiple epochs</h3>
<pre class="code python3"><a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-1"></a><span class="k">def</span> <span class="nf">train_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-2"></a>    <span class="n">snaps</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-3"></a>    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-4"></a>        <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-5"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">epoch</span> <span class="o">%</span> <span class="n">print_every</span><span class="p">:</span>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-6"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">'epoch: </span><span class="si">{}</span><span class="s1">, loss:</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">avg_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-7"></a>            <span class="n">snaps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">))</span>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-8"></a>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-9"></a>
<a name="rest_code_d36bbe9e65094a19af663d52b40efc4b-10"></a>            <span class="k">return</span> <span class="n">snaps</span>
</pre>
<pre class="code python3"><a name="rest_code_d1d324248df54cb89be27d1caa68f995-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<a name="rest_code_d1d324248df54cb89be27d1caa68f995-2"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre>
<pre class="code python3"><a name="rest_code_a0b8edac20c24a138a68d10f416eb412-1"></a><span class="n">snaps</span> <span class="o">=</span> <span class="n">train_epochs</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
epoch: 0, loss:0.024241248846054074
</pre>
<img alt="/images/vanangamudimnist/output_34_1.png" src="images/vanangamudimnist/output_34_1.png"><pre class="literal-block">
correct: 1/10, loss:2.3493340015411377
</pre>
<pre class="code python3"><a name="rest_code_b4d2f179817a43a6918b175adfed59cb-1"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">16.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">))</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-2"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-3"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snaps</span><span class="p">)</span> <span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-4"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-5"></a>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">snap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snaps</span><span class="p">):</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-7"></a>    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snap</span><span class="p">):</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-8"></a>        <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-9"></a>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-10"></a><span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-11"></a><span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-12"></a><span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-13"></a>
<a name="rest_code_b4d2f179817a43a6918b175adfed59cb-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_35_0.png" src="images/vanangamudimnist/output_35_0.png"><pre class="code python3"><a name="rest_code_7d9b90fc1cbd412e9de79f51d81b58cf-1"></a><span class="n">snaps</span> <span class="o">=</span> <span class="n">train_epochs</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre>
<pre class="literal-block">
epoch: 0, loss:1.4979378305724824e-05
</pre>
<img alt="/images/vanangamudimnist/output_36_1.png" src="images/vanangamudimnist/output_36_1.png"><pre class="literal-block">
correct: 10/10, loss:0.0014949440956115723
epoch: 1000, loss:1.3566501729656011e-05
</pre>
<img alt="/images/vanangamudimnist/output_36_3.png" src="images/vanangamudimnist/output_36_3.png"><pre class="literal-block">
correct: 10/10, loss:0.0013541923835873604
epoch: 2000, loss:1.2397395898005925e-05
</pre>
<img alt="/images/vanangamudimnist/output_36_5.png" src="images/vanangamudimnist/output_36_5.png"><pre class="literal-block">
correct: 10/10, loss:0.0012376849772408605
epoch: 3000, loss:1.141426396497991e-05
</pre>
<img alt="/images/vanangamudimnist/output_36_7.png" src="images/vanangamudimnist/output_36_7.png"><pre class="literal-block">
correct: 10/10, loss:0.0011396838817745447
epoch: 4000, loss:1.0574486601399258e-05
</pre>
<img alt="/images/vanangamudimnist/output_36_9.png" src="images/vanangamudimnist/output_36_9.png"><pre class="literal-block">
correct: 10/10, loss:0.0010559528600424528
epoch: 5000, loss:9.851084818365054e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_11.png" src="images/vanangamudimnist/output_36_11.png"><pre class="literal-block">
correct: 10/10, loss:0.0009838090045377612
epoch: 6000, loss:9.220464067766443e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_13.png" src="images/vanangamudimnist/output_36_13.png"><pre class="literal-block">
correct: 10/10, loss:0.000920907303225249
epoch: 7000, loss:8.666477806400509e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_15.png" src="images/vanangamudimnist/output_36_15.png"><pre class="literal-block">
correct: 10/10, loss:0.0008656416903249919
epoch: 8000, loss:8.17526801256463e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_17.png" src="images/vanangamudimnist/output_36_17.png"><pre class="literal-block">
correct: 10/10, loss:0.000816631130874157
epoch: 9000, loss:7.73639925319003e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_19.png" src="images/vanangamudimnist/output_36_19.png"><pre class="literal-block">
correct: 10/10, loss:0.0007728362688794732
epoch: 10000, loss:7.342388962570113e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_21.png" src="images/vanangamudimnist/output_36_21.png"><pre class="literal-block">
correct: 10/10, loss:0.000733515596948564
epoch: 11000, loss:6.987177541304847e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_23.png" src="images/vanangamudimnist/output_36_23.png"><pre class="literal-block">
correct: 10/10, loss:0.0006980619509704411
epoch: 12000, loss:6.66436344909016e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_25.png" src="images/vanangamudimnist/output_36_25.png"><pre class="literal-block">
correct: 10/10, loss:0.0006658405181951821
epoch: 13000, loss:6.370135299221147e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_27.png" src="images/vanangamudimnist/output_36_27.png"><pre class="literal-block">
correct: 10/10, loss:0.0006364684668369591
epoch: 14000, loss:6.1013935264782045e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_29.png" src="images/vanangamudimnist/output_36_29.png"><pre class="literal-block">
correct: 10/10, loss:0.0006096391589380801
epoch: 15000, loss:5.854485207237304e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_31.png" src="images/vanangamudimnist/output_36_31.png"><pre class="literal-block">
correct: 10/10, loss:0.0005849882145412266
epoch: 16000, loss:5.626929625577759e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_33.png" src="images/vanangamudimnist/output_36_33.png"><pre class="literal-block">
correct: 10/10, loss:0.0005622674943879247
epoch: 17000, loss:5.416594656708185e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_35.png" src="images/vanangamudimnist/output_36_35.png"><pre class="literal-block">
correct: 10/10, loss:0.0005412654136307538
epoch: 18000, loss:5.2213049784768376e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_37.png" src="images/vanangamudimnist/output_36_37.png"><pre class="literal-block">
correct: 10/10, loss:0.0005217638099566102
epoch: 19000, loss:5.039620846218896e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_39.png" src="images/vanangamudimnist/output_36_39.png"><pre class="literal-block">
correct: 10/10, loss:0.0005036209477111697
epoch: 20000, loss:4.869873519055546e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_41.png" src="images/vanangamudimnist/output_36_41.png"><pre class="literal-block">
correct: 10/10, loss:0.0004866681119892746
epoch: 21000, loss:4.7111265157582235e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_43.png" src="images/vanangamudimnist/output_36_43.png"><pre class="literal-block">
correct: 10/10, loss:0.00047081400407478213
epoch: 22000, loss:4.562667345453519e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_45.png" src="images/vanangamudimnist/output_36_45.png"><pre class="literal-block">
correct: 10/10, loss:0.00045598665019497275
epoch: 23000, loss:4.423383987159469e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_47.png" src="images/vanangamudimnist/output_36_47.png"><pre class="literal-block">
correct: 10/10, loss:0.0004420751647558063
epoch: 24000, loss:4.292191806598566e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_49.png" src="images/vanangamudimnist/output_36_49.png"><pre class="literal-block">
correct: 10/10, loss:0.0004289712815079838
epoch: 25000, loss:4.168330851825886e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_51.png" src="images/vanangamudimnist/output_36_51.png"><pre class="literal-block">
correct: 10/10, loss:0.00041659921407699585
epoch: 26000, loss:4.051415649882984e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_53.png" src="images/vanangamudimnist/output_36_53.png"><pre class="literal-block">
correct: 10/10, loss:0.00040492042899131775
epoch: 27000, loss:3.9410730714735106e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_55.png" src="images/vanangamudimnist/output_36_55.png"><pre class="literal-block">
correct: 10/10, loss:0.00039389816811308265
epoch: 28000, loss:3.836599891656078e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_57.png" src="images/vanangamudimnist/output_36_57.png"><pre class="literal-block">
correct: 10/10, loss:0.00038346173823811114
epoch: 29000, loss:3.7375376195996066e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_59.png" src="images/vanangamudimnist/output_36_59.png"><pre class="literal-block">
correct: 10/10, loss:0.0003735655336640775
epoch: 30000, loss:3.643752643256448e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_61.png" src="images/vanangamudimnist/output_36_61.png"><pre class="literal-block">
correct: 10/10, loss:0.00036419619573280215
epoch: 31000, loss:3.554246144631179e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_63.png" src="images/vanangamudimnist/output_36_63.png"><pre class="literal-block">
correct: 10/10, loss:0.00035525442217476666
epoch: 32000, loss:3.4688986270339234e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_65.png" src="images/vanangamudimnist/output_36_65.png"><pre class="literal-block">
correct: 10/10, loss:0.0003467276110313833
epoch: 33000, loss:3.38783597908332e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_67.png" src="images/vanangamudimnist/output_36_67.png"><pre class="literal-block">
correct: 10/10, loss:0.0003386292955838144
epoch: 34000, loss:3.3104618269135243e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_69.png" src="images/vanangamudimnist/output_36_69.png"><pre class="literal-block">
correct: 10/10, loss:0.00033089861972257495
epoch: 35000, loss:3.236417862353846e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_71.png" src="images/vanangamudimnist/output_36_71.png"><pre class="literal-block">
correct: 10/10, loss:0.0003235008043702692
epoch: 36000, loss:3.1655030616093424e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_73.png" src="images/vanangamudimnist/output_36_73.png"><pre class="literal-block">
correct: 10/10, loss:0.00031641527311876416
epoch: 37000, loss:3.097559627349256e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_75.png" src="images/vanangamudimnist/output_36_75.png"><pre class="literal-block">
correct: 10/10, loss:0.0003096264263149351
epoch: 38000, loss:3.0326169580803253e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_77.png" src="images/vanangamudimnist/output_36_77.png"><pre class="literal-block">
correct: 10/10, loss:0.00030313775641843677
epoch: 39000, loss:2.9704941298405175e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_79.png" src="images/vanangamudimnist/output_36_79.png"><pre class="literal-block">
correct: 10/10, loss:0.00029693052056245506
epoch: 40000, loss:2.9106522124493495e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_81.png" src="images/vanangamudimnist/output_36_81.png"><pre class="literal-block">
correct: 10/10, loss:0.0002909509348683059
epoch: 41000, loss:2.8533561817312146e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_83.png" src="images/vanangamudimnist/output_36_83.png"><pre class="literal-block">
correct: 10/10, loss:0.0002852260076906532
epoch: 42000, loss:2.797896486299578e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_85.png" src="images/vanangamudimnist/output_36_85.png"><pre class="literal-block">
correct: 10/10, loss:0.00027968379436060786
epoch: 43000, loss:2.744394249020843e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_87.png" src="images/vanangamudimnist/output_36_87.png"><pre class="literal-block">
correct: 10/10, loss:0.0002743378863669932
epoch: 44000, loss:2.6928670158667955e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_89.png" src="images/vanangamudimnist/output_36_89.png"><pre class="literal-block">
correct: 10/10, loss:0.0002691886038519442
epoch: 45000, loss:2.6431842416059228e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_91.png" src="images/vanangamudimnist/output_36_91.png"><pre class="literal-block">
correct: 10/10, loss:0.00026422421797178686
epoch: 46000, loss:2.595654157630634e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_93.png" src="images/vanangamudimnist/output_36_93.png"><pre class="literal-block">
correct: 10/10, loss:0.00025947438552975655
epoch: 47000, loss:2.5499546827632003e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_95.png" src="images/vanangamudimnist/output_36_95.png"><pre class="literal-block">
correct: 10/10, loss:0.0002549075579736382
epoch: 48000, loss:2.5057809216377793e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_97.png" src="images/vanangamudimnist/output_36_97.png"><pre class="literal-block">
correct: 10/10, loss:0.00025049326359294355
epoch: 49000, loss:2.4633905304654037e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_99.png" src="images/vanangamudimnist/output_36_99.png"><pre class="literal-block">
correct: 10/10, loss:0.0002462573756929487
epoch: 50000, loss:2.4225734814535825e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_101.png" src="images/vanangamudimnist/output_36_101.png"><pre class="literal-block">
correct: 10/10, loss:0.00024217806640081108
epoch: 51000, loss:2.3830521495256107e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_103.png" src="images/vanangamudimnist/output_36_103.png"><pre class="literal-block">
correct: 10/10, loss:0.0002382286766078323
epoch: 52000, loss:2.344911696127383e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_105.png" src="images/vanangamudimnist/output_36_105.png"><pre class="literal-block">
correct: 10/10, loss:0.0002344170061405748
epoch: 53000, loss:2.3082216066541153e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_107.png" src="images/vanangamudimnist/output_36_107.png"><pre class="literal-block">
correct: 10/10, loss:0.00023075027274899185
epoch: 54000, loss:2.272542646096554e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_109.png" src="images/vanangamudimnist/output_36_109.png"><pre class="literal-block">
correct: 10/10, loss:0.00022718461696058512
epoch: 55000, loss:2.237642715044785e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_111.png" src="images/vanangamudimnist/output_36_111.png"><pre class="literal-block">
correct: 10/10, loss:0.00022369690123014152
epoch: 56000, loss:2.2039403484086506e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_113.png" src="images/vanangamudimnist/output_36_113.png"><pre class="literal-block">
correct: 10/10, loss:0.000220328540308401
epoch: 57000, loss:2.171287556848256e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_115.png" src="images/vanangamudimnist/output_36_115.png"><pre class="literal-block">
correct: 10/10, loss:0.00021706517145503312
epoch: 58000, loss:2.139623753464548e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_117.png" src="images/vanangamudimnist/output_36_117.png"><pre class="literal-block">
correct: 10/10, loss:0.0002139005810022354
epoch: 59000, loss:2.108841326844413e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_119.png" src="images/vanangamudimnist/output_36_119.png"><pre class="literal-block">
correct: 10/10, loss:0.00021082404418848455
epoch: 60000, loss:2.0792475115740673e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_121.png" src="images/vanangamudimnist/output_36_121.png"><pre class="literal-block">
correct: 10/10, loss:0.0002078662655549124
epoch: 61000, loss:2.0501944491115864e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_123.png" src="images/vanangamudimnist/output_36_123.png"><pre class="literal-block">
correct: 10/10, loss:0.00020496267825365067
epoch: 62000, loss:2.0219945909047967e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_125.png" src="images/vanangamudimnist/output_36_125.png"><pre class="literal-block">
correct: 10/10, loss:0.0002021441760007292
epoch: 63000, loss:1.9942749677284153e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_127.png" src="images/vanangamudimnist/output_36_127.png"><pre class="literal-block">
correct: 10/10, loss:0.0001993737678276375
epoch: 64000, loss:1.9675384701258736e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_129.png" src="images/vanangamudimnist/output_36_129.png"><pre class="literal-block">
correct: 10/10, loss:0.00019670158508233726
epoch: 65000, loss:1.9416159211687046e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_131.png" src="images/vanangamudimnist/output_36_131.png"><pre class="literal-block">
correct: 10/10, loss:0.0001941107475431636
epoch: 66000, loss:1.9162728531227913e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_133.png" src="images/vanangamudimnist/output_36_133.png"><pre class="literal-block">
correct: 10/10, loss:0.00019157768110744655
epoch: 67000, loss:1.8914568463515025e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_135.png" src="images/vanangamudimnist/output_36_135.png"><pre class="literal-block">
correct: 10/10, loss:0.00018909727805294096
epoch: 68000, loss:1.8671469733817505e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_137.png" src="images/vanangamudimnist/output_36_137.png"><pre class="literal-block">
correct: 10/10, loss:0.00018666766118258238
epoch: 69000, loss:1.8432843062328176e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_139.png" src="images/vanangamudimnist/output_36_139.png"><pre class="literal-block">
correct: 10/10, loss:0.00018428244220558554
epoch: 70000, loss:1.8202659266535192e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_141.png" src="images/vanangamudimnist/output_36_141.png"><pre class="literal-block">
correct: 10/10, loss:0.00018198174075223505
epoch: 71000, loss:1.7980593765969386e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_143.png" src="images/vanangamudimnist/output_36_143.png"><pre class="literal-block">
correct: 10/10, loss:0.00017976219533011317
epoch: 72000, loss:1.776098020854988e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_145.png" src="images/vanangamudimnist/output_36_145.png"><pre class="literal-block">
correct: 10/10, loss:0.00017756715533323586
epoch: 73000, loss:1.7548067298776003e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_147.png" src="images/vanangamudimnist/output_36_147.png"><pre class="literal-block">
correct: 10/10, loss:0.00017543925787322223
epoch: 74000, loss:1.7340696340397697e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_149.png" src="images/vanangamudimnist/output_36_149.png"><pre class="literal-block">
correct: 10/10, loss:0.00017336638120468706
epoch: 75000, loss:1.7136688547907397e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_151.png" src="images/vanangamudimnist/output_36_151.png"><pre class="literal-block">
correct: 10/10, loss:0.00017132725042756647
epoch: 76000, loss:1.6937134751060513e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_153.png" src="images/vanangamudimnist/output_36_153.png"><pre class="literal-block">
correct: 10/10, loss:0.00016933264851104468
epoch: 77000, loss:1.674388626270229e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_155.png" src="images/vanangamudimnist/output_36_155.png"><pre class="literal-block">
correct: 10/10, loss:0.00016740091086830944
epoch: 78000, loss:1.6554753019590862e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_157.png" src="images/vanangamudimnist/output_36_157.png"><pre class="literal-block">
correct: 10/10, loss:0.00016551054432056844
epoch: 79000, loss:1.637008828765829e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_159.png" src="images/vanangamudimnist/output_36_159.png"><pre class="literal-block">
correct: 10/10, loss:0.0001636647357372567
epoch: 80000, loss:1.6191334980248941e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_161.png" src="images/vanangamudimnist/output_36_161.png"><pre class="literal-block">
correct: 10/10, loss:0.00016187792061828077
epoch: 81000, loss:1.6014868397178361e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_163.png" src="images/vanangamudimnist/output_36_163.png"><pre class="literal-block">
correct: 10/10, loss:0.00016011403931770474
epoch: 82000, loss:1.584194154929719e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_165.png" src="images/vanangamudimnist/output_36_165.png"><pre class="literal-block">
correct: 10/10, loss:0.00015838549006730318
epoch: 83000, loss:1.5670943212171552e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_167.png" src="images/vanangamudimnist/output_36_167.png"><pre class="literal-block">
correct: 10/10, loss:0.00015667623665649444
epoch: 84000, loss:1.5502425030717862e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_169.png" src="images/vanangamudimnist/output_36_169.png"><pre class="literal-block">
correct: 10/10, loss:0.0001549917069496587
epoch: 85000, loss:1.5339244127972053e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_171.png" src="images/vanangamudimnist/output_36_171.png"><pre class="literal-block">
correct: 10/10, loss:0.00015336077194660902
epoch: 86000, loss:1.5179560068645515e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_173.png" src="images/vanangamudimnist/output_36_173.png"><pre class="literal-block">
correct: 10/10, loss:0.0001517643395345658
epoch: 87000, loss:1.5023343512439169e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_175.png" src="images/vanangamudimnist/output_36_175.png"><pre class="literal-block">
correct: 10/10, loss:0.00015020293358247727
epoch: 88000, loss:1.4870688719383907e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_177.png" src="images/vanangamudimnist/output_36_177.png"><pre class="literal-block">
correct: 10/10, loss:0.00014867704885546118
epoch: 89000, loss:1.4721054612891748e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_179.png" src="images/vanangamudimnist/output_36_179.png"><pre class="literal-block">
correct: 10/10, loss:0.00014718130114488304
epoch: 90000, loss:1.4575626482837834e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_181.png" src="images/vanangamudimnist/output_36_181.png"><pre class="literal-block">
correct: 10/10, loss:0.00014572765212506056
epoch: 91000, loss:1.44314118733746e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_183.png" src="images/vanangamudimnist/output_36_183.png"><pre class="literal-block">
correct: 10/10, loss:0.00014428579015657306
epoch: 92000, loss:1.4288767615653342e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_185.png" src="images/vanangamudimnist/output_36_185.png"><pre class="literal-block">
correct: 10/10, loss:0.00014286009536590427
epoch: 93000, loss:1.4148931950330734e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_187.png" src="images/vanangamudimnist/output_36_187.png"><pre class="literal-block">
correct: 10/10, loss:0.0001414622092852369
epoch: 94000, loss:1.4011994953762042e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_189.png" src="images/vanangamudimnist/output_36_189.png"><pre class="literal-block">
correct: 10/10, loss:0.00014009341248311102
epoch: 95000, loss:1.3878234531148337e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_191.png" src="images/vanangamudimnist/output_36_191.png"><pre class="literal-block">
correct: 10/10, loss:0.00013875641161575913
epoch: 96000, loss:1.3746419735980453e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_193.png" src="images/vanangamudimnist/output_36_193.png"><pre class="literal-block">
correct: 10/10, loss:0.0001374386774841696
epoch: 97000, loss:1.361803597319522e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_195.png" src="images/vanangamudimnist/output_36_195.png"><pre class="literal-block">
correct: 10/10, loss:0.00013615534408017993
epoch: 98000, loss:1.3493407550413395e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_197.png" src="images/vanangamudimnist/output_36_197.png"><pre class="literal-block">
correct: 10/10, loss:0.00013490939454641193
epoch: 99000, loss:1.337103256446426e-06
</pre>
<img alt="/images/vanangamudimnist/output_36_199.png" src="images/vanangamudimnist/output_36_199.png"><pre class="literal-block">
correct: 10/10, loss:0.0001336860441369936
</pre>
<pre class="code python3"><a name="rest_code_2dd581c57e3c4055b9cc9bd06453180f-1"></a><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s1">'model_150000.pth'</span><span class="p">)</span>
</pre>
<pre class="code python3"><a name="rest_code_4802ea4c21934d0baac7f01b37c733b5-1"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<img alt="/images/vanangamudimnist/output_38_0.png" src="images/vanangamudimnist/output_38_0.png"><pre class="code python3"><a name="rest_code_41c86ab10ccb48d7b33af2934b40fde1-1"></a><span class="n">normalized_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a name="rest_code_41c86ab10ccb48d7b33af2934b40fde1-2"></a><span class="n">normalized_model</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">normalized_model</span><span class="p">)</span>
<a name="rest_code_41c86ab10ccb48d7b33af2934b40fde1-3"></a><span class="n">total</span>  <span class="o">=</span>  <span class="n">normalized_model</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_41c86ab10ccb48d7b33af2934b40fde1-4"></a><span class="n">normalized_model</span> <span class="o">=</span> <span class="n">normalized_model</span><span class="o">/</span><span class="n">total</span>
<a name="rest_code_41c86ab10ccb48d7b33af2934b40fde1-5"></a>
<a name="rest_code_41c86ab10ccb48d7b33af2934b40fde1-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">normalized_model</span><span class="p">)</span>
</pre>
<pre class="literal-block">
&lt;matplotlib.image.AxesImage at 0x7f12dd850b38&gt;
</pre>
<img alt="/images/vanangamudimnist/output_39_1.png" src="images/vanangamudimnist/output_39_1.png">
</div>
</div>
</div>
    </div>
    </article>
</div>



        
<div id="fb-root"></div>
<script>
    // thank lxml for this
    $('.fb-comments-count').each(function(i, obj) {
        var url = obj.attributes['data-url'].value;
        // change here if you dislike the default way of displaying
        // this
        obj.innerHTML = '<fb:comments-count href="' + url + '"></fb:comments-count> comments';
    });

  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : 'selvakumar.v2.x',
      status     : true,
      xfbml      : true
    });

  };

  // Load the SDK asynchronously
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents  2017         <a href="mailto:selva.developer@gmail.com">vanangamudi</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="assets/js/jquery.min.js"></script><script src="assets/js/bootstrap.min.js"></script><script src="assets/js/moment-with-locales.min.js"></script><script src="assets/js/fancydates.js"></script><script src="assets/js/jquery.colorbox-min.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
