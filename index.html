<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# fb: http://ogp.me/ns/fb# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="interpretations of my observations">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>vanangamudi</title>
<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://vanangamudi.github.io/">
<meta property="fb:app_id" content="selvakumar.v2.x">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/language-understanding-and-deep-learning/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://vanangamudi.github.io/">

                <span id="blog-title">vanangamudi</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>
                </li>
<li>
<a href="stories/aboutme">About me</a>
                </li>
<li>
<a href="https://twitter.com/paarulakan">Twitter</a>
                </li>
<li>
<a href="https://github.com/vanangamudi">Github</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/language-understanding-and-deep-learning/" class="u-url">Language Understanding and Deep learning</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/language-understanding-and-deep-learning/" rel="bookmark"><time class="published dt-published" datetime="2018-04-02T22:40:30+05:30" title="2018-04-02 22:40">2018-04-02 22:40</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/language-understanding-and-deep-learning/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <!--
.. title: Language Understanding and Deep learning
.. slug: language-understanding-and-deep-learning
.. date: 2018-04-02 22:40:30 UTC+05:30
.. tags: deep learning, nlp, language understanding, nlu, questions
.. category: NLU
.. link: 
.. description: 
.. type: text
  -->
  
    <div>[WIP]  Created Monday 02 April 2018 </div>
    <div><br></div>
    <div>
      <p></p>
      <h4>
        <b>Problems with word-embedding :-</b> </h4>
      <p>
        Word embeddings are flat and do not capture hierarchies. number space vs
        word space, for example, the similarity between '8' and 'eight' should
        be captured. Intrinstic and extrinsic properties of words are still
        cannot be captured by word-embeddings alone. Sure we can use character
        embedding and mix/concat them with word-embeddings, but that doesn't
        seem to improve the performance by far. </p>
      <p>
        Meaning of a word is influenced by a lot of factors which can be
        categorised into at least three. <br>
        Syntax - character order, <br>
        Semantics - what are the words that are seen together, <br>
        Pragmatics - we don't know how to handle this so far, because it depends
        upon lot of things like history, culture, contemporary styles of use and
        so on.
      </p>
      <p></p>
      <h4>
        <b>Too deterministic - all the output are probability distributions.</b>
</h4>
      <p>
        The neural network, all it does it mapping between two
        higher-dimensional spaces deterministically. To explain what I mean, I
        will use the OpAmp vs Microcontroller analogy. In an OpAmp circuitry, the output is
        completly based on the input and the relationship causal. Very similar
        to mechanical devices, it just the medium is different, electrons in
        circuitry. There is no arbitraryness . But I can, make a microcontroller
        to light up an LED regardless of what is on the input side. </p>
      <p>
        I intentionally chose not use the phrase, 'program the microcontroller'.
        Programs is set of rules operating over data structured in, well... a
        structure. No shortcuts. But that is also a curse. Take NLP for example,
        we cannot completely specify language in a set of rules. Although
        link-grammar, dependency-grammar, and recent construction-grammars have
        evolved to more powerful and expressive, NLP is still an unsolved
        problem. </p>
      <p>
        Neural networks tend to perform well on a subset of language
        defined-by/confined-to a text-corpus, because it tries to figure out the
        rules by themselves. But that is not an easy job. It is like watching a
        suspense-thriller. The story is intentionally crafted to make us
        infer/predict something to be true, say the movie, Mulholland Drive is
        about, Diane Selwyn is trying to help Camilla Rhodes figure who was she
        before the car accident, only to break that prediction, like revealing
        that all the damn is a dream, and make us feel like cheated and
        astonished at the same time, so that we are kept invested in the story.
        The movie is actually more complex and there can be more than one
        interpretation other than the one I chose to present here, exactly like
        there are many ways to interpret a sentence. </p>
      <p>
        It is safe to say the that kind of reactions are the after-effects of
        the order in which the events in the story are presented to us. That is
        exactly the reason why beural networks perform well on one dataset and
        not on another and at times not even on the same dataset if the order of
        the samples are shuffled. The reason why our prediction of the hero or
        the anti-hero fails miserably is, we are trying to capture meaningful
        structures of the story from and confined to the events presented, i.e
        from the incomplete information. </p>
      <p>
        We are connecting dots which may or may not be actually connected in the
        story, and we won't know it until we are provided with the full
        information. Similarly the neural networks creates shortcuts and
        believes that is the actual structure of the content in NLP case the
        syntax, semantics and even pragmatics of the language. And believe the
        datasets we currently have cannot capture all of three of them, in their
        entirety. So what the neural networks ends up learning are mere
        shortcuts, unless we provide them all sorts of combinations of meaning
        sentences. </p>
      <p>
        For example to establish the similarity between word 'eight' and number
        '8' we need to provide the neural network enough examples where 'eight'
        and '8' exemplify similar meanings. In context of word-embeddings,
        duplicating samples with 'eight' replaced with '8' and vice-versa should
        capture that similarity, but how to make the neural network understand
        that '1' and '8' are from number spaces and 'one' and 'eight' are from
        word spaces? I don't know the answer to that. (May be multimodal
        learning might help?) </p>
    </div>
  
    </div>
    </article><article class="h-entry post-text--&gt;"><header><h1 class="p-name entry-title"><a href="posts/replace-algorithms-with-nn/" class="u-url">Replace algorithms with NN</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/replace-algorithms-with-nn/" rel="bookmark"><time class="published dt-published" datetime="2017-12-12T01:02:52+05:30" title="2017-12-12 01:02">2017-12-12 01:02</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/replace-algorithms-with-nn/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <!-- 
.. title: Replace algorithms with NN
.. slug: replace-algorithms-with-nn
.. date: 2017-12-12 01:02:52 UTC+05:30
.. tags: mathematics, basics
.. category: mathematics
.. link:
.. description:
.. type: text-->
  
    <div>
      <h1>Replace algorithms with NN </h1>
      <div>This idea of replacing software components with neural networks comes
        to us, or atleast me quite a few times. I remember now the very first
        time I thought about this. At that time, I did not know anything about
        neural networks other than that they are a part of Aritifcial
        Intelligece. I and my friend Suriya were experimenting with lots of
        stuff that we can get our hands on. Arduino, OpenCV, Matlab, Linux,
        device drivers, etc. Yes it was five years ago when we came up with the
        <a href="https://groups.google.com/forum/#%21forum/project-adhi" target="_blank">project</a>
        "Adhi"(means beggining). It was about intergraing AI, NN specifically
        into linux kernel to make it kernel smarter. </div>
      <div><br></div>
      <div>There is another one,where I imagined a symbolic AI and nerual
        network will compete to become better than each other. This came to me,
        when thinking of how to adjust what a network learns. Symbolic AI are
        easier to tweak. </div>
      <div><br></div>
      <div>Like this one, most of the ideas presented below are old and may be
        useless, and I admit, these are all just vague phrases and I never made
        an attempt to implement them. But I hope this time I will get my hands
        dirty and this  would at least serve as a reference.
        <div></div>
        <h4>Why am I writing about this now?</h4>
        <div>One. I have been planning to write a software to help with
          tamil-linguitics. There is a lot to discuss in it, But I will limit
          myself to one particular area - WordNet. Two. few months ago I wrote
          about how computers can be more useful that being just a data storing
          searching devices. In that post I tried to explain how we are
          underutilising out computers. I always try to organize the directories
          I have on my computers to aid the way I work. And there are some more
          idea, and a combination of those things led me to write this.</div>
      </div>
      <div>
        <div><br></div>
      </div>
      <div>In this post, lets discuss a specific algorithm - indexing. Why? No
        reason. It is way more easier to explain, I guess.</div>
      <div>
        <h3>What is an index?</h3>
      </div>
      <div>Let's say you own stationery store, which sells, papers, notebooks
        and pens. They way you place those items your shop is essential for
        business. Pens are almost always placed at the front. Notebooks are
        placed in wooden or iron racks and are organized interms of their
        attributes - ruled/unruled, long/short, number of pages,
        hard-bound/paperback and etc., and other items which are not frequently
        sold will be kept somewhere in the back. Basically, we keep the
        frequently sold items closer and the others farther. We can think of
        this, as an indexing problem can't we?. The next time we buy notebooks
        to sell, we place them accordingly.</div>
      <div>
        <h4>Indexing and related data-structures:</h4>
      </div>
      <div>Binary-tree can be thought of as decision tree, but it is not as
        sophisticated a decision tree.We, humans out of our lessons came up with
        B-tree. TODO</div>
    </div>
    <div><br></div>
    <div>We can think of programming in general as way to give structure to
      information/data.That is what we do right? We take in bunch of data and do
      something with it. Before doing with it we need a idea of what it is.</div>
    <div>
      <h4><strong>A remotely relevant example: Games</strong></h4>
    </div>
    <div>Let's take games. Games are one of the crucial softwares. They are
      complex and compuationally intensive and some time they look incredibly
      real. The more real they look, the more computations it has to perform.
      The real world has structure. A computer sits on a table. The table mostly
      stays inside the building. Our hands holds items. Bikes and cards rides on
      the roads. There are numeraous relationships between objects in the real
      world. And there is always more in the real world that what meets the eye.
      But we cannot afford to make the computer build an entire world inside.
      The real world is too rich in complexity to be fit in 32Gb RAM, and the
      physicsal laws are too intense to calculated with a quad core processor. </div>
    <div><br></div>
    <div>So what do we do? We cull off the things that don't meet the eyes and
      display only what is necessary on the screen. How do we do it? Similar to
      real world we simulate a small scale world inside the computer with help
      of 'relationships between items'. Scene graph it is called. It is the data
      structure that contains the objects and their relationships, including the
      player from whose POV we see the world inside the game. So that the
      computer can evaluate what object falls under our view, and only act upon
      them, i.e apply physics over the objects in the view so that we feel
      immersed in the game. To make it more closer to real world. The people who
      create games optimize the game and its engines to run as fast as it can in
      as many hardware platform as possible. </div>
    <div><br></div>
    <div>Different kinds of games build different kind of worlds. GTA Vicecity
      was one of the first open world games I played.But mostgames are of closed
      world nature. i.e you cannot move around freely.There are only a set of
      paths you can go and only a set of things you can do. This in a way
      reduces the complexity in the computation. </div>
    <div><br></div>
    <div>Have you ever wondered why some games are fast even at high graphical
      quality settings and some games suck even atlow quality settings. That
      depends upon whatoptimization havebeen done and whohasdone it.Naturally a
      game programmer with good experience can optimize their games better than
      one with lesser experience.</div>
    <div>
      <h4>A extrememly remotely relevant example: Software</h4>
      <div>The sotware we use,  Microsoft word or Libre office Writer, are
        general purpose software. Almost every one will have some use for it.
        There is a set of usual things we do with a computer. Write docs, paint
        pictures, watch videos and such. But there are also specialised
        softwares designed for specific purpose. For example banks use custom
        designed software. The functionality of software is tailored its
        industry. You need measurements to tailor stuff.</div>
      <div>
        <h4>A relevant example: Out stationery store</h4>
      </div>
      <div>The way you store items in you shop will differ from other shop, even
        if it was a stationery store right next to yours or right opposite. Why
        it dependsupon so many factors. The kind of items you sell, the number
        of items in each kind, the amount of space you have etc. i,e how you
        store, depends heavily on what you have. Index is a function of data.</div>
    </div>
    <div><br></div>
    <div>Let's think about, database coders specifically people who code the
      indexers. They cannot make any predictions about what kind data would be
      stored in the databases other than few bare essentials like integers and
      string. They cannot know what kind of data that I am going to store. It is
      this disconnect which penalises performance.</div>
    <div>
      <h4>Coming back to WordNet</h4>
    </div>
    <div>
      <div>Wordnet is like a thesaurus but richer in information. Building a
        wordnet is no simple task. It is not exaggerating, when I say it might
        take one's lifetime to build one. How can we make use of computer in
        this endevour? This is a crude example and by no means intended to be
        comprehesive implementaion note.</div>
      <div><br></div>
      <div>Let's say you have software, you lookup a word and it shows some
        information regarding that word. Its meanings, etymology, different of
        forms of use in sentences, etc. What if it can suggest a list of words
        and you can edit the relationship between them, i.e if the suggested
        list of words are closer to this word in some sense? Wouldn't it be
        awesome?</div>
      <div><br></div>
      <div>But how can we pick a list of words from million words closer to the
        one that we are reading? Well what if we can store the words in database
        based on their similarity and relationships with other words? i.e store
        the words closer in meaning, closer in memory.You mayask how can we know
        what words are similar and what are not? </div>
      <div><br></div>
      <div>That is where machine learning comes in. There are machine learning
        methods, word embedding for example can be used to come with a
        similarity metric. And manual contributions via this linguistic software
        inturn can be used to make it more accurate. Remember the meaning of the
        words are always changing, and there is not absolute meaning and
        relationship between a word and the meaning it represents. So this
        process will always be incremental and iterative. </div>
      <div><br></div>
      <div>The point is, neural networks and other machine learning methods can
        be use to determine where and how to store words.Unlike a general
        purpose database, the neural network will learn what is in the data so
        that it can store the data more efficiently and effectively.</div>
      <div><br></div>
      <div>I imagine a bunch of AI agents talking to each other can do a better
        job at this than a handful of coders.</div>
    </div>
  
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/neural-networks-basics/" class="u-url">Neural Networks Basics</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/neural-networks-basics/" rel="bookmark"><time class="published dt-published" datetime="2017-05-22T22:44:46+05:30" title="2017-05-22 22:44">2017-05-22 22:44</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/neural-networks-basics/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>WORK IN PROGRESS</p>
<div class="section" id="what-is-neural-network">
<h2>What is neural network?</h2>
<p>Neural network was designed long long ago as a tool to explain how brain works in terms of computation. The infamous Pitts and McCulloch model was the first of this kind.</p>
<p>Roughly basic model of an artificial neuron is that, it connects to other neurons and collects inputs from all of them and once it think it has collected enough, it lights up, traditionally called firing of a neuron. The neural network that we are gonna discuss is similar to that but mathematical.</p>
<p>You remember that the computers were not made of transistor based CPU's till mid 20th century. Before that we used thermionic valves, and even before that we used electrical and mechanical parts like rotating shaft for doing computation, which is the principal thing to do in computers - computation.</p>
<p>Neural networks have a long history and they have been implemented in various forms throughout it. They were implemented in calculators, and later in 1950s and in parallel distributed computers in 1980's and most recently in GPUs. We are the luckiest, we live in an era, where you can build neural networks in our laptops at home and make them do some impressive stuff.</p>
</div>
<div class="section" id="how-exactly-gpu-s-help-build-the-neural-networks">
<h2>How exactly GPU's help build the neural networks</h2>
<p>To understand that, we need to look into the details of how a simple neural network works. Lets take one.</p>
<object data="images/neural-networks-basics/2x1.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x1.svg</object>
<p>From the look of it, we can understand that this network can be used to evaluate the equation of form <strong>ax + by</strong> where a,b and x,y can take any values. Why are we calculating a math expression when neural networks can do much more awesome stuff? Take baby steps. From that expression we can understand that a neuron always adds up what it receives and the connecting link multipies the input. In the following example, the link connect to x,y,z and the link p,q,r produce px, qy, rz and the neuron eats it all up and spit px + qy + rz.</p>
<object data="images/neural-networks-basics/3x1.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/3x1.svg</object>
<p>That is all fine. But how do we build the network in our computers? We go in reverse. We know that the result of evaluating that expression and output of the neuron are same. It is safe to say that the expression is the mathematical model of the neuron. We have been told again and again that our numbers are good at crunching numbers, right? What does it actually mean? Now you get it. Anyway that is a toy example.</p>
<p>In real world applications, the neural networks are employed for things which computers are not very good.</p>
<p>We mentioned something called firing in our very first section. What is firing? That depends on our interpretation. Lets take another example.</p>
<object data="images/neural-networks-basics/2x2_01.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_01.svg</object>
<p>In our last example there was only one neuron, but here there are two. How can function produce two different output? That is absurd. No wait. In the last example, the output of the network is the output of the last neuron. But here the output is little different. We consider, which neuron produces the larger value and take is position as the output. MNIST for example has ten output neurons, each to signify a which is the number in the picture. Lets rewrite the names in the picture for a better workflow.</p>
<object data="images/neural-networks-basics/2x2_02.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_02.svg</object>
<p>I left out one more important thing. There is something called bias. Alright lets take a moment to try out a real example. Behold the AND gate.</p>
<object data="images/neural-networks-basics/2x2_02_with_bias.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_02_with_bias.svg</object>
<object data="images/neural-networks-basics/2x2_02_with_bias_AND_gate.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_02_with_bias_AND_gate.svg</object>
<div class="section" id="and-gate-truth-table">
<h3>AND gate truth table</h3>
<table border="1" class="docutils">
<colgroup>
<col width="12%">
<col width="12%">
<col width="23%">
<col width="23%">
<col width="31%">
</colgroup>
<tbody valign="top">
<tr>
<td>x</td>
<td>y</td>
<td>0</td>
<td>1</td>
<td>winner</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>-2.7</td>
<td>2.8</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>2.6</td>
<td>-3.3</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>3.4</td>
<td>-2.5</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>8.8</td>
<td>-8.7</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>You can see from the table that except for 1,1 the output of the neuron 1 is lesser than that of neuron 0. So now we understand that, the firing of neuron mostly mean means produing a larger value. Remember we are talking in terms of numbers crunched inside computers. If we had built, neural network with electrical components and use light bulbs as output devices - which bulb glows brighter would have been the winner.</p>
</div>
</div>
<div class="section" id="linear-algebra">
<h2>Linear Algebra</h2>
<p>if we carefully look at the last image of AND network, we can see that the expression can be written in matrix form. Lets take a closer look and rewrite the names once again to a decent form,  we have only 26 letters in english.</p>
<object data="images/neural-networks-basics/2x2_02.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_02.svg</object>
<object data="images/neural-networks-basics/2x2_02_with_bias.svg" style="width: 320pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_02_with_bias.svg</object>
<p>Just one more time. <strong>W</strong> ij means it connects the j-th neuron from input side to i-th neuron on the output side.</p>
<object data="images/neural-networks-basics/2x2_03.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_03.svg</object>
<object data="images/neural-networks-basics/2x2_03_with_bias.svg" style="width: 360pt;" type="image/svg+xml">
/images/neural-networks-basics/2x2_03_with_bias.svg</object>
<p>So if we rewrite the output equation into a matrix form, this is what we get</p>
<img alt="/images/neural-networks-basics/2x2_03_equation.png" src="images/neural-networks-basics/2x2_03_equation.png" style="width: 240pt;"><p>with bias</p>
<img alt="/images/neural-networks-basics/2x2_03_equation_with_bias.png" src="images/neural-networks-basics/2x2_03_equation_with_bias.png" style="width: 240pt;"><p>This is where linear algebra comes in. We have implemented many linear algebra operations, like matrix multiplication to run on computers, and using those set of functions, we can emulate neural networks in our desktops and laptops. These libraries such as BLAS, ATLAS are as old as I am. What has changed in the last decade is that, these libraries are rewritten to  be ran on GPU's. cuBLAS and clBLAS are few examples. What is so special about GPU? GPU can do a simple operation on large amount of data at a time and CPU are good at doing complex sequential operation over small pieces of data. Neural networks like other machine learning stuff&lt;better word&gt;, need to process large amount of data.</p>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/mnist%20study%20in%20pytorch/" class="u-url">MNIST study</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/mnist%20study%20in%20pytorch/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/mnist%20study%20in%20pytorch/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>this is a work in progress</p>
<pre class="code python3"><a name="rest_code_79263e83e21945268f0b552e6581631e-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<a name="rest_code_79263e83e21945268f0b552e6581631e-2"></a><span class="kn">import</span> <span class="nn">argparse</span>
<a name="rest_code_79263e83e21945268f0b552e6581631e-3"></a><span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_79263e83e21945268f0b552e6581631e-4"></a><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<a name="rest_code_79263e83e21945268f0b552e6581631e-5"></a><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<a name="rest_code_79263e83e21945268f0b552e6581631e-6"></a><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<a name="rest_code_79263e83e21945268f0b552e6581631e-7"></a><span class="kn">from</span> <span class="nn">torchvision</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
<a name="rest_code_79263e83e21945268f0b552e6581631e-8"></a><span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="k">import</span> <span class="n">Variable</span>
</pre>
<pre class="code python3"><a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-1"></a><span class="k">class</span> <span class="nc">Args</span><span class="p">:</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-2"></a>    <span class="k">pass</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-3"></a>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-4"></a><span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">()</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-5"></a><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">12</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-6"></a><span class="n">args</span><span class="o">.</span><span class="n">cuda</span> <span class="o">=</span> <span class="kc">True</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-7"></a><span class="n">args</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.001</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-8"></a><span class="n">args</span><span class="o">.</span><span class="n">momentum</span> <span class="o">=</span> <span class="mf">0.01</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-9"></a><span class="n">args</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>
<a name="rest_code_d1bc83f0ff3e429a94881afc4100254a-10"></a><span class="n">args</span><span class="o">.</span><span class="n">log_interval</span> <span class="o">=</span> <span class="mi">10</span>
</pre>
<pre class="code python3"><a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-1"></a><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'num_workers'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'pin_memory'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span> <span class="k">else</span> <span class="p">{}</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-2"></a><span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-3"></a>    <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-4"></a>                   <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-5"></a>                       <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-6"></a>                       <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-7"></a>                   <span class="p">])),</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-8"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-9"></a>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-10"></a><span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-11"></a>    <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-12"></a>                    <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-13"></a>                        <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-14"></a>                        <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-15"></a>                    <span class="p">])),</span>
<a name="rest_code_b9f87e077ebe4ac8865875c6cc15ba0d-16"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre>
<p>Lets take a look into how the dataset looks like</p>
<pre class="code python3"><a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-1"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-2"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-3"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-4"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-5"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-6"></a>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-7"></a><span class="n">num_of_samples</span> <span class="o">=</span> <span class="mi">5</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-8"></a>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-9"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">))</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-10"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-11"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">num_of_samples</span><span class="p">,</span> <span class="n">num_of_samples</span><span class="p">),</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-12"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-13"></a>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-14"></a><span class="n">output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_of_samples</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-15"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-16"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#dirty trick to take just one sample</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-17"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_of_samples</span> <span class="o">**</span> <span class="mi">2</span><span class="p">):</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-18"></a>            <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-19"></a>            <span class="n">output</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-20"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-21"></a>        <span class="k">break</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-22"></a>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-23"></a>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-24"></a><span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_of_samples</span><span class="p">,</span> <span class="n">num_of_sample</span><span class="p">)</span>
<a name="rest_code_60bb6fb8de194f30bee95ac3cbb6b302-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
[[ 6.  9.  9.  5.  4.]
 [ 3.  6.  5.  0.  1.]
 [ 8.  1.  3.  6.  2.]
 [ 9.  4.  8.  8.  6.]
 [ 0.  6.  4.  2.  3.]]
</pre>
<img alt="/images/mnist_study_in_pytorch/output_12_0.png" src="images/mnist_study_in_pytorch/output_12_0.png"><p>You can see that the image of number &lt;&gt; is associated with number &lt;&gt;. It is a list of (image of number, number). As usual we are gonna feed the neural network with image from the left and its label from the right. We will train a set of feedforward networks in increasing order of complexity. What I mean by complexity is the number of neurons and number of layers.</p>
<pre class="code python3"><a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-1"></a><span class="k">class</span> <span class="nc">Model0</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-2"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-3"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model0</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-5"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-6"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-7"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-8"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-9"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-10"></a><span class="k">class</span> <span class="nc">Model1</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-11"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-12"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-15"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-16"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-17"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-18"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-19"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-20"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-21"></a><span class="k">class</span> <span class="nc">Model2</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-22"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-23"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-26"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-27"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-28"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-29"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-30"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-31"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-32"></a><span class="k">class</span> <span class="nc">Model3</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-33"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-34"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model3</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-37"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-38"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-39"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-40"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-41"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-42"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-43"></a><span class="k">class</span> <span class="nc">Model4</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-44"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-45"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model4</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-47"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-48"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-49"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-50"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-51"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-52"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-53"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-54"></a><span class="k">class</span> <span class="nc">Model5</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-55"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-56"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model5</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-59"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-60"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-61"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-62"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-63"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-64"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-65"></a><span class="k">class</span> <span class="nc">Model6</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-66"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-67"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model6</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-69"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-70"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-71"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-72"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-73"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-74"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-75"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-76"></a><span class="k">class</span> <span class="nc">Model7</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-77"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-78"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model7</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-79"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-80"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-81"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-82"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-83"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-84"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-85"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-86"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-87"></a><span class="k">class</span> <span class="nc">Model8</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-88"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-89"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model8</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-91"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-92"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-93"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-94"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-95"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-96"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-97"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-98"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-99"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-100"></a><span class="k">class</span> <span class="nc">Model9</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-101"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-102"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model9</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-104"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-107"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-108"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-109"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-110"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-111"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-112"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-113"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-114"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-115"></a><span class="k">class</span> <span class="nc">Model10</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-116"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-117"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model10</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-118"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-123"></a>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-124"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-125"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-126"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-127"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-128"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-129"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_8c878eb1112447a9acdede4e44fe6a93-130"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre>
<p>Lets create the model instances. If you have GPU this is how you can make use of it, by calling .cuda() on models and tensors</p>
<pre class="code python3"><a name="rest_code_d162ed70df79476880bc9673a574106e-1"></a><span class="n">models</span> <span class="o">=</span> <span class="n">Model0</span><span class="p">(),</span> <span class="n">Model1</span><span class="p">(),</span> <span class="n">Model2</span><span class="p">(),</span> <span class="n">Model3</span><span class="p">(),</span> <span class="n">Model4</span><span class="p">(),</span> <span class="n">Model5</span><span class="p">(),</span> <span class="n">Model6</span><span class="p">(),</span> <span class="n">Model7</span><span class="p">(),</span> <span class="n">Model8</span><span class="p">(),</span> <span class="n">Model9</span><span class="p">(),</span> <span class="n">Model10</span><span class="p">()</span>
<a name="rest_code_d162ed70df79476880bc9673a574106e-2"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_d162ed70df79476880bc9673a574106e-3"></a>    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_d162ed70df79476880bc9673a574106e-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre>
<pre class="code python3"><a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-1"></a><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-2"></a>    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">momentum</span><span class="p">)</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-3"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-5"></a>        <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-6"></a>            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-7"></a>                <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-8"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-9"></a>            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-10"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-11"></a>            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-12"></a>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-13"></a>            <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-14"></a>            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-15"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-16"></a>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-17"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">print_every</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-18"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">'Train Epoch: </span><span class="si">{}</span><span class="s1"> [</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{:.0f}</span><span class="s1">%)]</span><span class="se">\t</span><span class="s1">Loss: </span><span class="si">{:.6f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-19"></a>                    <span class="n">i</span><span class="p">,</span> <span class="n">batch_idx</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span>
<a name="rest_code_dfe31927a20f4af18e3fdc63e6acaf41-20"></a>                    <span class="mf">100.</span> <span class="o">*</span> <span class="n">batch_idx</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">),</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre>
<p>This is where the actual training starts. It will take a while, so I just trained them for 100 times on entire training dataset.</p>
<pre class="code python3"><a name="rest_code_dc1cc8db28bb4903a189c88a8bcf1293-1"></a><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_dc1cc8db28bb4903a189c88a8bcf1293-2"></a>    <span class="n">train</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Train Epoch: 0 [59988/60000 (100%)]        Loss: 0.061506
.
.
.
.
Train Epoch: 98 [59988/60000 (100%)]       Loss: 0.018422
Train Epoch: 99 [59988/60000 (100%)]       Loss: 0.336890
</pre>
<p>Saving the model weights into a file, this should be in the above snippet or inside the training function for saving models every epoch.Lets just keep this simple</p>
<pre class="code python3"><a name="rest_code_2b4bd8fb13e2463aada5745797eb29d3-1"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
<a name="rest_code_2b4bd8fb13e2463aada5745797eb29d3-2"></a>    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s1">'mnist_mlp_multiple_model</span><span class="si">{}</span><span class="s1">.pth'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre>
<p>For the sake of completeness, this is how you load the saved models</p>
<pre class="code python3"><a name="rest_code_4f29e5d1d8394103b4092057907048dc-1"></a><span class="n">models</span> <span class="o">=</span> <span class="n">Model0</span><span class="p">(),</span> <span class="n">Model1</span><span class="p">(),</span> <span class="n">Model2</span><span class="p">(),</span> <span class="n">Model3</span><span class="p">(),</span> <span class="n">Model4</span><span class="p">(),</span> <span class="n">Model5</span><span class="p">(),</span> <span class="n">Model6</span><span class="p">(),</span> <span class="n">Model7</span><span class="p">(),</span> <span class="n">Model8</span><span class="p">(),</span> <span class="n">Model9</span><span class="p">(),</span> <span class="n">Model10</span><span class="p">()</span>
<a name="rest_code_4f29e5d1d8394103b4092057907048dc-2"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_4f29e5d1d8394103b4092057907048dc-3"></a>    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_4f29e5d1d8394103b4092057907048dc-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_4f29e5d1d8394103b4092057907048dc-5"></a>
<a name="rest_code_4f29e5d1d8394103b4092057907048dc-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
<a name="rest_code_4f29e5d1d8394103b4092057907048dc-7"></a>    <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'mnist_mlp_multiple_model</span><span class="si">{}</span><span class="s1">.pth'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</pre>
<p>Before we run the model over the test dataset, let take a peek into how one of the model performs</p>
<pre class="code python3"><a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-5"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-6"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-7"></a>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-8"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">))</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-9"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>  <span class="c1"># similar to subplot(111)</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-10"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="c1"># creates 2x2 grid of axes</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-11"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># pad between axes in inch.</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-12"></a>                 <span class="p">)</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-13"></a>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-14"></a><span class="n">output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-15"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-16"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#dirty trick</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-17"></a>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-18"></a>        <span class="n">data1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-19"></a>        <span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-20"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">9</span><span class="p">](</span><span class="n">Variable</span><span class="p">(</span><span class="n">data1</span><span class="p">))</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-21"></a>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-22"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-23"></a>            <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-24"></a>            <span class="n">output</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-25"></a>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-26"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-27"></a>        <span class="k">break</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-28"></a>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-29"></a><span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-30"></a><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<a name="rest_code_5299cb1b65c1437b95c8a6c917d66818-31"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
[[ 6.  2.  9.  1.  8.]
 [ 5.  6.  5.  7.  5.]
 [ 4.  8.  6.  3.  0.]
 [ 6.  1.  0.  9.  3.]
 [ 7.  2.  8.  4.  4.]]
</pre>
<img alt="/images/mnist_study_in_pytorch/output_12_0.png" src="images/mnist_study_in_pytorch/output_12_0.png"><p>As you can see, the results are not so bad.Lets test all our models.</p>
<pre class="code python3"><a name="rest_code_f48085030ab7448f9007e6286f7cab20-1"></a><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-2"></a>    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-3"></a>    <span class="n">test_loss</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-4"></a>    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-5"></a>    <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">test_loader</span><span class="p">:</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-6"></a>        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-7"></a>            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-8"></a>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-9"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-10"></a>        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">volatile</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-11"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-12"></a>        <span class="n">test_loss</span> <span class="o">+=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-13"></a>        <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># get the index of the max log-probability</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-14"></a>        <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-15"></a>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-16"></a>    <span class="n">test_loss</span> <span class="o">=</span> <span class="n">test_loss</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-17"></a>    <span class="n">test_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)</span> <span class="c1"># loss function already averages over batch size</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Test set: Average loss: </span><span class="si">{:.4f}</span><span class="s1">, Accuracy: </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{:.0f}</span><span class="s1">%)</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-19"></a>        <span class="n">test_loss</span><span class="p">,</span> <span class="n">correct</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-20"></a>        <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)))</span>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-21"></a>
<a name="rest_code_f48085030ab7448f9007e6286f7cab20-22"></a>    <span class="k">return</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="code python3"><a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-5"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-6"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-7"></a>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-8"></a>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-9"></a><span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-10"></a><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-11"></a>    <span class="n">accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_tuts</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-12"></a>
<a name="rest_code_6dbd45f45b7543c7ae370d94ccab4e26-13"></a><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Test set: Average loss: 0.2764, Accuracy: 9250/10000 (92%)
Test set: Average loss: 0.3591, Accuracy: 9010/10000 (90%)
Test set: Average loss: 0.3204, Accuracy: 9121/10000 (91%)
Test set: Average loss: 0.2954, Accuracy: 9189/10000 (92%)
Test set: Average loss: 0.2767, Accuracy: 9237/10000 (92%)
Test set: Average loss: 0.2699, Accuracy: 9267/10000 (93%)
Test set: Average loss: 0.2700, Accuracy: 9251/10000 (93%)
Test set: Average loss: 0.2690, Accuracy: 9244/10000 (92%)
Test set: Average loss: 0.2755, Accuracy: 9240/10000 (92%)
Test set: Average loss: 0.2745, Accuracy: 9253/10000 (93%)
Test set: Average loss: 0.2789, Accuracy: 9232/10000 (92%)

[92.5, 90.1, 91.21, 91.89, 92.37, 92.67, 92.51, 92.44, 92.4, 92.53, 92.32]
</pre>
<pre class="code python3"><a name="rest_code_08b3560d4c094d57afefa09aeef0b4f5-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)),</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_08b3560d4c094d57afefa09aeef0b4f5-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<a name="rest_code_08b3560d4c094d57afefa09aeef0b4f5-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_08b3560d4c094d57afefa09aeef0b4f5-4"></a>
<a name="rest_code_08b3560d4c094d57afefa09aeef0b4f5-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)),</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_08b3560d4c094d57afefa09aeef0b4f5-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">93</span><span class="p">])</span>
<a name="rest_code_08b3560d4c094d57afefa09aeef0b4f5-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/mnist_study_in_pytorch/output_11_0.png" src="images/mnist_study_in_pytorch/output_11_0.png"><img alt="/images/mnist_study_in_pytorch/output_11_1.png" src="images/mnist_study_in_pytorch/output_11_1.png"><p>The right image is a little zoomed in version of the left one. Little dissappointing, isn't it? The more complex models doesn't seem to perform as we would expect. So we can understand that the performance is not proportional to number of layers in neural network. It is in how they interact with each other.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/pytorch%20primer/" class="u-url">PyTorch Primer</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/pytorch%20primer/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/pytorch%20primer/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>This is post is inspired by <cite>Numpy Primer &lt;http://suriyadeepan.github.io/2016-06-26-numpy-primer/&gt;</cite></p>
<div class="section" id="lets-create-some-matrices">
<h2>Lets create some matrices</h2>
<pre class="code python3"><a name="rest_code_0d945f488ad94806b23c71c83211fdba-1"></a> <span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-2"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-3"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-4"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-5"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-6"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-8"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-10"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-11"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-12"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-13"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-14"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-15"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-16"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-17"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-19"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-20"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-21"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-22"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-23"></a>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-24"></a><span class="o">-</span><span class="mf">0.0008</span> <span class="o">-</span><span class="mf">0.6619</span> <span class="o">-</span><span class="mf">0.6790</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-25"></a> <span class="mf">0.9104</span> <span class="o">-</span><span class="mf">0.1249</span> <span class="o">-</span><span class="mf">0.4044</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-26"></a><span class="o">-</span><span class="mf">1.0516</span> <span class="o">-</span><span class="mf">0.4031</span>  <span class="mf">0.9166</span>
<a name="rest_code_0d945f488ad94806b23c71c83211fdba-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre>
<p>I think now we can understand what the parameters to the above functions mean - the shape of the tensor. Take a look at non square matrices below</p>
<pre class="code python3"><a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-3"></a>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-4"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-5"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-7"></a>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-8"></a>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-9"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-10"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-11"></a>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-12"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-13"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-14"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-15"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_336f6401e9e54eb288c0b5cbd1430a60-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x3</span><span class="p">]</span>
</pre>
<p>How about a multidimensional vector - a tensor. Actually tensor is a general term for n-dimensional arrays like in numpy. If you were keen observant, you'd have notices by now that the output of every <strong>print(x)</strong> end with <strong>torch.FloatTensor</strong>. This term became famous with the deep learning storm.</p>
<pre class="code python3"><a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-3"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-7"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-8"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-9"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-10"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-11"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-12"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-15"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-16"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-19"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-20"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-21"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-22"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-23"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-27"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-28"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-29"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-30"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-31"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-32"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-33"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-34"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-35"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-36"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-37"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-38"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-39"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-40"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-41"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-42"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-43"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-44"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-45"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-46"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-47"></a>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-49"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-50"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_41c64563ec934bdb8cb914c4bb4fff48-51"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x3x2x2x3</span><span class="p">]</span>
</pre>
<p>Pause for a moment and take a long look into how the tensor is printed.  And then proceed to look for more matrices below.
The identity matrix - matrix is the keyword.</p>
<pre class="code python3"><a name="rest_code_5c58fc4cab494584aaff62088fa796cf-1"></a><span class="c1"># The identity matrix - max upto two dimensions</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-4"></a>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-5"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-6"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-8"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-9"></a>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-10"></a>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-13"></a>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-14"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-15"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-16"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_5c58fc4cab494584aaff62088fa796cf-17"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x4</span><span class="p">]</span>
</pre>
<p>Alright I get it. Just ones and zeros are boring. Want some more numbers?
<strong>torch.linspace(start, end, count)</strong> creates a list of numbers starting with <strong>start</strong> to <strong>end</strong> at the interval of  <strong>(end - start)/(count - 1)</strong></p>
<pre class="code python3"><a name="rest_code_ebbddab772b84050858c30ea60ba9403-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-3"></a>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-4"></a> <span class="mf">1.0000</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-5"></a> <span class="mf">1.5556</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-6"></a> <span class="mf">2.1111</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-7"></a> <span class="mf">2.6667</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-8"></a> <span class="mf">3.2222</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-9"></a> <span class="mf">3.7778</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-10"></a> <span class="mf">4.3333</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-11"></a> <span class="mf">4.8889</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-12"></a> <span class="mf">5.4444</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-13"></a> <span class="mf">6.0000</span>
<a name="rest_code_ebbddab772b84050858c30ea60ba9403-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p><strong>torch.logspace()</strong> is similar to torch.linspace() but in logarthmic steps.</p>
<pre class="code python3"><a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-3"></a>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-4"></a>  <span class="mf">1.2589</span>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-5"></a>  <span class="mf">2.1135</span>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-6"></a>  <span class="mf">3.5481</span>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-7"></a>  <span class="mf">5.9566</span>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-8"></a> <span class="mf">10.0000</span>
<a name="rest_code_e4bd8b0862c2441c8b7e8d57d142cd02-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">5</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="arithmetics">
<h2>Arithmetics</h2>
<p>So what we created bunch of numbers. What is the use? Lets do some arithmetic</p>
<p>Elementwise addition</p>
<pre class="code python3"><a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-3"></a>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-4"></a> <span class="mi">1</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-5"></a> <span class="mi">1</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-6"></a> <span class="mi">1</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-7"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-8"></a>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-9"></a>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-10"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-11"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-12"></a>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-13"></a> <span class="mi">3</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-14"></a> <span class="mi">3</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-15"></a> <span class="mi">3</span>
<a name="rest_code_e35993a187f14dbd8f69b8684d8caa97-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
</pre>
<p>Elementwise multiplication</p>
<pre class="code python3"><a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-3"></a>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-4"></a>  <span class="mi">1</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-5"></a>  <span class="mi">2</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-6"></a>  <span class="mi">3</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-7"></a>  <span class="mi">4</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-8"></a>  <span class="mi">5</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-9"></a>  <span class="mi">6</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-10"></a>  <span class="mi">7</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-11"></a>  <span class="mi">8</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-12"></a>  <span class="mi">9</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-13"></a> <span class="mi">10</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-15"></a>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-16"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-17"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-18"></a>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-19"></a>  <span class="mi">2</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-20"></a>  <span class="mi">4</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-21"></a>  <span class="mi">6</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-22"></a>  <span class="mi">8</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-23"></a> <span class="mi">10</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-24"></a> <span class="mi">12</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-25"></a> <span class="mi">14</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-26"></a> <span class="mi">16</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-27"></a> <span class="mi">18</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-28"></a> <span class="mi">20</span>
<a name="rest_code_d08da3abd5d14ee5ae5b1ff866d831b7-29"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p>Iterating over the elements and multiplying them by some number</p>
<pre class="code python3"><a name="rest_code_6be0ac8e670f4341b8850561b12911c2-1"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-2"></a>    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-3"></a>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-5"></a>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-6"></a>  <span class="mi">0</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-7"></a>  <span class="mi">2</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-8"></a>  <span class="mi">6</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-9"></a> <span class="mi">12</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-10"></a> <span class="mi">20</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-11"></a> <span class="mi">30</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-12"></a> <span class="mi">42</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-13"></a> <span class="mi">56</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-14"></a> <span class="mi">72</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-15"></a> <span class="mi">90</span>
<a name="rest_code_6be0ac8e670f4341b8850561b12911c2-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p>So yes we can multiply the tensors by ordinary numbers, there is no need for 'i' to be a tensor, lets take a larger tensors, and assign its values by hand. So far we have been using the numbers generated by function like <strong>ones(), zeros() and rand()</strong>. In most cases we need our favoruite numbers. How to do this? <strong>torch.Tensor()</strong> to the rescue.</p>
<pre class="code python3"><a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">67</span><span class="p">])</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-3"></a>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-4"></a>  <span class="mi">1</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-5"></a>  <span class="mi">3</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-6"></a>  <span class="mi">5</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-7"></a>  <span class="mi">6</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-8"></a> <span class="mi">78</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-9"></a>  <span class="mi">3</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-10"></a> <span class="mi">67</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-11"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">7</span><span class="p">]</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-12"></a>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">)])</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-15"></a>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-16"></a>  <span class="mi">0</span>   <span class="mi">2</span>   <span class="mi">4</span>   <span class="mi">6</span>   <span class="mi">8</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-17"></a> <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>  <span class="mi">18</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-18"></a> <span class="mi">20</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_148c0750891c4c8e8ba8826efc5368cd-19"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x5</span><span class="p">]</span>
</pre>
<p>As we can see, the torch.Tensor() takes any iterable or iterables of iterable and makes a tensor out of it</p>
<p>Broadcasting
Adding a scalar to a tensor or multiplying a tensor by a scalar is essentially same as adding or multiplying the tensor by another tensor with shape same as the original tensor, with all its elements being the scalar. Too many words.</p>
<pre class="code python3"><a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-3"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-4"></a>  <span class="mi">1</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-5"></a>  <span class="mi">2</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-6"></a>  <span class="mi">3</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-7"></a>  <span class="mi">4</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-8"></a>  <span class="mi">5</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-9"></a>  <span class="mi">6</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-10"></a>  <span class="mi">7</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-11"></a>  <span class="mi">8</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-12"></a>  <span class="mi">9</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-13"></a> <span class="mi">10</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-15"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-16"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-17"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-19"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-20"></a> <span class="mi">2</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-21"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-22"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-23"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-24"></a><span class="c1"># broadcasting  https://discuss.pytorch.org/t/broadcasting-or-alternative-solutions/120</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-25"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-26"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-27"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-28"></a>  <span class="mi">2</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-29"></a>  <span class="mi">4</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-30"></a>  <span class="mi">6</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-31"></a>  <span class="mi">8</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-32"></a> <span class="mi">10</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-33"></a> <span class="mi">12</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-34"></a> <span class="mi">14</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-35"></a> <span class="mi">16</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-36"></a> <span class="mi">18</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-37"></a> <span class="mi">20</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-38"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-39"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-40"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-41"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-42"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-43"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-44"></a> <span class="mi">2</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-45"></a> <span class="mi">3</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-46"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="p">]</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-47"></a>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-48"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>        <span class="c1">#Dont' work</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-49"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-50"></a>  <span class="n">File</span> <span class="s2">"&lt;stdin&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-51"></a>  <span class="n">File</span> <span class="s2">"/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">274</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand_as</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-52"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-53"></a>  <span class="n">File</span> <span class="s2">"/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">261</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-54"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'incorrect size: only supporting singleton expansion (size=1)'</span><span class="p">)</span>
<a name="rest_code_94f3a57c54184f2c98775f6a23c53d0a-55"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="n">incorrect</span> <span class="n">size</span><span class="p">:</span> <span class="n">only</span> <span class="n">supporting</span> <span class="n">singleton</span> <span class="n">expansion</span> <span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre>
<p>Note that the expand_as() works only for singletons</p>
<div class="section" id="reshaping-tensors">
<h3>Reshaping Tensors</h3>
<p><strong>view()</strong> takes list of number and reshapes the tensor as per the arguments.</p>
<p>The constrain is for view(a, b, c,....n) a x b x c x ... x n should be equal to the size of the given tensor. If you give <em>'-1'</em> as the last argument to <strong>view()</strong> it will calculate the last dimension by itself.</p>
<pre class="code python3"><a name="rest_code_400de5ede4a3409aa151e3072878e7a1-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-3"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-4"></a>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-5"></a>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x5</span><span class="p">]</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-7"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-8"></a><span class="c1"># making matrices by hand is hard right?</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-9"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-10"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-12"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-13"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-14"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-15"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-16"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-17"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-18"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-20"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-21"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-22"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-23"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-24"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-25"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-26"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-27"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-28"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-29"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-30"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-31"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-32"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-33"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-34"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-35"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-36"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-37"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-39"></a>   <span class="mi">5</span>   <span class="mi">6</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-40"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-41"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-42"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-43"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-44"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-45"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-46"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-47"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-48"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-49"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-50"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-51"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-52"></a><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-53"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-54"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-55"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-56"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-57"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-58"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-59"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-60"></a>   <span class="mi">5</span>  <span class="o">-</span><span class="mi">6</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-61"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-62"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-63"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-64"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-65"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-66"></a>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-67"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-68"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-69"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_400de5ede4a3409aa151e3072878e7a1-70"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
</pre>
<p>Notice that change in value of an element in <strong>x</strong> reflects in <strong>x_</strong>. It is because view() does exactly what is says it will do. It creates a view of the tensor, the underlying storage is same for <strong>x</strong> and <strong>x_</strong></p>
</div>
<div class="section" id="statistics">
<h3>Statistics</h3>
<pre class="code python3"><a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-1"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-2"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-4"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-5"></a>  <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-6"></a>  <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-7"></a>  <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-8"></a> <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-10"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-12"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-13"></a> <span class="mi">28</span>  <span class="mi">32</span>  <span class="mi">36</span>  <span class="mi">40</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-15"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-16"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-17"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-18"></a> <span class="mi">10</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-19"></a> <span class="mi">26</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-20"></a> <span class="mi">42</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-21"></a> <span class="mi">58</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-22"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x1</span><span class="p">]</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-23"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-24"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-26"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-27"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-28"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-29"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-30"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-31"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-32"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-33"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-34"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-35"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-36"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-37"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-39"></a>  <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-40"></a>  <span class="mi">18</span>  <span class="mi">20</span>  <span class="mi">22</span>  <span class="mi">24</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-41"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-42"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-44"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-45"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-46"></a>   <span class="mi">6</span>   <span class="mi">8</span>  <span class="mi">10</span>  <span class="mi">12</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-47"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-49"></a>  <span class="mi">22</span>  <span class="mi">24</span>  <span class="mi">26</span>  <span class="mi">28</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-50"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x1x4</span><span class="p">]</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-51"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-52"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-53"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-54"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-55"></a>  <span class="mi">10</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-56"></a>  <span class="mi">26</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-57"></a>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-58"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-59"></a>  <span class="mi">42</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-60"></a>  <span class="mi">58</span>
<a name="rest_code_2938cdf9a01a43d4b95860153cc8ed6b-61"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x1</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="matrix-multiplication">
<h3>Matrix Multiplication</h3>
<p><strong>mm()</strong> is name. See how it is different from normal elementwise multiplication, like we used to do in linear algebra class?</p>
<pre class="code python3"><a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-1"></a><span class="c1">#lets do some matrix multiplications</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-2"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-3"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]])</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-4"></a>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-6"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-7"></a>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-9"></a>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-10"></a>  <span class="mi">70</span>  <span class="mi">100</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-11"></a> <span class="mi">150</span>  <span class="mi">220</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-12"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2</span><span class="p">]</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-13"></a>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-14"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-15"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-16"></a>                  <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-17"></a>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-18"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-19"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-21"></a>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-22"></a>  <span class="mi">70</span>  <span class="mi">100</span>  <span class="mi">170</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-23"></a> <span class="mi">150</span>  <span class="mi">220</span>  <span class="mi">390</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-24"></a> <span class="mi">230</span>  <span class="mi">340</span>  <span class="mi">610</span>
<a name="rest_code_7b416fdbe9934d2e933ebe1efe1da137-25"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="indexing-and-slicing">
<h3>Indexing and slicing</h3>
<pre class="code python3"><a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-1"></a><span class="c1">#Indexing and slicing</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-4"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-5"></a>  <span class="mi">1</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-6"></a>  <span class="mi">2</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-7"></a>  <span class="mi">3</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-8"></a>  <span class="mi">4</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-9"></a>  <span class="mi">5</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-10"></a>  <span class="o">.</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-11"></a>  <span class="o">.</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-12"></a>  <span class="o">.</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-13"></a> <span class="mi">61</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-14"></a> <span class="mi">62</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-15"></a> <span class="mi">63</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-16"></a> <span class="mi">64</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-17"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-19"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-20"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-21"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-23"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-25"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-26"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-27"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-28"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-29"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-30"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-31"></a>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">20</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-32"></a>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-33"></a>  <span class="mi">25</span>  <span class="mi">26</span>  <span class="mi">27</span>  <span class="mi">28</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-34"></a>  <span class="mi">29</span>  <span class="mi">30</span>  <span class="mi">31</span>  <span class="mi">32</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-35"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-36"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-37"></a>  <span class="mi">33</span>  <span class="mi">34</span>  <span class="mi">35</span>  <span class="mi">36</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-38"></a>  <span class="mi">37</span>  <span class="mi">38</span>  <span class="mi">39</span>  <span class="mi">40</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-39"></a>  <span class="mi">41</span>  <span class="mi">42</span>  <span class="mi">43</span>  <span class="mi">44</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-40"></a>  <span class="mi">45</span>  <span class="mi">46</span>  <span class="mi">47</span>  <span class="mi">48</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-41"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-42"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-43"></a>  <span class="mi">49</span>  <span class="mi">50</span>  <span class="mi">51</span>  <span class="mi">52</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-44"></a>  <span class="mi">53</span>  <span class="mi">54</span>  <span class="mi">55</span>  <span class="mi">56</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-45"></a>  <span class="mi">57</span>  <span class="mi">58</span>  <span class="mi">59</span>  <span class="mi">60</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-46"></a>  <span class="mi">61</span>  <span class="mi">62</span>  <span class="mi">63</span>  <span class="mi">64</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-47"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-48"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-49"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-50"></a>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-51"></a> <span class="mi">21</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-52"></a> <span class="mi">22</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-53"></a> <span class="mi">23</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-54"></a> <span class="mi">24</span>
<a name="rest_code_1d2fb7aa5db24b1ca7f1b90e2d69c61f-55"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="masking">
<h3>Masking</h3>
<pre class="code python3"><a name="rest_code_5faa19285fc441b796c46d5414ff9645-1"></a><span class="c1">#the expression 'x_ % 4 == 0' creates a mask</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-3"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-7"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-8"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-9"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-10"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-11"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-12"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-15"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-16"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-19"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-20"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-21"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-22"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-23"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-24"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-28"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-29"></a><span class="c1"># Use the mask to extract just those elements</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-30"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-31"></a><span class="n">x_</span><span class="p">[</span><span class="mi">0</span><span class="p">][(</span><span class="n">x_</span><span class="o">%</span><span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-32"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-33"></a>  <span class="mi">4</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-34"></a>  <span class="mi">8</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-35"></a> <span class="mi">12</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-36"></a> <span class="mi">16</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-37"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-38"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-39"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-40"></a><span class="c1">#more grander masking example</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-41"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-42"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-44"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-45"></a>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-46"></a>  <span class="mi">2</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-47"></a>  <span class="mi">3</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-48"></a>  <span class="mi">4</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-49"></a>  <span class="mi">5</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-50"></a>  <span class="o">.</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-51"></a>  <span class="o">.</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-52"></a>  <span class="o">.</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-53"></a> <span class="mi">61</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-54"></a> <span class="mi">62</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-55"></a> <span class="mi">63</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-56"></a> <span class="mi">64</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-57"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-58"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-59"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-60"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-61"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-62"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-63"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-64"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-65"></a>   <span class="mi">17</span>    <span class="mi">18</span>    <span class="mi">19</span>    <span class="mi">20</span>    <span class="mi">21</span>    <span class="mi">22</span>    <span class="mi">23</span>    <span class="mi">24</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-66"></a>   <span class="mi">25</span>    <span class="mi">26</span>    <span class="mi">27</span>    <span class="mi">28</span>    <span class="mi">29</span>    <span class="mi">30</span>    <span class="mi">31</span>    <span class="mi">32</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-67"></a>   <span class="mi">33</span>    <span class="mi">34</span>    <span class="mi">35</span>    <span class="mi">36</span>    <span class="mi">37</span>    <span class="mi">38</span>    <span class="mi">39</span>    <span class="mi">40</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-68"></a>   <span class="mi">41</span>    <span class="mi">42</span>    <span class="mi">43</span>    <span class="mi">44</span>    <span class="mi">45</span>    <span class="mi">46</span>    <span class="mi">47</span>    <span class="mi">48</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-69"></a>   <span class="mi">49</span>    <span class="mi">50</span>    <span class="mi">51</span>    <span class="mi">52</span>    <span class="mi">53</span>    <span class="mi">54</span>    <span class="mi">55</span>    <span class="mi">56</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-70"></a>   <span class="mi">57</span>    <span class="mi">58</span>    <span class="mi">59</span>    <span class="mi">60</span>    <span class="mi">61</span>    <span class="mi">62</span>    <span class="mi">63</span>    <span class="mi">64</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-71"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-72"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-73"></a><span class="n">x_ind</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">byte</span><span class="p">()</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-74"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_ind</span><span class="p">)</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-75"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-76"></a>    <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-77"></a>    <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-78"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-79"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-80"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-81"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-82"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-83"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-84"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-85"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-86"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x_ind</span><span class="p">])</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-87"></a>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-88"></a>  <span class="mi">1</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-89"></a> <span class="mi">10</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-90"></a> <span class="mi">19</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-91"></a> <span class="mi">28</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-92"></a> <span class="mi">37</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-93"></a> <span class="mi">46</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-94"></a> <span class="mi">55</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-95"></a> <span class="mi">64</span>
<a name="rest_code_5faa19285fc441b796c46d5414ff9645-96"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="p">]</span>
</pre>
<p>Please leave your comments below.</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/vanangamudimnist/" class="u-url">VanangamudiMNIST</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/vanangamudimnist/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/vanangamudimnist/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>WORK IN PROGRESS</p>
<p>The problem I designed for this post came to me when I was trying to
explain neural network to my friend who is just getting started on it.
The hello world of deep learning is MNIST, but the size of the MNIST
images is 28x28 which is too large to help us understand the ideas in
terms of observable concrete computations and visualizations. So here
you go.</p>
<p><em>Note: It is not my intention for you to read the code. I advice against
it. I include the code in the post for the reason that, if anyone
interested in trying it out in their desktop or laptop, they should be
able to. Please don't read the code, focus on the concepts and
computations :)</em></p>
<pre class="code python3"><a name="rest_code_e9593391e6524ed4bc8822e3b42bec22-1"></a><span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_e9593391e6524ed4bc8822e3b42bec22-2"></a><span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="k">import</span> <span class="n">Variable</span>
</pre>
<div class="section" id="dataset">
<h2>DATASET</h2>
<p>Dataset is a collection of data. What is in a dataset and why we need
it?</p>
<pre class="code python3"><a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-1"></a><span class="n">dataset</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#list of tuples (image, label)</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-2"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-3"></a><span class="n">zer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-4"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-5"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-6"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-7"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-8"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-9"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-10"></a><span class="n">one</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-11"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-12"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-13"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-14"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-15"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-16"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-17"></a><span class="n">two</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-18"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-19"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-20"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-21"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-22"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-23"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-24"></a><span class="n">thr</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-25"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-26"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-27"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-28"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-29"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-30"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-31"></a><span class="n">fou</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-32"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-33"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-34"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-35"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-36"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-37"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-38"></a><span class="n">fiv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-39"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-40"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-41"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-42"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-43"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-44"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-45"></a><span class="n">six</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-46"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-47"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-48"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-49"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-50"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-51"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-52"></a><span class="n">sev</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-53"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-54"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-55"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-56"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-57"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-58"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-59"></a><span class="n">eig</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-60"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-61"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-62"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-63"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-64"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-65"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-66"></a><span class="n">nin</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-67"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-68"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-69"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-70"></a>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-71"></a>                   <span class="p">])</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-72"></a>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-73"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">zer</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-74"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">one</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-75"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">two</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-76"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">thr</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-77"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fou</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">4</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-78"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fiv</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">5</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-79"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">six</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">6</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-80"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sev</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">7</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-81"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">eig</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">8</span><span class="p">])))</span>
<a name="rest_code_ab9e2b83ebac432491ce9523e328c6e5-82"></a><span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nin</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">9</span><span class="p">])))</span>
</pre>
<div class="section" id="take-a-look-into-how-the-data-looks-like">
<h3>Take a look into how the data looks like</h3>
<pre class="code python3"><a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-5"></a>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-6"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">))</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-7"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-8"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-9"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-10"></a>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-11"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-12"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-13"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_4a6b5e2cfcdf41c48a2bceaf329b65f2-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_5_0.png" src="images/vanangamudimnist/output_5_0.png"><p>We have a set of 10 images of numbers 0..9. We want to make a neural
network to predict what is the number on the image.</p>
</div>
</div>
<div class="section" id="model">
<h2>MODEL</h2>
<p>Model is the term we use to refer to the network. Our model is a simple
<strong>25</strong>x<strong>10</strong> matrix. Don't get startled by the class and the
imports. It just does matrix multiplication. For now assume
<strong>*model()*</strong> is a function which will take in a matrix of size (AxB) as
input and mutiply it with the network weight matrix of size (BxC), to
produce another matrix as output of size (AxC).</p>
<pre class="code python3"><a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-1"></a><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-2"></a><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-3"></a><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-4"></a>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-5"></a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-6"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-7"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-9"></a>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-10"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-11"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b71d0ea898da4008a5a220c4e0312f76-12"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre>
<pre class="code python3"><a name="rest_code_e26f85380a3344f1ad81ebad8c42b435-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<a name="rest_code_e26f85380a3344f1ad81ebad8c42b435-2"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre>
<div class="section" id="dataset-model-output">
<h3>DATASET - MODEL - OUTPUT</h3>
<p>To understand the network and its training process, it is helpful to see
the holy trinity INPUT-MODEL-OUTPUT</p>
<pre class="code python3"><a name="rest_code_4a35f0cb0d344979be920092796411c7-1"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">16.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">))</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-2"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-3"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-4"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-5"></a>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-6"></a>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-7"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-8"></a><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-9"></a>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-10"></a><span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-11"></a><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-12"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-13"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-14"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-15"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-16"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-17"></a>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-18"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-19"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-20"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-21"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-22"></a>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-23"></a>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-24"></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-25"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-26"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-27"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-28"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-29"></a>
<a name="rest_code_4a35f0cb0d344979be920092796411c7-30"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_11_0.png" src="images/vanangamudimnist/output_11_0.png"><p>Lets try to understand what is in the picture above.</p>
<p>The first one is the collection of all the data that we have. The second
one is the matrix of weights connecting the input of 25 input neurons to
10 output neurons. And the last one we will get to it little later.</p>
<p>What is special about 25 and 10 here?</p>
<p>Nothing. Our dataset is a set of images of numbers each having a size of
5x5 ==&gt; 25. And we have how many different numbers a hand? 0,1,2...9 ==&gt;
10 numbers or 10 different classes of output(this will become clear in
the next post)</p>
<p>What is that weird picture on the left, having weird</p>
<ul class="simple">
<li>zero in the  top-left,</li>
<li>and three on the bottom-right</li>
<li>and some messed up fours and eights in the middle.</li>
</ul>
<p>Let get to it. Look the picture below.</p>
<pre class="code python3"><a name="rest_code_330688f3bd4343dc9982a46e3c81c029-1"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">12.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">))</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-2"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-3"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-4"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-5"></a>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-7"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-8"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-9"></a>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-11"></a>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-12"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">))</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-13"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-14"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-15"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-16"></a>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-17"></a>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-18"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-19"></a>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-20"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-21"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-22"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
<a name="rest_code_330688f3bd4343dc9982a46e3c81c029-23"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre>
<img alt="/images/vanangamudimnist/output_13_0.png" src="images/vanangamudimnist/output_13_0.png"><img alt="/images/vanangamudimnist/output_13_1.png" src="images/vanangamudimnist/output_13_1.png"><p>Voila!! We have just arranged the image matrix into a vector. TODO why?</p>
<p>This is important to remember, <strong>a simple neural network looks at the
input and try to figure out which class does this input belong to</strong></p>
<p>In our case inputs are the images of numbers, and outputs are how
similar are the classes to the input. The output neuron with highest
value is closer(very similar) to the input and the output neuron with
least value is very NOT similar to the input. <strong>The inputs are real
valued - it can take any numerical value but the output is discrete, a
whole number corresponding to index of the neuron with largest numerical
value.</strong> Also note that output of the network does not mean output of
neurons.</p>
<p>For example after training, if we feed the image of number 3, the output
neurons corresponding to 3, 8, 9 and probably 7 will have larger values
and the output neurons corresponding to 1 and 6 will have the least
value. Don't worry if you don't understand why, it will become clearer
as we go on.</p>
</div>
<div class="section" id="how-many-correct-predictions-without-any-training">
<h3>How many correct predictions without any training</h3>
<p>Too much theory, lets get our hands dirty. Let see how many numbers did
our model predicted correctly.</p>
<pre class="code python3"><a name="rest_code_4c4f4712e31c48e6b9c6a77e3aed6905-1"></a><span class="c1"># Remember that output = model(Variable(data))</span>
<a name="rest_code_4c4f4712e31c48e6b9c6a77e3aed6905-2"></a><span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_4c4f4712e31c48e6b9c6a77e3aed6905-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">target</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a name="rest_code_4c4f4712e31c48e6b9c6a77e3aed6905-4"></a><span class="n">correct</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_4c4f4712e31c48e6b9c6a77e3aed6905-5"></a><span class="nb">print</span><span class="p">(</span><span class="s1">'correct: </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)))</span>
</pre>
<pre class="literal-block">
torch.Size([10]) torch.Size([10])
correct: 1/10
</pre>
</div>
<div class="section" id="n-one-out-of-ten">
<h3>(N)ONE out of TEN</h3>
<p>That is right it predicted none out of ten. We feeded our network with
all of our data and asked it to figure what is the number that is in the
image. Remember what we learned earlier about output neurons. The neural
network tell us which number is present in the image by lighting up that
corresponding neuron. Lets say if gave 6, the network will light up the
6th neuron will be the brightest, i.e the 6th neurons value will be the
highest compared to all other neurons.</p>
<p>But our network above lit up wrong bulbs, for all the output. None out
of ten. But why? Isn't neural network are supposed to smarter? Well yes
and no. That is the difference between traditional image processing
algorithms and neural networks.</p>
<p>Wait, let me tell you a story, that I heard. During the second world
war, there were skilled flight spotter. Their job was to spot and report
if any air craft was approaching. As the war got intense, there was need
for more spotters and there were lot of volunteers even from schools and
colleges but there was very little time to train them. So the skilled
spotters, listed out a set of things to look for in the enemy flights
and asked the new volunteers to memorize them as part of the training.
But the volunteers never got good at spotting. Ooosh, we will continue
the story later, lets get back to the point.</p>
<p>In classical image processing systems, we humans think, think and think
and think a lot more and come up a set of rules or instructions, just
like those skilled spotters. We give those instructions to the system,
to make it understand how to process the images to extract
information(called features - things to look for in the enemy flight)
from them, and then use that information to make further decisions, such
predicting what number is in the image. We feed that system with
knowledge first before asking it to do anything for us.</p>
<p>But did we feed any knowledge to network? We just told it the input size
is 25 and output size is 10. How can you expect someone to guess what is
in your hand, by just telling them its size. That is rude of you. Shame
on you. Okay okay. How do we make the system more knowledgable about the
input? Training. The holy grail of deep learning.</p>
</div>
<div class="section" id="what-is-training">
<h3>What is training?</h3>
<p>We know that the knowledge of the neural network is in the weights of
the connections - represented as matrix above. We also know that by
multiplying this matrix by an input image vector we will get an output
which is a set of scores that describes, how similar the input is to the
output neurons.</p>
<p>Imagine giving random values to the weights and feed the network with
our data and see whether it predicts all our numbers correctly. If it
did, fine and dandy, but if not give random values to the weights again
and repeat the process until our network predicts all the numbers
correctly. That is training in most simple form.</p>
<p>But think about how long will it take to find such random magical values
for every weight in the network to make it work as expected. We don't
know that for sure. right? You wanna continue the story. don't you?
Alright.</p>
<p>The skilled people tried as much as they can to identify the
distinguishing features of the home and enemy air crafts and tried to
make the volunteers understand them. It never worked. Then they changes
the strategy. They put them on the job and made them learn themselves.
i.e every skilled spotter will have ten volunteers and whenever an
aircraft is seen, the volunteers will shout the kind of the plane, say
'german'. Then the skilled one, will reveal the correct answer. This
technique was extrememly sucessful, a spotter sent in an emergency
message not only identifying it as a German aircraft, but also the
correct make and
model..<a class="reference external" href="http://www.colebrookhistoricalsociety.org/PDF%20Images/Air%20Spotters%20of%20WWII.pdf">more</a></p>
<p>Hey, why don't we try the same with our network? Lets feed the images
into it and shout the answer into its tiny little output neurons so that
it can update its weights by itself. Now I know you're asking how can we
expect, a dumb network which cannot even predict a number in an image to
train itself? Well that is where it gets interesting. We can't.
Backpropgation to the rescue. It is the algorithm to update the weights
of the network on our behalf.</p>
<p>It looks at how difference between output of network and desired output,
changes with respect to the weights, and then it modifies the weights
based on it. [2]</p>
<p>So now you understand why it predicted none out of ten correctly.</p>
<pre class="code python3"><a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-1"></a><span class="kn">import</span> <span class="nn">sys</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-2"></a><span class="k">def</span> <span class="nf">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-3"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-4"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-5"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-6"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-7"></a>    <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-8"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-9"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-10"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-11"></a>    <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">()))</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-12"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-13"></a>    <span class="n">dataset_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-14"></a>    <span class="n">model_img</span>   <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-15"></a>    <span class="n">output_img</span>  <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-16"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-17"></a>    <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-18"></a>    <span class="n">correct</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-19"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">'correct: </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">, loss:</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-21"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-22"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-23"></a>    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-24"></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">16.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">))</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-25"></a>        <span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-26"></a>                         <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-27"></a>                         <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-28"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-29"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">dataset_img</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-30"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-31"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-32"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-33"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-34"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-35"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">model_img</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-36"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-37"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-38"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-39"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-40"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">output_img</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-41"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-42"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-43"></a>        <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-44"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-45"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-46"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-47"></a>
<a name="rest_code_b996bd9f509041b6a88a29b6a5b92928-48"></a>    <span class="k">return</span> <span class="n">dataset_img</span><span class="p">,</span> <span class="n">model_img</span><span class="p">,</span> <span class="n">output_img</span>
</pre>
</div>
<div class="section" id="lets-take-a-closer-look-at-dataset-model-output">
<h3>Lets take a closer look at DATASET - MODEL - OUTPUT</h3>
<p>and understand what those colors mean.[1]</p>
<pre class="code python3"><a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-1"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-2"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-3"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-4"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-5"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-6"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-7"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-8"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-9"></a><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-10"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-11"></a><span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-12"></a><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-13"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-14"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-15"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-16"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-17"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-18"></a><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-19"></a><span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-20"></a>     <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:d}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-21"></a>            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-22"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-23"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-24"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-25"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-26"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-27"></a><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-28"></a><span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-29"></a>     <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:0.04f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-30"></a>            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-31"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-32"></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-33"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-34"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-35"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-36"></a><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-37"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-38"></a><span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-39"></a>     <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:0.04f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-40"></a>            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-41"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-42"></a>
<a name="rest_code_89cd14fc9dd245fa932fbc7a9bdeaf32-43"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_20_0.png" src="images/vanangamudimnist/output_20_0.png"><p>If you zoom in the picture you will see numbers corresponding to the
colors - violet means the lowest value, and yellow is the highest
values. i.e violet does not mean 0 and yellow does not mean 1 as you
might think from the dataset image.</p>
</div>
<div class="section" id="what-does-each-row-mean">
<h3>WHAT DOES EACH ROW MEAN?</h3>
</div>
<div class="section" id="id1">
<h3>DATASET</h3>
<p>numbers, each row is a number. first one is 0 second one is 1 and so on.</p>
</div>
<div class="section" id="id2">
<h3>MODEL</h3>
<p>weights corresponding to pixels in the image for a number.
first row is for 0 and last one is for 9.</p>
</div>
<div class="section" id="output">
<h3>OUTPUT</h3>
<p>scores of similarity. how similar the input image to all output
numbers. First row contains scores of 0, how similar it is to all other
numbers first square in the first row is how simlilar 0 is to 0, second
square similar it is to 1. Now the scores are not only incorrect but
stupid. This will become better and clear as we train the network. Lets
take look at the DATASET-MODEL-OUTPUT trinity once again before training</p>
<p>Take look at the following. It shows a single row from the output image.
Go on pick the darkest square in the output above. Which row has the
darkeset one?, it seems like the row corresponding to number 4, i.e
<em>data[4]</em> the least value from that row is <strong>-3.0710</strong></p>
<pre class="code python3"><a name="rest_code_a80678409223429ca38473350eee2866-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))))</span>
</pre>
<pre class="literal-block">
Variable containing:
-2.2242 -2.0100 -2.4086 -2.2264 -2.3357 -1.9604 -2.5856 -3.0710 -2.0782 -2.5825
[torch.FloatTensor of size 1x10]
</pre>
<p>Similarly the brightest yellow is in the row corresonding to number 1
whose value is <strong>-1.9198</strong> you can see below. The reason I am stressing
about this fact is, this is will influence how we interpret the
following images.</p>
<pre class="code python3"><a name="rest_code_83b7b083596d4ac5922e86f9110ce295-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))))</span>
</pre>
<pre class="literal-block">
Variable containing:
-2.9334 -2.5239 -1.9198 -2.3306 -2.3984 -2.1636 -2.2579 -2.3235 -2.1503 -2.3224
[torch.FloatTensor of size 1x10]
</pre>
<pre class="code python3"><a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-1"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-2"></a><span class="k">def</span> <span class="nf">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">):</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-3"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">))</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-4"></a>    <span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-5"></a>                         <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-6"></a>                         <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-7"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-8"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-9"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-10"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-11"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-12"></a>    <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-13"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-14"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-15"></a>    <span class="n">plot_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">))</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-16"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tobeplotted</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_data</span><span class="p">):</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-17"></a>        <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">tobeplotted</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-18"></a>        <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-19"></a>        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">tobeplotted</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-20"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">spec</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{:d}</span><span class="s1">'</span><span class="p">;</span>  <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-21"></a>            <span class="k">else</span><span class="p">:</span> <span class="n">spec</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{:0.2f}</span><span class="s1">'</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-22"></a>            <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-23"></a>                <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">))</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-24"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-25"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-26"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-27"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-28"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-29"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-30"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-31"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-32"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-33"></a>    <span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'25'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">144</span><span class="p">)</span>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-34"></a>
<a name="rest_code_c53c8542e74d4bca8a9929650bcaab75-35"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="before-training">
<h3>Before Training</h3>
<pre class="code python3"><a name="rest_code_aaad08b6582146089952cf8bc7b10708-1"></a><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="s1">'sama'</span><span class="p">)</span>
<a name="rest_code_aaad08b6582146089952cf8bc7b10708-2"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
correct: 1/10, loss:2.4236292839050293
</pre>
<img alt="/images/vanangamudimnist/output_28_1.png" src="images/vanangamudimnist/output_28_1.png"><img alt="/images/vanangamudimnist/output_28_2.png" src="images/vanangamudimnist/output_28_2.png">
</div>
</div>
<div class="section" id="training">
<h2>Training</h2>
<div class="section" id="train-for-a-single-epoch">
<h3>Train for a single epoch</h3>
<p>Training for a single epoch means run over all the ten images we have
now.</p>
<pre class="code python3"><a name="rest_code_3be2e87718dd487685bac2cac7242ea5-1"></a><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-2"></a>    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-3"></a>    <span class="n">avg_loss</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-4"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-5"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-6"></a>        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">long</span><span class="p">())</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-7"></a>        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-8"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-9"></a>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-10"></a>        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-11"></a>        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-12"></a>        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-13"></a>        <span class="n">avg_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-14"></a>
<a name="rest_code_3be2e87718dd487685bac2cac7242ea5-15"></a>    <span class="k">return</span> <span class="n">avg_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="train-the-model-once-and-see-how-it-works">
<h3>Train the model once and see how it works</h3>
<pre class="code python3"><a name="rest_code_e223d54fea3340559f66cb5b74026588-1"></a><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
7.596218156814575
</pre>
<pre class="code python3"><a name="rest_code_e15736393d20489385d3ec43aa44cf56-1"></a><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_e15736393d20489385d3ec43aa44cf56-2"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
correct: 2/10, loss:5.988691329956055
</pre>
<img alt="/images/vanangamudimnist/output_34_1.png" src="images/vanangamudimnist/output_34_1.png"><img alt="/images/vanangamudimnist/output_34_2.png" src="images/vanangamudimnist/output_34_2.png">
</div>
<div class="section" id="train-once-again">
<h3>train once again</h3>
<pre class="code python3"><a name="rest_code_ae5fc04a645b40cb8a5978c225644c7c-1"></a><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
6.19214208945632
</pre>
<pre class="code python3"><a name="rest_code_87ef4a3cfbfb4d1184c62ed81d7f6811-1"></a><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_87ef4a3cfbfb4d1184c62ed81d7f6811-2"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
correct: 2/10, loss:5.175973892211914
</pre>
<img alt="/images/vanangamudimnist/output_37_1.png" src="images/vanangamudimnist/output_37_1.png"><img alt="/images/vanangamudimnist/output_37_2.png" src="images/vanangamudimnist/output_37_2.png"><p>As you can see the diagonal of the output matrix is getting brighter and
brighter.</p>
<p>That is what we want right? For each number, say for number 0. the first
square in first row should be the brightest one. 1. the second square in
second row should be the brightest one 2. the third square in third row
should be the brightest one and so on.</p>
<p>Lets see the numbers directly.</p>
</div>
<div class="section" id="train-over-multiple-epochs">
<h3>Train over multiple epochs</h3>
<p>means run over the all the samples multiple times.</p>
<pre class="code python3"><a name="rest_code_21c32f9acb19445b8ec96228cfce5707-1"></a><span class="k">def</span> <span class="nf">train_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-2"></a>    <span class="n">snaps</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-3"></a>    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-4"></a>        <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-5"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">epoch</span> <span class="o">%</span> <span class="n">print_every</span><span class="p">:</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-6"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n\n</span><span class="s1">========================================================'</span><span class="p">)</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-7"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">'epoch: </span><span class="si">{}</span><span class="s1">, loss:</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">avg_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-8"></a>            <span class="n">snaps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="s1">'epoch:</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">)))</span>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-9"></a>
<a name="rest_code_21c32f9acb19445b8ec96228cfce5707-10"></a>    <span class="k">return</span> <span class="n">snaps</span>
</pre>
<pre class="code python3"><a name="rest_code_a94ee05cfb5c4dc6bbdab3f8d4ea408c-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<a name="rest_code_a94ee05cfb5c4dc6bbdab3f8d4ea408c-2"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre>
<p>Lets train for 100 epochs and see how the model evolves. We see that in
the output image, the diagonal get brigher and brighter and some other
pixels getting darker and darker. It appears to be smoothing over time.
Also see that after just 10 epochs the network predicts 9/10 correctly
and then after 20 epochs it mastered the task, predicting 10/10 all the
time. But we already know that is what we want and we know why. Lets
focus on the model now, because that is where the secret lies.</p>
<pre class="code python3"><a name="rest_code_b4b3acfcc79c454488f8feeddfd0ec24-1"></a><span class="n">snaps</span> <span class="o">=</span> <span class="n">train_epochs</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="literal-block">
========================================================
epoch: 0, loss:0.027155441761016846
correct: 3/10, loss:2.128438949584961
</pre>
<img alt="/images/vanangamudimnist/output_43_1.png" src="images/vanangamudimnist/output_43_1.png"><pre class="literal-block">
========================================================
epoch: 2, loss:0.023229331612586973
correct: 5/10, loss:1.8037703037261963
</pre>
<img alt="/images/vanangamudimnist/output_43_3.png" src="images/vanangamudimnist/output_43_3.png"><pre class="literal-block">
========================================================
epoch: 4, loss:0.01998117029666901
correct: 6/10, loss:1.533529281616211
</pre>
<img alt="/images/vanangamudimnist/output_43_5.png" src="images/vanangamudimnist/output_43_5.png"><pre class="literal-block">
========================================================
epoch: 6, loss:0.01730852520465851
correct: 8/10, loss:1.3195956945419312
</pre>
<img alt="/images/vanangamudimnist/output_43_7.png" src="images/vanangamudimnist/output_43_7.png"><pre class="literal-block">
========================================================
epoch: 8, loss:0.015147660285234451
correct: 9/10, loss:1.150416612625122
</pre>
<img alt="/images/vanangamudimnist/output_43_9.png" src="images/vanangamudimnist/output_43_9.png"><pre class="literal-block">
========================================================
epoch: 10, loss:0.013388317018747329
correct: 9/10, loss:1.0151952505111694
</pre>
<img alt="/images/vanangamudimnist/output_43_11.png" src="images/vanangamudimnist/output_43_11.png"><pre class="literal-block">
========================================================
epoch: 12, loss:0.011944577842950822
correct: 10/10, loss:0.9058278799057007
</pre>
<img alt="/images/vanangamudimnist/output_43_13.png" src="images/vanangamudimnist/output_43_13.png"><pre class="literal-block">
========================================================
epoch: 14, loss:0.010749261453747749
correct: 10/10, loss:0.8161996006965637
</pre>
<img alt="/images/vanangamudimnist/output_43_15.png" src="images/vanangamudimnist/output_43_15.png"><pre class="literal-block">
========================================================
epoch: 16, loss:0.009749157413840293
correct: 10/10, loss:0.7417219281196594
</pre>
<img alt="/images/vanangamudimnist/output_43_17.png" src="images/vanangamudimnist/output_43_17.png"><pre class="literal-block">
========================================================
epoch: 18, loss:0.008902774766087532
correct: 10/10, loss:0.6789848208427429
</pre>
<img alt="/images/vanangamudimnist/output_43_19.png" src="images/vanangamudimnist/output_43_19.png"><pre class="literal-block">
========================================================
epoch: 20, loss:0.008178293675184248
correct: 10/10, loss:0.6254634857177734
</pre>
<img alt="/images/vanangamudimnist/output_43_21.png" src="images/vanangamudimnist/output_43_21.png"><p>Lets put all those picture above into a single one to get a big picture</p>
<pre class="code python3"><a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-1"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">16.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">))</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-2"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-3"></a>                     <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snaps</span><span class="p">)</span> <span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-4"></a>                     <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-5"></a>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">snap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snaps</span><span class="p">):</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-7"></a>    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snap</span><span class="p">):</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-8"></a>        <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-9"></a>        <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-10"></a>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-11"></a>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-12"></a><span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'DATASET'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-13"></a><span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'MODEL'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-14"></a><span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'OUTPUT'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-15"></a>
<a name="rest_code_7e8dcae710574e51a29eb799c0f0dfe5-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/vanangamudimnist/output_45_0.png" src="images/vanangamudimnist/output_45_0.png"><p>The following animation show the state of the model over 50 epochs.</p>
<div class="figure">
<img alt="Animated view" src="images/vanangamudimnist/VanangamudiMNIST_training_animation.gif"><p class="caption">Animation</p>
</div>
<p>Lets train it for few thousand epochs so the network get more clear
picture of the data before diving into the model :)</p>
<pre class="code python3"><a name="rest_code_c4d8c287a3314502b670f24038529630-1"></a><span class="n">snaps</span> <span class="o">=</span> <span class="n">train_epochs</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
</pre>
<pre class="literal-block">
========================================================
epoch: 0, loss:0.007853959694504737
correct: 10/10, loss:0.60155189037323
</pre>
<img alt="/images/vanangamudimnist/output_49_1.png" src="images/vanangamudimnist/output_49_1.png"><pre class="literal-block">
========================================================
epoch: 20000, loss:7.162017085647676e-06
correct: 10/10, loss:0.0007155142375268042
</pre>
<img alt="/images/vanangamudimnist/output_49_3.png" src="images/vanangamudimnist/output_49_3.png"><pre class="literal-block">
========================================================
epoch: 40000, loss:3.5982332410640085e-06
correct: 10/10, loss:0.0003596492169890553
</pre>
<img alt="/images/vanangamudimnist/output_49_5.png" src="images/vanangamudimnist/output_49_5.png"><pre class="literal-block">
========================================================
epoch: 60000, loss:2.403507118287962e-06
correct: 10/10, loss:0.00024027279869187623
</pre>
<img alt="/images/vanangamudimnist/output_49_7.png" src="images/vanangamudimnist/output_49_7.png"><pre class="literal-block">
========================================================
epoch: 80000, loss:1.8094693423336138e-06
correct: 10/10, loss:0.00018090286175720394
</pre>
<img alt="/images/vanangamudimnist/output_49_9.png" src="images/vanangamudimnist/output_49_9.png"><pre class="literal-block">
========================================================
epoch: 100000, loss:1.4504563605441945e-06
correct: 10/10, loss:0.0001450170821044594
</pre>
<img alt="/images/vanangamudimnist/output_49_11.png" src="images/vanangamudimnist/output_49_11.png"><pre class="code python3"><a name="rest_code_de764039e5d04bca9a4f4afcb4ec7b28-1"></a><span class="n">test_and_print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a name="rest_code_de764039e5d04bca9a4f4afcb4ec7b28-2"></a><span class="n">plot_with_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="literal-block">
correct: 10/10, loss:0.0001450170821044594
</pre>
<img alt="/images/vanangamudimnist/output_50_1.png" src="images/vanangamudimnist/output_50_1.png"><img alt="/images/vanangamudimnist/output_50_2.png" src="images/vanangamudimnist/output_50_2.png"><pre class="code python3"><a name="rest_code_64374de09b2340a9a0394d644be32eb3-1"></a><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">_model</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-6"></a>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-7"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">))</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-8"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-9"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-10"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-11"></a>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-12"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-13"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-14"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-15"></a>    <span class="c1">#grid[i].locator_params(axis=u'both', tight=None)</span>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-16"></a>
<a name="rest_code_64374de09b2340a9a0394d644be32eb3-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
&lt;matplotlib.figure.Figure at 0x7f61c7b2e470&gt;
</pre>
<img alt="/images/vanangamudimnist/output_51_1.png" src="images/vanangamudimnist/output_51_1.png"><img alt="/images/vanangamudimnist/output_51_2.png" src="images/vanangamudimnist/output_51_2.png">
</div>
</div>
<div class="section" id="dive-into-the-model">
<h2>Dive into the model</h2>
<p>At first look, the bright differentiating spots belongs to 5, 6 and 8, 9
pairs.</p>
<ul class="simple">
<li>Take 8 and 9, the last two rows, the squares at index 17 are clearly
at extremes. To understand why look at the 17th pixel in images of 8
and 9. That is the only pixel distinguishing 8 and 9.</li>
<li>Take 5 and 6, the same 17th pixel makes all the difference.</li>
</ul>
<p>Now you may ask why the rows in model matrix corresponding to 8 and 9
are almost same but NOT exactly same except for that one single pixel. I
will let you ponder over that point for a while.</p>
<p>Lets reshape the model into the shape of the data. The first rows
becomes the first image and second row becomes the second one...</p>
<pre class="code python3"><a name="rest_code_1feb909e232c4293969e28a6904efc45-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">_model</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-5"></a>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-6"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">))</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-7"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-8"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-9"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-10"></a>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-11"></a>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-12"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_model</span><span class="p">):</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-13"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-14"></a>    <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sa">u</span><span class="s1">'both'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-15"></a>    <span class="c1">#grid[i].locator_params(axis=u'both', tight=None)</span>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-16"></a>
<a name="rest_code_1feb909e232c4293969e28a6904efc45-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
&lt;matplotlib.figure.Figure at 0x7f61959188d0&gt;
</pre>
<img alt="/images/vanangamudimnist/output_53_1.png" src="images/vanangamudimnist/output_53_1.png"><img alt="/images/vanangamudimnist/output_53_2.png" src="images/vanangamudimnist/output_53_2.png"><p>I don't know about you, but now I am gonna admire that picture above and
wonder how beautiful neural networks are. Thank you and, ### Thanks to</p>
<ul class="simple">
<li>
<a class="reference external" href="http://suriyadeepan.github.io/">Suriyadeepan</a> for reviewing the article</li>
</ul>
<ol class="arabic simple">
<li><a class="reference external" href="https://stackoverflow.com/questions/20998083/show-the-values-in-the-grid-using-matplotlib">Show values in the matplot grid by
matshow</a></li>
<li><a class="reference external" href="http://neuralnetworksanddeeplearning.com/chap2.html">How the Backpropogation works by Michael
Nielson</a></li>
<li><a class="reference external" href="https://stackoverflow.com/questions/19698945/controlling-the-range-of-a-color-matrix-plot-in-matplotlib">Controlling the Range of a Color Matrix Plot in
Matplotlib</a></li>
</ol>
</div>
</div>
    </div>
    </article><article class="h-entry post-text--&gt;"><header><h1 class="p-name entry-title"><a href="posts/cheru-secondary-brain-intro/" class="u-url">Cheru::SecondaryBrain</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/cheru-secondary-brain-intro/" rel="bookmark"><time class="published dt-published" datetime="2017-03-25T01:02:52+05:30" title="2017-03-25 01:02">2017-03-25 01:02</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/cheru-secondary-brain-intro/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <!-- 
.. title: Cheru::SecondaryBrain
.. slug: cheru-secondary-brain-intro
.. date: 2017-03-25 01:02:52 UTC+05:30
.. tags: ideas, cheru, organizing
.. category: cheru
.. link:
.. description:
.. type: text-->
  
    <div class="post-header">
      <div class="post-header-line-1"></div>
    </div>
    What are the common activities that we do on the computer?
    
    <ul data-key="1784">
<li class="ListItemNode">
        <div class="ListItem-Content" data-key="1774">
          <div data-key="1773" style="position: relative;"> <span data-key="1772"><span data-offset-key="1772-0">Read articles, books</span></span>
</div>
        </div>
      </li>
      <li class="ListItemNode">
        <div class="ListItem-Content" data-key="1777">
          <div data-key="1776" style="position: relative;"> <span data-key="1775"><span data-offset-key="1775-0">Listen to music and watch videos</span></span>
</div>
        </div>
      </li>
      <li class="ListItemNode">
        <div class="ListItem-Content" data-key="1780">
          <div data-key="1779" style="position: relative;"> <span data-key="1778"><span data-offset-key="1778-0">Write blogs, opinions</span></span>
</div>
        </div>
      </li>
      <li class="ListItemNode">
        <div class="ListItem-Content" data-key="1783">
          <div data-key="1782" style="position: relative;"> <span data-key="1781"><span data-offset-key="1781-0">Use Internet to communicate with other
                people or other computers</span></span>
</div>
        </div>
      </li>
    </ul>
<div data-key="1786"> <span data-key="1785"><span data-offset-key="1785-0">But
          where do we keep all the information consumed? Our brain. But at the
          rate we consume the information, it becomes impossible to verify
          whether the information is true, retain all the information in our
          memory. No you might say, we do store documents like PDFs, pictures
          and docs in computer. Yes we do, but there is a huge difference in the
          way how our brain store and how we store the information in computer.</span></span>
</div>
    <div data-key="1786"><span data-key="1785"><span data-offset-key="1785-0"><br></span></span></div>
    <div data-key="1788"> </div>
    <div data-key="1788"> <span data-key="1787"><span data-offset-key="1787-0">I
          said 'how we store the information in computer', because the computer
          does not store information by itself. What do I mean by this? The way
          our brain stores the information is in the form of network of linked
          concepts, unlike the computers where we store the information in the
          form of documents and images. Because of the difference between the
          organization of contents by our brain and the computers, we are
          redundantly storing information. We are under utilising the
          facitlities offered by the computer. The computer can do much more
          than what it is doing for us now. The computer can act as a secondary
          brain. Let me illustrate the idea with a paper instead of computer,
          and explain why it is uniquely suited for acting as secondary brain.</span></span>
</div>
    <div data-key="1788"><span data-key="1787"><span data-offset-key="1787-0"><br></span></span></div>
    <div data-key="1790"> </div>
    <div data-key="1790"> <span data-key="1789"><span data-offset-key="1789-0">Let
          us say we are going for shopping long list of groceries. What do we
          do? We list down the items in a paper. Because it is little difficult
          to remember all the items in memory. I admit that, some of us can
          remember all the items and with some memory exercises almost all of us
          are capable of doing the same. But is there any use in remembering
          those list of groceries in memory? Or is there a point in spending
          time on memorising that list?</span></span>
</div>
    <div data-key="1790"><span data-key="1789"><span data-offset-key="1789-0"><br></span></span></div>
    <div data-key="1790"> </div>
    <div data-key="1792"> <span data-key="1791"><span data-offset-key="1791-0">Let
          us take a complex example. In blindfold chess, the players are
          blindfolded and they say aloud the pieces to move and where to move.
          There is a third person who actually carryout the moves. No think
          about how players have to keep track of the piece positions and
          simulate the moves before shouting out the next move. Compare that
          with how easy it would be to look at the board and carry out the
          calculations of moves.</span></span>
</div>
    <div data-key="1792"><span data-key="1791"><span data-offset-key="1791-0"><br></span></span></div>
    <div data-key="1792"> </div>
    <div data-key="1798"> <span data-key="1793"><span data-offset-key="1793-0">In
          the above examples, we offload the unnecessary things onto outside
          elements like paper and chess board. leaving room for more important
          things in brain. I think it is safe to assume that now you might have
          understood the usefullness of very simple tools like papers and chess
          boards. Imagine what computer can do, and what we can do with
          computers. Unlike papers and chess boards, the computer can carry out
          calculations on their own(computer play chess too), be as simple as
          they seem when compared to our brain. This makes it an effective tool
          to act as a secondary brain. What I mean by secondary brain will
          become apparent as we travel along.</span></span>
</div>
    <div data-key="1798"> </div>
    <div data-key="1798"> <span data-key="1793"><span data-offset-key="1793-0">This
          document will serve as an informal specification of how I image the
          secondary brain might work.  See you on next post.</span></span>
</div>
    <div data-key="1798"> <span data-key="1793"><span data-offset-key="1793-0"><br></span></span>
</div>
    <div data-key="1798"> <span data-key="1793"><span data-offset-key="1793-0">#CHERU::SecondaryBrain</span></span>
</div>
    <p></p>
  
    </div>
    </article>
</div>



        
<div id="fb-root"></div>
<script>
    // thank lxml for this
    $('.fb-comments-count').each(function(i, obj) {
        var url = obj.attributes['data-url'].value;
        // change here if you dislike the default way of displaying
        // this
        obj.innerHTML = '<fb:comments-count href="' + url + '"></fb:comments-count> comments';
    });

  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : 'selvakumar.v2.x',
      status     : true,
      xfbml      : true
    });

  };

  // Load the SDK asynchronously
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-yYfngbEKv4RENfGDvNUqJTqGFcKf31NJEe9OTnnMH3Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
     tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
         processEscapes: true
     },
     displayAlign: 'left', // Change this to 'center' to center equations.
     "HTML-CSS": {
         styles: {'.MathJax_Display': {"margin": 0}}
     }
 });
 </script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:selva.developer@gmail.com">vanangamudi</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="assets/js/jquery.min.js"></script><script src="assets/js/bootstrap.min.js"></script><script src="assets/js/moment-with-locales.min.js"></script><script src="assets/js/fancydates.js"></script><script src="assets/js/jquery.colorbox-min.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
