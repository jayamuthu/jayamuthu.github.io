<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# fb: http://ogp.me/ns/fb# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="interpretations of my observations">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>vanangamudi</title>
<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://vanangamudi.gitlab.io/">
<meta property="fb:app_id" content="selvakumar.v2.x">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/mnist%20study%20in%20pytorch/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://vanangamudi.gitlab.io/">

                <span id="blog-title">vanangamudi</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>
                </li>
<li>
<a href="stories/aboutme">About me</a>
                </li>
<li>
<a href="https://twitter.com/paarulakan">Twitter</a>
                </li>
<li>
<a href="https://github.com/vanangamudi">Github</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/mnist%20study%20in%20pytorch/" class="u-url">MNIST study</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/mnist%20study%20in%20pytorch/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/mnist%20study%20in%20pytorch/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>this is a work in progress</p>
<pre class="code python3"><a name="rest_code_ef820329c37141ca8199ec12a444cf12-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<a name="rest_code_ef820329c37141ca8199ec12a444cf12-2"></a><span class="kn">import</span> <span class="nn">argparse</span>
<a name="rest_code_ef820329c37141ca8199ec12a444cf12-3"></a><span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_ef820329c37141ca8199ec12a444cf12-4"></a><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<a name="rest_code_ef820329c37141ca8199ec12a444cf12-5"></a><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<a name="rest_code_ef820329c37141ca8199ec12a444cf12-6"></a><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<a name="rest_code_ef820329c37141ca8199ec12a444cf12-7"></a><span class="kn">from</span> <span class="nn">torchvision</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
<a name="rest_code_ef820329c37141ca8199ec12a444cf12-8"></a><span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="k">import</span> <span class="n">Variable</span>
</pre>
<pre class="code python3"><a name="rest_code_42545b5bd44745b699d7e40a33735691-1"></a><span class="k">class</span> <span class="nc">Args</span><span class="p">:</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-2"></a>    <span class="k">pass</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-3"></a>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-4"></a><span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">()</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-5"></a><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">12</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-6"></a><span class="n">args</span><span class="o">.</span><span class="n">cuda</span> <span class="o">=</span> <span class="kc">True</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-7"></a><span class="n">args</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.001</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-8"></a><span class="n">args</span><span class="o">.</span><span class="n">momentum</span> <span class="o">=</span> <span class="mf">0.01</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-9"></a><span class="n">args</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>
<a name="rest_code_42545b5bd44745b699d7e40a33735691-10"></a><span class="n">args</span><span class="o">.</span><span class="n">log_interval</span> <span class="o">=</span> <span class="mi">10</span>
</pre>
<pre class="code python3"><a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-1"></a><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'num_workers'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'pin_memory'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span> <span class="k">else</span> <span class="p">{}</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-2"></a><span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-3"></a>    <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-4"></a>                   <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-5"></a>                       <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-6"></a>                       <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-7"></a>                   <span class="p">])),</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-8"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-9"></a>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-10"></a><span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-11"></a>    <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-12"></a>                    <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-13"></a>                        <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-14"></a>                        <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-15"></a>                    <span class="p">])),</span>
<a name="rest_code_b05b2ba6ff09464aa483d59163ba4d79-16"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre>
<p>Lets take a look into how the dataset looks like</p>
<pre class="code python3"><a name="rest_code_4cbd9149cdd142909e38044a6a26253a-1"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-2"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-3"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-4"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-5"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-6"></a>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-7"></a><span class="n">num_of_samples</span> <span class="o">=</span> <span class="mi">5</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-8"></a>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-9"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">))</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-10"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-11"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">num_of_samples</span><span class="p">,</span> <span class="n">num_of_samples</span><span class="p">),</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-12"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-13"></a>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-14"></a><span class="n">output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_of_samples</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-15"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-16"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#dirty trick to take just one sample</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-17"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_of_samples</span> <span class="o">**</span> <span class="mi">2</span><span class="p">):</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-18"></a>            <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-19"></a>            <span class="n">output</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-20"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-21"></a>        <span class="k">break</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-22"></a>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-23"></a>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-24"></a><span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_of_samples</span><span class="p">,</span> <span class="n">num_of_sample</span><span class="p">)</span>
<a name="rest_code_4cbd9149cdd142909e38044a6a26253a-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
[[ 6.  9.  9.  5.  4.]
 [ 3.  6.  5.  0.  1.]
 [ 8.  1.  3.  6.  2.]
 [ 9.  4.  8.  8.  6.]
 [ 0.  6.  4.  2.  3.]]
</pre>
<img alt="/images/mnist_study_in_pytorch/output_12_0.png" src="images/mnist_study_in_pytorch/output_12_0.png"><p>You can see that the image of number &lt;&gt; is associated with number &lt;&gt;. It is a list of (image of number, number). As usual we are gonna feed the neural network with image from the left and its label from the right. We will train a set of feedforward networks in increasing order of complexity. What I mean by complexity is the number of neurons and number of layers.</p>
<pre class="code python3"><a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-1"></a><span class="k">class</span> <span class="nc">Model0</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-2"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-3"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model0</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-5"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-6"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-7"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-8"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-9"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-10"></a><span class="k">class</span> <span class="nc">Model1</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-11"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-12"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-15"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-16"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-17"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-18"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-19"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-20"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-21"></a><span class="k">class</span> <span class="nc">Model2</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-22"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-23"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-26"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-27"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-28"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-29"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-30"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-31"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-32"></a><span class="k">class</span> <span class="nc">Model3</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-33"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-34"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model3</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-37"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-38"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-39"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-40"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-41"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-42"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-43"></a><span class="k">class</span> <span class="nc">Model4</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-44"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-45"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model4</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-47"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-48"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-49"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-50"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-51"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-52"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-53"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-54"></a><span class="k">class</span> <span class="nc">Model5</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-55"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-56"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model5</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-59"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-60"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-61"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-62"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-63"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-64"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-65"></a><span class="k">class</span> <span class="nc">Model6</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-66"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-67"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model6</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-69"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-70"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-71"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-72"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-73"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-74"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-75"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-76"></a><span class="k">class</span> <span class="nc">Model7</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-77"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-78"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model7</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-79"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-80"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-81"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-82"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-83"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-84"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-85"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-86"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-87"></a><span class="k">class</span> <span class="nc">Model8</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-88"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-89"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model8</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-91"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-92"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-93"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-94"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-95"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-96"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-97"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-98"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-99"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-100"></a><span class="k">class</span> <span class="nc">Model9</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-101"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-102"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model9</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-104"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-107"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-108"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-109"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-110"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-111"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-112"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-113"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-114"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-115"></a><span class="k">class</span> <span class="nc">Model10</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-116"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-117"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Model10</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-118"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-123"></a>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-124"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-125"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-126"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-127"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-128"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layer2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-129"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1ba3e2e401394e92a57b540a9cd01a3a-130"></a>        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre>
<p>Lets create the model instances. If you have GPU this is how you can make use of it, by calling .cuda() on models and tensors</p>
<pre class="code python3"><a name="rest_code_42b29811d7e04a36b7b78e11ce51ead3-1"></a><span class="n">models</span> <span class="o">=</span> <span class="n">Model0</span><span class="p">(),</span> <span class="n">Model1</span><span class="p">(),</span> <span class="n">Model2</span><span class="p">(),</span> <span class="n">Model3</span><span class="p">(),</span> <span class="n">Model4</span><span class="p">(),</span> <span class="n">Model5</span><span class="p">(),</span> <span class="n">Model6</span><span class="p">(),</span> <span class="n">Model7</span><span class="p">(),</span> <span class="n">Model8</span><span class="p">(),</span> <span class="n">Model9</span><span class="p">(),</span> <span class="n">Model10</span><span class="p">()</span>
<a name="rest_code_42b29811d7e04a36b7b78e11ce51ead3-2"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_42b29811d7e04a36b7b78e11ce51ead3-3"></a>    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_42b29811d7e04a36b7b78e11ce51ead3-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre>
<pre class="code python3"><a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-1"></a><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-2"></a>    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">momentum</span><span class="p">)</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-3"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-5"></a>        <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-6"></a>            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-7"></a>                <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-8"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-9"></a>            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-10"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-11"></a>            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-12"></a>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-13"></a>            <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-14"></a>            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-15"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-16"></a>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-17"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">print_every</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-18"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">'Train Epoch: </span><span class="si">{}</span><span class="s1"> [</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{:.0f}</span><span class="s1">%)]</span><span class="se">\t</span><span class="s1">Loss: </span><span class="si">{:.6f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-19"></a>                    <span class="n">i</span><span class="p">,</span> <span class="n">batch_idx</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span>
<a name="rest_code_594ff8a29dcd46eea0e84429fc56a918-20"></a>                    <span class="mf">100.</span> <span class="o">*</span> <span class="n">batch_idx</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">),</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre>
<p>This is where the actual training starts. It will take a while, so I just trained them for 100 times on entire training dataset.</p>
<pre class="code python3"><a name="rest_code_f01cc61d479346d8a5d6f0be702649a1-1"></a><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_f01cc61d479346d8a5d6f0be702649a1-2"></a>    <span class="n">train</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Train Epoch: 0 [59988/60000 (100%)]        Loss: 0.061506
.
.
.
.
Train Epoch: 98 [59988/60000 (100%)]       Loss: 0.018422
Train Epoch: 99 [59988/60000 (100%)]       Loss: 0.336890
</pre>
<p>Saving the model weights into a file, this should be in the above snippet or inside the training function for saving models every epoch.Lets just keep this simple</p>
<pre class="code python3"><a name="rest_code_dbd191539b3b4d91aeb2733f7b487e2e-1"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
<a name="rest_code_dbd191539b3b4d91aeb2733f7b487e2e-2"></a>    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s1">'mnist_mlp_multiple_model</span><span class="si">{}</span><span class="s1">.pth'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre>
<p>For the sake of completeness, this is how you load the saved models</p>
<pre class="code python3"><a name="rest_code_e947b6a78a514820b5850d525659de6b-1"></a><span class="n">models</span> <span class="o">=</span> <span class="n">Model0</span><span class="p">(),</span> <span class="n">Model1</span><span class="p">(),</span> <span class="n">Model2</span><span class="p">(),</span> <span class="n">Model3</span><span class="p">(),</span> <span class="n">Model4</span><span class="p">(),</span> <span class="n">Model5</span><span class="p">(),</span> <span class="n">Model6</span><span class="p">(),</span> <span class="n">Model7</span><span class="p">(),</span> <span class="n">Model8</span><span class="p">(),</span> <span class="n">Model9</span><span class="p">(),</span> <span class="n">Model10</span><span class="p">()</span>
<a name="rest_code_e947b6a78a514820b5850d525659de6b-2"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_e947b6a78a514820b5850d525659de6b-3"></a>    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_e947b6a78a514820b5850d525659de6b-4"></a>        <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_e947b6a78a514820b5850d525659de6b-5"></a>
<a name="rest_code_e947b6a78a514820b5850d525659de6b-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
<a name="rest_code_e947b6a78a514820b5850d525659de6b-7"></a>    <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'mnist_mlp_multiple_model</span><span class="si">{}</span><span class="s1">.pth'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</pre>
<p>Before we run the model over the test dataset, let take a peek into how one of the model performs</p>
<pre class="code python3"><a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-5"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-6"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-7"></a>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-8"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">))</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-9"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>  <span class="c1"># similar to subplot(111)</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-10"></a>                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="c1"># creates 2x2 grid of axes</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-11"></a>                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># pad between axes in inch.</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-12"></a>                 <span class="p">)</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-13"></a>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-14"></a><span class="n">output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-15"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-16"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#dirty trick</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-17"></a>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-18"></a>        <span class="n">data1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-19"></a>        <span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-20"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">9</span><span class="p">](</span><span class="n">Variable</span><span class="p">(</span><span class="n">data1</span><span class="p">))</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-21"></a>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-22"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-23"></a>            <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-24"></a>            <span class="n">output</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-25"></a>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-26"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-27"></a>        <span class="k">break</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-28"></a>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-29"></a><span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-30"></a><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<a name="rest_code_60e81580b88641fd8a7dfac1fc7fa07c-31"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<pre class="literal-block">
[[ 6.  2.  9.  1.  8.]
 [ 5.  6.  5.  7.  5.]
 [ 4.  8.  6.  3.  0.]
 [ 6.  1.  0.  9.  3.]
 [ 7.  2.  8.  4.  4.]]
</pre>
<img alt="/images/mnist_study_in_pytorch/output_12_0.png" src="images/mnist_study_in_pytorch/output_12_0.png"><p>As you can see, the results are not so bad.Lets test all our models.</p>
<pre class="code python3"><a name="rest_code_65b04f0f11164860a881b93d71765d01-1"></a><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-2"></a>    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-3"></a>    <span class="n">test_loss</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-4"></a>    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-5"></a>    <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">test_loader</span><span class="p">:</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-6"></a>        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cuda</span><span class="p">:</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-7"></a>            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-8"></a>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-9"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-10"></a>        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">volatile</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-11"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-12"></a>        <span class="n">test_loss</span> <span class="o">+=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-13"></a>        <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># get the index of the max log-probability</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-14"></a>        <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-15"></a>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-16"></a>    <span class="n">test_loss</span> <span class="o">=</span> <span class="n">test_loss</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-17"></a>    <span class="n">test_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)</span> <span class="c1"># loss function already averages over batch size</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Test set: Average loss: </span><span class="si">{:.4f}</span><span class="s1">, Accuracy: </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{:.0f}</span><span class="s1">%)</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-19"></a>        <span class="n">test_loss</span><span class="p">,</span> <span class="n">correct</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-20"></a>        <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)))</span>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-21"></a>
<a name="rest_code_65b04f0f11164860a881b93d71765d01-22"></a>    <span class="k">return</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
</pre>
<pre class="code python3"><a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-1"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-4"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-5"></a><span class="kn">import</span> <span class="nn">pprint</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-6"></a><span class="kn">import</span> <span class="nn">numpy</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-7"></a>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-8"></a>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-9"></a><span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-10"></a><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-11"></a>    <span class="n">accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_tuts</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-12"></a>
<a name="rest_code_13f2babe1f084507a5bc5c9c93bc20cf-13"></a><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Test set: Average loss: 0.2764, Accuracy: 9250/10000 (92%)
Test set: Average loss: 0.3591, Accuracy: 9010/10000 (90%)
Test set: Average loss: 0.3204, Accuracy: 9121/10000 (91%)
Test set: Average loss: 0.2954, Accuracy: 9189/10000 (92%)
Test set: Average loss: 0.2767, Accuracy: 9237/10000 (92%)
Test set: Average loss: 0.2699, Accuracy: 9267/10000 (93%)
Test set: Average loss: 0.2700, Accuracy: 9251/10000 (93%)
Test set: Average loss: 0.2690, Accuracy: 9244/10000 (92%)
Test set: Average loss: 0.2755, Accuracy: 9240/10000 (92%)
Test set: Average loss: 0.2745, Accuracy: 9253/10000 (93%)
Test set: Average loss: 0.2789, Accuracy: 9232/10000 (92%)

[92.5, 90.1, 91.21, 91.89, 92.37, 92.67, 92.51, 92.44, 92.4, 92.53, 92.32]
</pre>
<pre class="code python3"><a name="rest_code_c6063dd19df144ca8267819e25e79079-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)),</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_c6063dd19df144ca8267819e25e79079-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<a name="rest_code_c6063dd19df144ca8267819e25e79079-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a name="rest_code_c6063dd19df144ca8267819e25e79079-4"></a>
<a name="rest_code_c6063dd19df144ca8267819e25e79079-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)),</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_c6063dd19df144ca8267819e25e79079-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">93</span><span class="p">])</span>
<a name="rest_code_c6063dd19df144ca8267819e25e79079-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="/images/mnist_study_in_pytorch/output_11_0.png" src="images/mnist_study_in_pytorch/output_11_0.png"><img alt="/images/mnist_study_in_pytorch/output_11_1.png" src="images/mnist_study_in_pytorch/output_11_1.png"><p>The right image is a little zoomed in version of the left one. Little dissappointing, isn't it? The more complex models doesn't seem to perform as we would expect. So we can understand that the performance is not proportional to number of layers in neural network. It is in how they interact with each other.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/pytorch%20primer/" class="u-url">PyTorch Primer</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                vanangamudi
            </span></p>
            <p class="dateline"><a href="posts/pytorch%20primer/" rel="bookmark"><time class="published dt-published" datetime="2017-04-27T23:00:00-03:00" title="2017-04-27 23:00">2017-04-27 23:00</time></a></p>
                <p class="commentline">
        
<span class="fb-comments-count" data-url="/posts/pytorch%20primer/">


        </span></p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>This is post is inspired by <cite>Numpy Primer &lt;http://suriyadeepan.github.io/2016-06-26-numpy-primer/&gt;</cite></p>
<div class="section" id="lets-create-some-matrices">
<h2>Lets create some matrices</h2>
<pre class="code python3"><a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-1"></a> <span class="kn">import</span> <span class="nn">torch</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-2"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-3"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-4"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-5"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-6"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-8"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-10"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-11"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-12"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-13"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-14"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-15"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-16"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-17"></a> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-19"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-20"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-21"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-22"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-23"></a>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-24"></a><span class="o">-</span><span class="mf">0.0008</span> <span class="o">-</span><span class="mf">0.6619</span> <span class="o">-</span><span class="mf">0.6790</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-25"></a> <span class="mf">0.9104</span> <span class="o">-</span><span class="mf">0.1249</span> <span class="o">-</span><span class="mf">0.4044</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-26"></a><span class="o">-</span><span class="mf">1.0516</span> <span class="o">-</span><span class="mf">0.4031</span>  <span class="mf">0.9166</span>
<a name="rest_code_0f8eb849c5714fef842e15de1de4dad3-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre>
<p>I think now we can understand what the parameters to the above functions mean - the shape of the tensor. Take a look at non square matrices below</p>
<pre class="code python3"><a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-3"></a>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-4"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-5"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-7"></a>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-8"></a>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-9"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-10"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-11"></a>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-12"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-13"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-14"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-15"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_e42be7cbfa364f7488bbe7a6cbb44c09-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x3</span><span class="p">]</span>
</pre>
<p>How about a multidimensional vector - a tensor. Actually tensor is a general term for n-dimensional arrays like in numpy. If you were keen observant, you'd have notices by now that the output of every <strong>print(x)</strong> end with <strong>torch.FloatTensor</strong>. This term became famous with the deep learning storm.</p>
<pre class="code python3"><a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-3"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-7"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-8"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-9"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-10"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-11"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-12"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-15"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-16"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-19"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-20"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-21"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-22"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-23"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-27"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-28"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-29"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-30"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-31"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-32"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-33"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-34"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-35"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-36"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-37"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-38"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-39"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-40"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-41"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-42"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-43"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-44"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-45"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-46"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-47"></a>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-49"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-50"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_4cc80be96baf4f0f93ecf8765b64201d-51"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x3x2x2x3</span><span class="p">]</span>
</pre>
<p>Pause for a moment and take a long look into how the tensor is printed.  And then proceed to look for more matrices below.
The identity matrix - matrix is the keyword.</p>
<pre class="code python3"><a name="rest_code_b524263df59d4f30890133aa61e67c32-1"></a><span class="c1"># The identity matrix - max upto two dimensions</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-4"></a>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-5"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-6"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-7"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-8"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-9"></a>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-10"></a>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-13"></a>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-14"></a> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-15"></a> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-16"></a> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>
<a name="rest_code_b524263df59d4f30890133aa61e67c32-17"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x4</span><span class="p">]</span>
</pre>
<p>Alright I get it. Just ones and zeros are boring. Want some more numbers?
<strong>torch.linspace(start, end, count)</strong> creates a list of numbers starting with <strong>start</strong> to <strong>end</strong> at the interval of  <strong>(end - start)/(count - 1)</strong></p>
<pre class="code python3"><a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-3"></a>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-4"></a> <span class="mf">1.0000</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-5"></a> <span class="mf">1.5556</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-6"></a> <span class="mf">2.1111</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-7"></a> <span class="mf">2.6667</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-8"></a> <span class="mf">3.2222</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-9"></a> <span class="mf">3.7778</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-10"></a> <span class="mf">4.3333</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-11"></a> <span class="mf">4.8889</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-12"></a> <span class="mf">5.4444</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-13"></a> <span class="mf">6.0000</span>
<a name="rest_code_5c25a3734866407a9cf0e36d9cb99647-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p><strong>torch.logspace()</strong> is similar to torch.linspace() but in logarthmic steps.</p>
<pre class="code python3"><a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-3"></a>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-4"></a>  <span class="mf">1.2589</span>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-5"></a>  <span class="mf">2.1135</span>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-6"></a>  <span class="mf">3.5481</span>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-7"></a>  <span class="mf">5.9566</span>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-8"></a> <span class="mf">10.0000</span>
<a name="rest_code_739ff112bb5a4560921ce0eeca217e9e-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">5</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="arithmetics">
<h2>Arithmetics</h2>
<p>So what we created bunch of numbers. What is the use? Lets do some arithmetic</p>
<p>Elementwise addition</p>
<pre class="code python3"><a name="rest_code_0e2feebaa38d426ea4816800153d81b8-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-3"></a>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-4"></a> <span class="mi">1</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-5"></a> <span class="mi">1</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-6"></a> <span class="mi">1</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-7"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-8"></a>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-9"></a>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-10"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-11"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-12"></a>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-13"></a> <span class="mi">3</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-14"></a> <span class="mi">3</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-15"></a> <span class="mi">3</span>
<a name="rest_code_0e2feebaa38d426ea4816800153d81b8-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="p">]</span>
</pre>
<p>Elementwise multiplication</p>
<pre class="code python3"><a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-1"></a> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-2"></a> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-3"></a>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-4"></a>  <span class="mi">1</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-5"></a>  <span class="mi">2</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-6"></a>  <span class="mi">3</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-7"></a>  <span class="mi">4</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-8"></a>  <span class="mi">5</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-9"></a>  <span class="mi">6</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-10"></a>  <span class="mi">7</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-11"></a>  <span class="mi">8</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-12"></a>  <span class="mi">9</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-13"></a> <span class="mi">10</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-15"></a>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-16"></a> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-17"></a> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-18"></a>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-19"></a>  <span class="mi">2</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-20"></a>  <span class="mi">4</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-21"></a>  <span class="mi">6</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-22"></a>  <span class="mi">8</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-23"></a> <span class="mi">10</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-24"></a> <span class="mi">12</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-25"></a> <span class="mi">14</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-26"></a> <span class="mi">16</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-27"></a> <span class="mi">18</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-28"></a> <span class="mi">20</span>
<a name="rest_code_4db96656b00e4492a2cb172fd5a9e800-29"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p>Iterating over the elements and multiplying them by some number</p>
<pre class="code python3"><a name="rest_code_4edb0211646248b8b03f8aca26165464-1"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-2"></a>    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-3"></a>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-5"></a>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-6"></a>  <span class="mi">0</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-7"></a>  <span class="mi">2</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-8"></a>  <span class="mi">6</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-9"></a> <span class="mi">12</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-10"></a> <span class="mi">20</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-11"></a> <span class="mi">30</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-12"></a> <span class="mi">42</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-13"></a> <span class="mi">56</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-14"></a> <span class="mi">72</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-15"></a> <span class="mi">90</span>
<a name="rest_code_4edb0211646248b8b03f8aca26165464-16"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
</pre>
<p>So yes we can multiply the tensors by ordinary numbers, there is no need for 'i' to be a tensor, lets take a larger tensors, and assign its values by hand. So far we have been using the numbers generated by function like <strong>ones(), zeros() and rand()</strong>. In most cases we need our favoruite numbers. How to do this? <strong>torch.Tensor()</strong> to the rescue.</p>
<pre class="code python3"><a name="rest_code_1615fcdd621e44ffa64945cac36378e1-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">67</span><span class="p">])</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-3"></a>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-4"></a>  <span class="mi">1</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-5"></a>  <span class="mi">3</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-6"></a>  <span class="mi">5</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-7"></a>  <span class="mi">6</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-8"></a> <span class="mi">78</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-9"></a>  <span class="mi">3</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-10"></a> <span class="mi">67</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-11"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">7</span><span class="p">]</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-12"></a>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">)])</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-15"></a>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-16"></a>  <span class="mi">0</span>   <span class="mi">2</span>   <span class="mi">4</span>   <span class="mi">6</span>   <span class="mi">8</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-17"></a> <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>  <span class="mi">18</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-18"></a> <span class="mi">20</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_1615fcdd621e44ffa64945cac36378e1-19"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x5</span><span class="p">]</span>
</pre>
<p>As we can see, the torch.Tensor() takes any iterable or iterables of iterable and makes a tensor out of it</p>
<p>Broadcasting
Adding a scalar to a tensor or multiplying a tensor by a scalar is essentially same as adding or multiplying the tensor by another tensor with shape same as the original tensor, with all its elements being the scalar. Too many words.</p>
<pre class="code python3"><a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-3"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-4"></a>  <span class="mi">1</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-5"></a>  <span class="mi">2</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-6"></a>  <span class="mi">3</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-7"></a>  <span class="mi">4</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-8"></a>  <span class="mi">5</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-9"></a>  <span class="mi">6</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-10"></a>  <span class="mi">7</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-11"></a>  <span class="mi">8</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-12"></a>  <span class="mi">9</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-13"></a> <span class="mi">10</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-15"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-16"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-17"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-19"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-20"></a> <span class="mi">2</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-21"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-22"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-23"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-24"></a><span class="c1"># broadcasting  https://discuss.pytorch.org/t/broadcasting-or-alternative-solutions/120</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-25"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-26"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-27"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-28"></a>  <span class="mi">2</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-29"></a>  <span class="mi">4</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-30"></a>  <span class="mi">6</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-31"></a>  <span class="mi">8</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-32"></a> <span class="mi">10</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-33"></a> <span class="mi">12</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-34"></a> <span class="mi">14</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-35"></a> <span class="mi">16</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-36"></a> <span class="mi">18</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-37"></a> <span class="mi">20</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-38"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">10</span><span class="p">]</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-39"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-40"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-41"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-42"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-43"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-44"></a> <span class="mi">2</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-45"></a> <span class="mi">3</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-46"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="p">]</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-47"></a>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-48"></a><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>        <span class="c1">#Dont' work</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-49"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-50"></a>  <span class="n">File</span> <span class="s2">"&lt;stdin&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-51"></a>  <span class="n">File</span> <span class="s2">"/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">274</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand_as</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-52"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-53"></a>  <span class="n">File</span> <span class="s2">"/home/paarulakan/environments/python/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">261</span><span class="p">,</span> <span class="ow">in</span> <span class="n">expand</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-54"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'incorrect size: only supporting singleton expansion (size=1)'</span><span class="p">)</span>
<a name="rest_code_c1a2d4802b074657ac7d822f08c6bd75-55"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="n">incorrect</span> <span class="n">size</span><span class="p">:</span> <span class="n">only</span> <span class="n">supporting</span> <span class="n">singleton</span> <span class="n">expansion</span> <span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre>
<p>Note that the expand_as() works only for singletons</p>
<div class="section" id="reshaping-tensors">
<h3>Reshaping Tensors</h3>
<p><strong>view()</strong> takes list of number and reshapes the tensor as per the arguments.</p>
<p>The constrain is for view(a, b, c,....n) a x b x c x ... x n should be equal to the size of the given tensor. If you give <em>'-1'</em> as the last argument to <strong>view()</strong> it will calculate the last dimension by itself.</p>
<pre class="code python3"><a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-3"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-4"></a>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-5"></a>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-6"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x5</span><span class="p">]</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-7"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-8"></a><span class="c1"># making matrices by hand is hard right?</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-9"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-10"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-12"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-13"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-14"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-15"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-16"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-17"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-18"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-20"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-21"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-22"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-23"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-24"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-25"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-26"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-27"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-28"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-29"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-30"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-31"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-32"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-33"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-34"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-35"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-36"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-37"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-39"></a>   <span class="mi">5</span>   <span class="mi">6</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-40"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-41"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-42"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-43"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-44"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-45"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-46"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-47"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-48"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-49"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-50"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-51"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-52"></a><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-53"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-54"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-55"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-56"></a>   <span class="mi">1</span>   <span class="mi">2</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-57"></a>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-58"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-59"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-60"></a>   <span class="mi">5</span>  <span class="o">-</span><span class="mi">6</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-61"></a>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-62"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-63"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-64"></a>   <span class="mi">9</span>  <span class="mi">10</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-65"></a>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-66"></a>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-67"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-68"></a>  <span class="mi">13</span>  <span class="mi">14</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-69"></a>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_e7c66e71c06148b6b8988a1fa4bdfdff-70"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x2x2</span><span class="p">]</span>
</pre>
<p>Notice that change in value of an element in <strong>x</strong> reflects in <strong>x_</strong>. It is because view() does exactly what is says it will do. It creates a view of the tensor, the underlying storage is same for <strong>x</strong> and <strong>x_</strong></p>
</div>
<div class="section" id="statistics">
<h3>Statistics</h3>
<pre class="code python3"><a name="rest_code_12dcabde46074665a794b0e3498e60ef-1"></a><span class="n">x</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-2"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-4"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-5"></a>  <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-6"></a>  <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-7"></a>  <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-8"></a> <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-9"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-10"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-12"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-13"></a> <span class="mi">28</span>  <span class="mi">32</span>  <span class="mi">36</span>  <span class="mi">40</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-14"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x4</span><span class="p">]</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-15"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-16"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-17"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-18"></a> <span class="mi">10</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-19"></a> <span class="mi">26</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-20"></a> <span class="mi">42</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-21"></a> <span class="mi">58</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-22"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x1</span><span class="p">]</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-23"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-24"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-26"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-27"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-28"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-29"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-30"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-31"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-32"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-33"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-34"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-35"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-36"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-37"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-38"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-39"></a>  <span class="mi">10</span>  <span class="mi">12</span>  <span class="mi">14</span>  <span class="mi">16</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-40"></a>  <span class="mi">18</span>  <span class="mi">20</span>  <span class="mi">22</span>  <span class="mi">24</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-41"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">1</span><span class="n">x2x4</span><span class="p">]</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-42"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-44"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-45"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-46"></a>   <span class="mi">6</span>   <span class="mi">8</span>  <span class="mi">10</span>  <span class="mi">12</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-47"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-48"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-49"></a>  <span class="mi">22</span>  <span class="mi">24</span>  <span class="mi">26</span>  <span class="mi">28</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-50"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x1x4</span><span class="p">]</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-51"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-52"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-53"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-54"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-55"></a>  <span class="mi">10</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-56"></a>  <span class="mi">26</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-57"></a>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-58"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-59"></a>  <span class="mi">42</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-60"></a>  <span class="mi">58</span>
<a name="rest_code_12dcabde46074665a794b0e3498e60ef-61"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2x1</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="matrix-multiplication">
<h3>Matrix Multiplication</h3>
<p><strong>mm()</strong> is name. See how it is different from normal elementwise multiplication, like we used to do in linear algebra class?</p>
<pre class="code python3"><a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-1"></a><span class="c1">#lets do some matrix multiplications</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-2"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-3"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]])</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-4"></a>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-6"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-7"></a>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-9"></a>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-10"></a>  <span class="mi">70</span>  <span class="mi">100</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-11"></a> <span class="mi">150</span>  <span class="mi">220</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-12"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span><span class="n">x2</span><span class="p">]</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-13"></a>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-14"></a><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-15"></a>                  <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-16"></a>                  <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-17"></a>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-18"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-19"></a>                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-21"></a>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-22"></a>  <span class="mi">70</span>  <span class="mi">100</span>  <span class="mi">170</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-23"></a> <span class="mi">150</span>  <span class="mi">220</span>  <span class="mi">390</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-24"></a> <span class="mi">230</span>  <span class="mi">340</span>  <span class="mi">610</span>
<a name="rest_code_6d1257d6c120476abd24ca3dd4fe6178-25"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span><span class="n">x3</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="indexing-and-slicing">
<h3>Indexing and slicing</h3>
<pre class="code python3"><a name="rest_code_c3ef664dfac044819d3b4dd488589c36-1"></a><span class="c1">#Indexing and slicing</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-2"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-4"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-5"></a>  <span class="mi">1</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-6"></a>  <span class="mi">2</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-7"></a>  <span class="mi">3</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-8"></a>  <span class="mi">4</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-9"></a>  <span class="mi">5</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-10"></a>  <span class="o">.</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-11"></a>  <span class="o">.</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-12"></a>  <span class="o">.</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-13"></a> <span class="mi">61</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-14"></a> <span class="mi">62</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-15"></a> <span class="mi">63</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-16"></a> <span class="mi">64</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-17"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-18"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-19"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-20"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-21"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-23"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-24"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-25"></a>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-26"></a>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-27"></a>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">12</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-28"></a>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-29"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-30"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-31"></a>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">20</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-32"></a>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">24</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-33"></a>  <span class="mi">25</span>  <span class="mi">26</span>  <span class="mi">27</span>  <span class="mi">28</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-34"></a>  <span class="mi">29</span>  <span class="mi">30</span>  <span class="mi">31</span>  <span class="mi">32</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-35"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-36"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-37"></a>  <span class="mi">33</span>  <span class="mi">34</span>  <span class="mi">35</span>  <span class="mi">36</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-38"></a>  <span class="mi">37</span>  <span class="mi">38</span>  <span class="mi">39</span>  <span class="mi">40</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-39"></a>  <span class="mi">41</span>  <span class="mi">42</span>  <span class="mi">43</span>  <span class="mi">44</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-40"></a>  <span class="mi">45</span>  <span class="mi">46</span>  <span class="mi">47</span>  <span class="mi">48</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-41"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-42"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-43"></a>  <span class="mi">49</span>  <span class="mi">50</span>  <span class="mi">51</span>  <span class="mi">52</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-44"></a>  <span class="mi">53</span>  <span class="mi">54</span>  <span class="mi">55</span>  <span class="mi">56</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-45"></a>  <span class="mi">57</span>  <span class="mi">58</span>  <span class="mi">59</span>  <span class="mi">60</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-46"></a>  <span class="mi">61</span>  <span class="mi">62</span>  <span class="mi">63</span>  <span class="mi">64</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-47"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-48"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-49"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-50"></a>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-51"></a> <span class="mi">21</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-52"></a> <span class="mi">22</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-53"></a> <span class="mi">23</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-54"></a> <span class="mi">24</span>
<a name="rest_code_c3ef664dfac044819d3b4dd488589c36-55"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="masking">
<h3>Masking</h3>
<pre class="code python3"><a name="rest_code_d1dc7930e8b54c79938186de5102a55b-1"></a><span class="c1">#the expression 'x_ % 4 == 0' creates a mask</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-3"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-4"></a><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-5"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-6"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-7"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-8"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-9"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-10"></a><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-11"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-12"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-13"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-14"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-15"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-16"></a><span class="p">(</span><span class="mi">2</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-17"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-18"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-19"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-20"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-21"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-22"></a><span class="p">(</span><span class="mi">3</span> <span class="p">,</span><span class="o">.</span><span class="p">,</span><span class="o">.</span><span class="p">)</span> <span class="o">=</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-23"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-24"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-25"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-26"></a>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-27"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4x4</span><span class="p">]</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-28"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-29"></a><span class="c1"># Use the mask to extract just those elements</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-30"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-31"></a><span class="n">x_</span><span class="p">[</span><span class="mi">0</span><span class="p">][(</span><span class="n">x_</span><span class="o">%</span><span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-32"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-33"></a>  <span class="mi">4</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-34"></a>  <span class="mi">8</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-35"></a> <span class="mi">12</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-36"></a> <span class="mi">16</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-37"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="p">]</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-38"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-39"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-40"></a><span class="c1">#more grander masking example</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-41"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-42"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-43"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-44"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-45"></a>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-46"></a>  <span class="mi">2</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-47"></a>  <span class="mi">3</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-48"></a>  <span class="mi">4</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-49"></a>  <span class="mi">5</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-50"></a>  <span class="o">.</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-51"></a>  <span class="o">.</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-52"></a>  <span class="o">.</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-53"></a> <span class="mi">61</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-54"></a> <span class="mi">62</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-55"></a> <span class="mi">63</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-56"></a> <span class="mi">64</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-57"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-58"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">64</span><span class="p">]</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-59"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-60"></a><span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-61"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-62"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-63"></a>    <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="mi">7</span>     <span class="mi">8</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-64"></a>    <span class="mi">9</span>    <span class="mi">10</span>    <span class="mi">11</span>    <span class="mi">12</span>    <span class="mi">13</span>    <span class="mi">14</span>    <span class="mi">15</span>    <span class="mi">16</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-65"></a>   <span class="mi">17</span>    <span class="mi">18</span>    <span class="mi">19</span>    <span class="mi">20</span>    <span class="mi">21</span>    <span class="mi">22</span>    <span class="mi">23</span>    <span class="mi">24</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-66"></a>   <span class="mi">25</span>    <span class="mi">26</span>    <span class="mi">27</span>    <span class="mi">28</span>    <span class="mi">29</span>    <span class="mi">30</span>    <span class="mi">31</span>    <span class="mi">32</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-67"></a>   <span class="mi">33</span>    <span class="mi">34</span>    <span class="mi">35</span>    <span class="mi">36</span>    <span class="mi">37</span>    <span class="mi">38</span>    <span class="mi">39</span>    <span class="mi">40</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-68"></a>   <span class="mi">41</span>    <span class="mi">42</span>    <span class="mi">43</span>    <span class="mi">44</span>    <span class="mi">45</span>    <span class="mi">46</span>    <span class="mi">47</span>    <span class="mi">48</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-69"></a>   <span class="mi">49</span>    <span class="mi">50</span>    <span class="mi">51</span>    <span class="mi">52</span>    <span class="mi">53</span>    <span class="mi">54</span>    <span class="mi">55</span>    <span class="mi">56</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-70"></a>   <span class="mi">57</span>    <span class="mi">58</span>    <span class="mi">59</span>    <span class="mi">60</span>    <span class="mi">61</span>    <span class="mi">62</span>    <span class="mi">63</span>    <span class="mi">64</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-71"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-72"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-73"></a><span class="n">x_ind</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">byte</span><span class="p">()</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-74"></a><span class="nb">print</span><span class="p">(</span><span class="n">x_ind</span><span class="p">)</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-75"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-76"></a>    <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-77"></a>    <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-78"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-79"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-80"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-81"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-82"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-83"></a>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-84"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="n">x8</span><span class="p">]</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-85"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-86"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x_ind</span><span class="p">])</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-87"></a>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-88"></a>  <span class="mi">1</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-89"></a> <span class="mi">10</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-90"></a> <span class="mi">19</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-91"></a> <span class="mi">28</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-92"></a> <span class="mi">37</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-93"></a> <span class="mi">46</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-94"></a> <span class="mi">55</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-95"></a> <span class="mi">64</span>
<a name="rest_code_d1dc7930e8b54c79938186de5102a55b-96"></a><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">8</span><span class="p">]</span>
</pre>
<p>Please leave your comments below.</p>
</div>
</div>
</div>
    </div>
    </article>
</div>



        
<div id="fb-root"></div>
<script>
    // thank lxml for this
    $('.fb-comments-count').each(function(i, obj) {
        var url = obj.attributes['data-url'].value;
        // change here if you dislike the default way of displaying
        // this
        obj.innerHTML = '<fb:comments-count href="' + url + '"></fb:comments-count> comments';
    });

  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : 'selvakumar.v2.x',
      status     : true,
      xfbml      : true
    });

  };

  // Load the SDK asynchronously
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2017         <a href="mailto:selva.developer@gmail.com">vanangamudi</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="assets/js/jquery.min.js"></script><script src="assets/js/bootstrap.min.js"></script><script src="assets/js/moment-with-locales.min.js"></script><script src="assets/js/fancydates.js"></script><script src="assets/js/jquery.colorbox-min.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
